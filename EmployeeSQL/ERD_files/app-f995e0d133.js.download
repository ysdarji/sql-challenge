"use strict";var QdbdApp,__decorate=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,a=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},__extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__awaiter=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}d((n=n.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},__spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n},__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__assign.apply(this,arguments)};!function(e){function t(e,t,i,n,o,r,a,s){a.buildVersion&&console.log&&console.log(a.buildVersion),e.interceptors.push("httpRequestInterceptorFactory"),i.hashPrefix(""),s.setPrefix("QdbdApp"),t.state("root",{abstract:!0,views:{header:{template:"<dt-header></dt-header>"},layout:{}}}).state("root.standard",{abstract:!0,views:{"layout@":{templateUrl:"cache/common/layouts/standard.html"}}}).state("root.standardPadded",{abstract:!0,views:{"layout@":{templateUrl:"cache/common/layouts/standard-padded.html"}}}).state("root.standardShrinkable",{abstract:!0,views:{"layout@":{templateUrl:"cache/common/layouts/standard-shrinkable.html"}}}).state("root.centered",{abstract:!0,views:{"layout@":{templateUrl:"cache/common/layouts/centered.html"}}}),n.deferIntercept(),n.otherwise("/"),r.baseUrl=(_.includes(window.location.host,"localhost")?"http":"https")+"://"+a.webApi.host+"/api/v1/account/",r.loginUrl="/login",r.tokenName="accessToken",r.google({clientId:a.socialAuth.google.clientId,url:"/google"}),r.github({clientId:a.socialAuth.github.clientId,url:"/github"}),o.definePalette("qdbdPalette",{50:"#b6c1cb",100:"#8a9aab",200:"#697e93",300:"#4b5b6a",400:"#3f4b58",500:"#323c46",600:"#252d34",700:"#181d22",800:"#0c0e10",900:"#000000",A100:"#b6c1cb",A200:"#8a9aab",A400:"#3f4b58",A700:"#181d22",contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:void 0}),o.theme("default").primaryPalette("qdbdPalette"),o.theme("warning"),o.theme("error")}function i(e,t,i,n){function o(){e.sync(),e.listen()}i.resolveCurrentUser().then(o,o),t.addEventListener("load",(function(){t.cookieconsent&&t.cookieconsent.initialise({palette:{popup:{background:"#282d32",text:"#c9cccf"},button:{background:"#1e5ba2"}},position:"bottom-left",content:{href:"https://www.quickdatabasediagrams.com/privacy-and-security.html"},cookie:{domain:n.webApp.cookieConsentDomain}})}))}t.$inject=["$httpProvider","$stateProvider","$locationProvider","$urlRouterProvider","$mdThemingProvider","$authProvider","AppConfig","localStorageServiceProvider"],i.$inject=["$urlRouter","$window","AccountService","AppConfig"],angular.module("QdbdApp",["ngCookies","ngSanitize","ngMessages","ngFileSaver","LocalStorageModule","ui.router","ngMaterial","ui.ace","satellizer","html5DragDrop","angular-loading-bar","QdbdApp.Common","QdbdApp.MessageScreen","QdbdApp.Home","QdbdApp.Schema","QdbdApp.Login","QdbdApp.Register","QdbdApp.User","QdbdApp.Subscription","QdbdApp.Admin","QdbdApp.Voucher","QdbdApp.Collaborators","QdbdApp.Organization"]).config(t).run(i)}(QdbdApp||(QdbdApp={})),function(e){e.Component=function(e,t,i){return function(n){("string"==typeof e?angular.module(e):e).component(t,angular.extend(i,{controller:n}))}}}(QdbdApp||(QdbdApp={})),function(e){e.Controller=function(e,t){return function(i){("string"==typeof e?angular.module(e):e).controller(t,i)}}}(QdbdApp||(QdbdApp={})),function(e){e.Service=function(e,t){return function(i){("string"==typeof e?angular.module(e):e).service(t,i)}}}(QdbdApp||(QdbdApp={})),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Common",[]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Admin",[]).config(["$stateProvider",function(e){e.state("root.standard.admin",{url:"/admin",views:{"main-content":{templateUrl:"cache/modules/admin/admin.html"},"context-menu@root":{template:"Administration"}}}).state("root.standard.admin.userList",{url:"/users?page&pageSize&sortBy&search&sortOrder",views:{"admin-content":{template:"<dt-user-list filter='AdminVM.usersFilter'></dt-user-list>"}},data:{title:"Administration - Users"},params:{page:{dynamic:!0},pageSize:{dynamic:!0},sortBy:{dynamic:!0},search:{dynamic:!0},sortOrder:{dynamic:!0}}}).state("root.standard.admin.diagramList",{url:"/schemas?page&pageSize&sortBy&search&sortOrder",views:{"admin-content":{template:"<dt-schema-list filter='AdminVM.schemasFilter'></dt-schema-list>"}},data:{title:"Administration - Schemas"},params:{page:{dynamic:!0},pageSize:{dynamic:!0},sortBy:{dynamic:!0},search:{dynamic:!0},sortOrder:{dynamic:!0}}}).state("root.standard.admin.organizationList",{url:"/organizations?page&pageSize&sortBy&search&sortOrder",views:{"admin-content":{template:"<dt-organization-list filter='AdminVM.organizationsFilter'></dt-organization-list>"}},data:{title:"Administration - Organizations"},params:{page:{dynamic:!0},pageSize:{dynamic:!0},sortBy:{dynamic:!0},search:{dynamic:!0},sortOrder:{dynamic:!0}}}).state("root.standard.admin.organizationProGrantLogs",{url:"/organizations/proGrantLogs?organizationId&page&pageSize&sortBy&search&sortOrder",views:{"admin-content":{template:"<dt-organization-pro-grant-log-list></dt-organization-pro-grant-log-list>"}},data:{title:"Administration - Organization Pro Grant Access Logs"},params:{organizationId:{dynamic:!0},page:{dynamic:!0},pageSize:{dynamic:!0},sortBy:{dynamic:!0},search:{dynamic:!0},sortOrder:{dynamic:!0}}}).state("root.standard.admin.vouchersList",{url:"/vouchers?page&pageSize&sortBy&search&sortOrder",views:{"admin-content":{template:"<dt-voucher-list filter='AdminVM.voucherFilter'></dt-voucher-list>"}},data:{title:"Administration - Voucher"},params:{page:{dynamic:!0},pageSize:{dynamic:!0},sortBy:{dynamic:!0},search:{dynamic:!0},sortOrder:{dynamic:!0}}}).state("root.standard.admin.voucher",{url:"/voucher",views:{"admin-content":{templateUrl:"cache/modules/voucher/voucher.html"}},data:{title:"Administration - Voucher"},params:{voucher:null}})}]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Collaborators",[]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.DiagramFolder",[]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.DiagramRenderer",[]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Home",["QdbdApp.SourceEditor","QdbdApp.DiagramFolder","QdbdApp.DiagramRenderer"]).config(["$stateProvider",function(e){e.state("root.standardShrinkable.home",{url:"/",views:{"main-content":{templateUrl:"cache/modules/home/home.html"},"context-menu@root":{template:"<dt-source-editor-menu></dt-source-editor-menu>"}},data:{usesCustomPageTitleHandler:!0}}).state("root.standardShrinkable.diagram",{url:"/d/:shortcode?",views:{"main-content":{templateUrl:"cache/modules/home/home.html"},"context-menu@root":{template:"<dt-source-editor-menu></dt-source-editor-menu>"}},data:{usesCustomPageTitleHandler:!0}}).state("root.standardShrinkable.schema",{url:"/schema/:shortcode?",views:{"main-content":{templateUrl:"cache/modules/home/home.html"},"context-menu@root":{template:"<dt-source-editor-menu></dt-source-editor-menu>"}},data:{usesCustomPageTitleHandler:!0}})}]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Login",[]).config(["$stateProvider",function(e){e.state("root.centered.login",{url:"/sign-in",views:{"main-content":{templateUrl:"cache/modules/login/login.html"}},data:{isAnonymousOnlyRoute:!0,title:"Login"}})}]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.MessageScreen",[]).config(["$stateProvider",function(e){e.state("root.centered.successMessage",{url:"/success",views:{"main-content":{templateUrl:"cache/modules/message-screen/message-screen.html"}}}).state("root.centered.errorMessage",{url:"/error",views:{"main-content":{templateUrl:"cache/modules/message-screen/message-screen.html"}}})}]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Organization",[]).config(["$stateProvider",function(e){e.state("root.standard.organization",{url:"/organizations/:organizationId",views:{"main-content":{templateUrl:"cache/modules/organization/organization-admin.html"},"context-menu@root":{template:"Organization"}}}).state("root.standard.acceptOrganizationInvite",{url:"/organizations/:organizationId/accept-invite",views:{"main-content":{templateUrl:"cache/modules/organization/accept-organization-invite.html"}}}).state("root.standard.organization.userList",{url:"/users?page&pageSize&sortBy&search&sortOrder",views:{"admin-content":{template:"<dt-organization-user-list filter='AdminVM.usersFilter'></dt-organization-user-list>"}},params:{page:{dynamic:!0},pageSize:{dynamic:!0},sortBy:{dynamic:!0},search:{dynamic:!0},sortOrder:{dynamic:!0}}}).state("root.standard.organization.diagramsAccess",{url:"/diagrams/:diagramId/access?page&pageSize&sortBy&search&sortOrder",views:{"admin-content":{template:"<dt-organization-diagram-access filter='AdminVM.usersFilter'></dt-organization-diagram-access>"}},params:{page:{dynamic:!0},pageSize:{dynamic:!0},sortBy:{dynamic:!0},search:{dynamic:!0},sortOrder:{dynamic:!0}}}).state("root.standard.organization.diagrams",{url:"/diagrams",views:{"admin-content":{template:"<dt-organization-diagrams></dt-organization-diagrams>"}}}).state("root.standard.organization.foldersAccess",{url:"/folders/:folderId/access?page&pageSize&sortBy&search&sortOrder",views:{"admin-content":{template:"<dt-organization-folder-access filter='AdminVM.usersFilter'></dt-organization-folder-access>"}},params:{page:{dynamic:!0},pageSize:{dynamic:!0},sortBy:{dynamic:!0},search:{dynamic:!0},sortOrder:{dynamic:!0}}})}]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Register",[]).config(["$stateProvider",function(e){e.state("root.centered.register",{url:"/sign-up",views:{"main-content":{templateUrl:"cache/modules/register/register.html"}},data:{isAnonymousOnlyRoute:!0,title:"Register"}}).state("root.centered.confirmEmail",{url:"/confirm-email/:userId/{token:any}",views:{"main-content":{templateUrl:"cache/modules/register/confirm-email.html"}},data:{isAnonymousOnlyRoute:!0,title:"Confirm Email"}}).state("root.centered.confirmChangeEmail",{url:"/confirm-change-email/:userId/:email/{token:any}",views:{"main-content":{templateUrl:"cache/modules/register/confirm-change-email.html"}},data:{isAnonymousOnlyRoute:!0,title:"Confirm Change Email"}}).state("root.centered.forgotPassword",{url:"/forgot-password",views:{"main-content":{templateUrl:"cache/modules/register/forgot-password.html"}},data:{isAnonymousOnlyRoute:!0,title:"Forgot Password?"}}).state("root.centered.changePassword",{url:"/change-password",views:{"main-content":{templateUrl:"cache/modules/register/change-password.html"}},data:{isAnonymousOnlyRoute:!1,title:"Change Password"}}).state("root.centered.resetPassword",{url:"/reset-password/:userId/{token:any}",views:{"main-content":{templateUrl:"cache/modules/register/reset-password.html"}},data:{isAnonymousOnlyRoute:!1,title:"Reset Password"}}).state("root.centered.changeEmail",{url:"/change-email",views:{"main-content":{templateUrl:"cache/modules/register/change-email.html"}},data:{isAnonymousOnlyRoute:!1,title:"Change E-mail"}})}]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Schema",[]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.SourceEditor",[]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Subscription",[]).config(["$stateProvider",function(e){e.state("root.centered.subscribe",{url:"/subscribe",views:{"main-content":{templateUrl:"cache/modules/subscription/subscribe.html"}},data:{title:"Subscribe"}}).state("root.centered.billingDetails",{url:"/billing-details",views:{"main-content":{templateUrl:"cache/modules/subscription/billing-details.html"}},data:{title:"Billing Details"}}).state("root.centered.checkout",{url:"/checkout",views:{"main-content":{templateUrl:"cache/modules/subscription/checkout.html"}},data:{title:"Checkout"}}).state("root.centered.voucher",{url:"/voucher/:voucherCode",views:{"main-content":{templateUrl:"cache/modules/subscription/subscribe.html"}},data:{title:"Voucher"}}).state("root.centered.discount",{url:"/discount/:discountCode",views:{"main-content":{templateUrl:"cache/modules/subscription/subscribe.html"}},data:{title:"Discount"}})}]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.User",[]).config(["$stateProvider",function(e){e.state("root.standard.user",{url:"/user",views:{"main-content":{templateUrl:"cache/modules/user/user.html"},"context-menu@root":{template:"User"}}}).state("root.standard.user.profile",{url:"/:userId/profile",views:{"user-content":{templateUrl:"cache/modules/user/profile.html"}},data:{title:"Profile"}}).state("root.standard.user.diagrams",{url:"/:userId/diagrams?page&pageSize&sortBy&search&sortOrder",views:{"user-content":{template:"<dt-user-diagrams filter='UserVM.filter'></dt-user-diagrams>"}},data:{title:"Diagrams"},params:{page:{dynamic:!0},pageSize:{dynamic:!0},userId:{dynamic:!0},sortBy:{dynamic:!0},search:{dynamic:!0},sortOrder:{dynamic:!0}}}).state("root.standard.user.payments",{url:"/:userId/payments",views:{"user-content":{template:"<dt-user-payments user-id='UserVM.userId'></dt-user-payments>"}},data:{title:"Payments"}})}]),QdbdApp||(QdbdApp={}),angular.module("QdbdApp.Voucher",[]),function(e){!function(){function t(e,t,i){this.$mdDialog=e,this.SidenavService=t,this.TrackingService=i}t.$inject=["$mdDialog","SidenavService","TrackingService"],t.prototype.closeSidebar=function(){this.SidenavService.toggleRightSidenav()},t.prototype.loadDocsSection=function(e){this.trackDocumentation(e),this.docsSection=e},t.prototype.trackDocumentation=function(e){this.TrackingService.trackDocumetation(e.toUpperCase())},t.prototype.closeDocsSection=function(){this.docsSection=void 0},t=__decorate([e.Component("QdbdApp.Common","dtDocs",{templateUrl:"cache/common/components/dt-docs/dt-docs.html",controllerAs:"DtDocsVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i){this.$rootScope=e,this.AccountService=t,this.TrackingService=i}t.$inject=["$rootScope","AccountService","TrackingService"],t.prototype.logout=function(){this.AccountService.logout()},t.prototype.trackAccount=function(){this.TrackingService.trackAccount("Main")},t=__decorate([e.Component("QdbdApp.Common","dtHeader",{templateUrl:"cache/common/components/dt-header/dt-header.html",controllerAs:"DtHeaderVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e){this.$mdDialog=e}t.$inject=["$mdDialog"],t.prototype.closeDialog=function(){this.$mdDialog.cancel()},t=__decorate([e.Component("QdbdApp.Common","dtLoginRequired",{templateUrl:"cache/common/components/dt-login-required/dt-login-required.html",controllerAs:"DtLoginRequiredVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(){}t=__decorate([e.Component("QdbdApp.Common","dtNoItems",{bindings:{collection:"="},template:'\n      <div class="no-content">\n        <span ng-if="!DtNoItemsVM.collection && !DtNoItemsVM.collection.items">Loading, please wait...</span>\n        <span ng-if="DtNoItemsVM.collection.length === 0 || DtNoItemsVM.collection.items.length === 0">No items to display.</span>\n      </div>\n    ',controllerAs:"DtNoItemsVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(){}t=__decorate([e.Component("QdbdApp.Common","dtPager",{bindings:{filter:"=",collection:"=",pager:"="},templateUrl:"cache/common/components/dt-pager/dt-pager.html",controllerAs:"DtPagerVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){var o=this;this.$rootScope=e,this.$transitions=t,this.RoutingService=i,this.DiagramFolderService=n,this.folderTreeState=this.DiagramFolderService.folderTreeState,this.resolveButtonVisibility(),this.$transitions.onSuccess({},(function(){o.resolveButtonVisibility()}))}t.$inject=["$rootScope","$transitions","RoutingService","DiagramFolderService"],t.prototype.showFile=function(){this.DiagramFolderService.closeFolderTree()},t.prototype.openFolderTree=function(){this.DiagramFolderService.openFolderTree()},t.prototype.resolveButtonVisibility=function(){this.toolbarVisibility=this.toolbarVisibility||{};this.toolbarVisibility.isDiagramRoute=this.RoutingService.stateIncludes(["root.standardShrinkable.home","root.standardShrinkable.diagram"])},t=__decorate([e.Component("QdbdApp.Common","dtSideToolbar",{templateUrl:"cache/common/components/dt-side-toolbar/dt-side-toolbar.html",controllerAs:"DtSideToolbarVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(){}t=__decorate([e.Component("QdbdApp.Common","dtSortableHeading",{bindings:{filter:"=",pager:"=",name:"@",sortBy:"@"},templateUrl:"cache/common/components/dt-sortable-heading/dt-sortable-heading.html",controllerAs:"DtSortableHeadingVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t){this.$mdDialog=e,this.$state=t}t.$inject=["$mdDialog","$state"],t.prototype.subscribe=function(){this.$state.go("root.centered.subscribe"),this.closeDialog()},t.prototype.closeDialog=function(){this.$mdDialog.cancel()},t=__decorate([e.Component("QdbdApp.Common","dtSubscriptionRequired",{bindings:{customMessage:"@"},templateUrl:"cache/common/components/dt-subscription-required/dt-subscription-required.html",controllerAs:"DtSubscriptionRequiredVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e){this.$scope=e,this.registerWatcher()}t.$inject=["$scope"],t.prototype.registerWatcher=function(){this.$scope.$watch("DtValidationSummaryVM.model.validationSummary",this.initializeValidationSummary.bind(this))},t.prototype.initializeValidationSummary=function(){this.summaryMessages=[],this.model.validationSummary&&(this.summaryMessages=this.model.validationSummary)},t=__decorate([e.Component("QdbdApp.Common","dtValidationSummary",{bindings:{model:"="},templateUrl:"cache/common/components/dt-validation-summary/dt-validation-summary.html",controllerAs:"DtValidationSummaryVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function e(){}return Object.defineProperty(e,"Default",{get:function(){return{sharing:{defaultImage:"https://www.quickdatabasediagrams.com/assets/images/logo.svg",providers:{twitter:"https://twitter.com/intent/tweet?text=",google:"https://plus.google.com/share?url=",linkedin:"http://www.linkedin.com/shareArticle?mini=true&url="}}}},enumerable:!1,configurable:!0}),e}();e.AppConfigShared=t,angular.module("QdbdApp.Common").constant("AppConfigShared",t.Default)}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function e(){}return Object.defineProperty(e,"Default",{get:function(){return{webApp:{host:"app.quickdatabasediagrams.com",cookieConsentDomain:".quickdatabasediagrams.com"},webApi:{host:"api.quickdatabasediagrams.com"},buildVersion:"v2.4.344.0",socialAuth:{google:{clientId:"979186999325-dldbn1cko23gfl33m08bfh9l0h7t3a0j.apps.googleusercontent.com"},github:{clientId:"0855e2d885d04ff78c22"}},firebase:{apiKey:"AIzaSyDAv61hXgFhV69MURFEfXFTzC-EAeOnToE",databaseURL:"https://quickdbd.firebaseio.com"}}},enumerable:!1,configurable:!0}),e}();e.AppConfigRelease=t,angular.module("QdbdApp.Common").constant("AppConfig",t.Default)}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function e(){}return Object.defineProperty(e,"Default",{get:function(){return{schemaSections:["tables","settings","layout"],aliasSchemaSections:{rels:"relationships"},allowedRelTypes:[{caption:"One-TO-one",symbol:"-"},{caption:"One-TO-many",symbol:"-<"},{caption:"Many-TO-one",symbol:">-"},{caption:"Many-TO-many",symbol:">-<"},{caption:"One-TO-zero-or-one",symbol:"-0"},{caption:"Zero-or-one-TO-one",symbol:"0-"},{caption:"Zero-or-one-TO-zero-or-one",symbol:"0-0"},{caption:"One-TO-zero-or-many",symbol:"-0<"},{caption:"Zero-or-many-TO-one",symbol:">0-"}],tableSeparator:"-"}},enumerable:!1,configurable:!0}),e}();e.QdbdParserConfig=t,angular.module("QdbdApp.Common").constant("QdbdParserConfig",t.Default)}(QdbdApp||(QdbdApp={})),function(e){var t=function(){};e.Map=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function e(e,t,i){this.$scope=e,this.AccountService=t,this.ModelStateService=i,this.modelStatePropertyName=e.propertyName,this.$scope.validationMessage="",this.$scope.onFieldClicked=this.onFieldClicked.bind(this),this.$scope.$watch("model."+this.$scope.propertyName,this.onWatchedItemChanged.bind(this)),this.$scope.$watch("model.errors",this.onModelStateChanged.bind(this)),this.$scope.$watch("rootModel.errors",this.onModelStateChanged.bind(this))}return e.$inject=["$scope","AccountService","ModelStateService"],e.prototype.onWatchedItemChanged=function(e,t,i){e!==t&&(e||t)&&(this.ModelStateService.resetPropertyError(this.modelStatePropertyName,this.getModelState()),this.$scope.validationMessage="")},e.prototype.onFieldClicked=function(){},e.prototype.onModelStateChanged=function(){this.$scope.validationMessage=this.ModelStateService.findErrorMessage(this.modelStatePropertyName,this.getModelState())},e.prototype.getModelState=function(){return this.$scope.rootModel?this.$scope.rootModel.errors:this.$scope.model.errors},e}();e.DtInputCtrl=t;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onFieldClicked=function(){var e=this.$scope.model[this.$scope.propertyName];this.$scope.passwordValidation=this.AccountService.validatePassword(e||"")},t.prototype.onWatchedItemChanged=function(t,i){t!==i&&(t||i)&&(e.prototype.onWatchedItemChanged.call(this,t,i,void 0),this.$scope.passwordValidation=this.AccountService.validatePassword(t))},t}(t);function n(e,i){return _.extend(e,{restrict:"E",scope:{model:"=",rootModel:"=",disable:"=",showExtraValidation:"=",collectionName:"@",propertyName:"@",inputType:"@",label:"@",icon:"@",focusOn:"@",minDate:"="},controller:i||t})}e.DtInputPasswordCtrl=i,angular.module("QdbdApp.Common").directive("dtInputText",(function(){return n({templateUrl:"cache/common/directives/dt-form-elements/dt-input-text.html"})})).directive("dtInputTextI",(function(){return n({templateUrl:"cache/common/directives/dt-form-elements/dt-input-text-i.html"})})).directive("dtInputTextarea",(function(){return n({templateUrl:"cache/common/directives/dt-form-elements/dt-input-textarea.html"})})).directive("dtInputPassword",(function(){return n({templateUrl:"cache/common/directives/dt-form-elements/dt-input-password.html"},i)})).directive("noFloat",(function(){return{restrict:"A",link:function(e,t,i,n){t.on("keydown",(function(e){return!([110,190].indexOf(e.which)>-1)||(e.preventDefault(),!1)}))}}}))}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(){}return t.prototype.findErrorMessage=function(e,t){var i=this.findErrorKey(e,t);return i&&t[i]?t[i][0]:""},t.prototype.resetPropertyError=function(e,t){var i=this.findErrorKey(e,t);i&&(t[i]=void 0)},t.prototype.capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.prototype.findErrorKey=function(e,t){for(var i in t)if(i&&i.indexOf(e)>-1)return i;return""},t=__decorate([e.Service("QdbdApp.Common","ModelStateService")],t)}();e.ModelStateService=t}(QdbdApp||(QdbdApp={})),function(e){function t(e){return function(t){if(t){var i=t.split("-"),n=/Mac OS X/.test(e.navigator.userAgent),o=!n||i.length>2?"+":"",r={M:n?"?":"Ctrl",A:n?"Option":"Alt",S:"Shift"};return i.map((function(e,t){return t===i.length-1?e:r[e]})).join(o)}}}t.$inject=["$window"],angular.module("QdbdApp.Common").filter("keyboardShortcut",t)}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r,a,s,d,c,l,u){this.$rootScope=e,this.$http=t,this.$cookies=i,this.$state=n,this.$q=o,this.$mdDialog=r,this.$auth=a,this.localStorageService=s,this.BaseHttpService=d,this.AppStateService=c,this.ToastService=l,this.TrackingService=u,this.SHORTCODE_KEY="shortcode",this.EXPANDED_FOLDER_IDS_KEY="expandedFolderIds",this.SHOW_SHARED_DIAGRAMS_KEY="showSharedDiagrams"}return t.$inject=["$rootScope","$http","$cookies","$state","$q","$mdDialog","$auth","localStorageService","BaseHttpService","AppStateService","ToastService","TrackingService"],t.prototype.login=function(e){var t=this;this.clearLocalStorageData(),e.errors={},this.$auth.login(e).then((function(){t.resolveCurrentUser(),t.ToastService.showInfo("You are now logged in."),t.$state.go("root.standardShrinkable.home")}),(function(i){e.errors=i.data.errors;var n=i.data.validationSummary;1===n.length&&"Invalid credentials"===n[0]?t.$rootScope.$broadcast("toast-error","Invalid credentials"):e.validationSummary=n,i.data&&i.data.error_description&&(e.errors={},e.validationSummary=[i.data.error_description])}))},t.prototype.reAuthenticate=function(){var e=this;return this.$http.get("api/v1/account/refreshToken").then((function(t){return e.$auth.setToken(t.data.accessToken),e.resolveCurrentUser()}))},t.prototype.reAuthenticateIfNecessary=function(){this.$rootScope.currentUser.shouldUpdateToken&&this.reAuthenticate()},t.prototype.reAuthenticateIfCurrentUser=function(e){e===this.$rootScope.currentUser.userId&&this.reAuthenticate()},t.prototype.socialAuth=function(e){var t=this;this.clearLocalStorageData(),this.$auth.authenticate(e).then((function(){t.resolveCurrentUser().then((function(e){t.ToastService.showInfo("You are now logged in."),t.$state.go("root.standardShrinkable.home")}))}))},t.prototype.logout=function(){this.clearLocalStorageData(),this.$auth.logout(),this.$rootScope.currentUser=void 0,this.ToastService.showInfo("You are now logged out. See you soon!"),this.$rootScope.$broadcast("current-user-changed"),this.$state.go("root.standardShrinkable.home"),firebase.auth().signOut()},t.prototype.registerAccount=function(e){var t=this;this.clearLocalStorageData(),this.validatePassword(e.password).isValid&&this.BaseHttpService.post("api/v1/account/register",e,(function(e){t.$auth.setToken(e.data.accessToken),t.resolveCurrentUser(),t.ToastService.showInfo("Thanks for registering! Please check your email.")}))},t.prototype.resolveCurrentUser=function(){var e=this,t=this.$q.defer();return!this.$auth.isAuthenticated()&&this.$rootScope.currentUser?(this.$rootScope.currentUser=void 0,this.$rootScope.$broadcast("current-user-changed"),t.resolve(),t.promise):(this.$http.get("api/v1/account/userInfo").then((function(i){e.$rootScope.currentUser=i.data,e.$rootScope.$broadcast("current-user-changed"),e.TrackingService.updateUser(e.$rootScope.currentUser),e.reAuthenticateIfNecessary(),t.resolve(i)}),(function(i){e.$rootScope.currentUser=void 0,e.$rootScope.$broadcast("current-user-changed"),t.reject(i)})),t.promise)},t.prototype.clearLocalStorageData=function(){this.localStorageService.remove(this.SHORTCODE_KEY),this.localStorageService.remove(this.EXPANDED_FOLDER_IDS_KEY),this.localStorageService.remove(this.SHOW_SHARED_DIAGRAMS_KEY)},t.prototype.onUnauthorizedRequest=function(e,t){this.ToastService.showInfo("Login or higher permissions required")},t.prototype.confirmEmail=function(e,t){return this.BaseHttpService.put("api/v1/account/confirmEmail",{userId:e,token:t})},t.prototype.confirmChangeEmail=function(e,t,i){return this.BaseHttpService.put("api/v1/account/confirmChangeEmail",{userId:e,newEmail:t,token:i})},t.prototype.forgotPassword=function(e){return this.BaseHttpService.post("api/v1/account/forgotPassword",e)},t.prototype.changePassword=function(e){return this.BaseHttpService.put("api/v1/account/changePassword",e)},t.prototype.changeEmail=function(e){return this.BaseHttpService.put("api/v1/account/changeEmail",e)},t.prototype.resetPassword=function(e){var t=this;return this.BaseHttpService.put("api/v1/account/resetPassword",e,(function(e){t.$auth.setToken(e.data.accessToken),t.resolveCurrentUser()}))},t.prototype.resendConfirmationEmail=function(e){return this.$http.post("api/v1/account/resendConfirmationEmail/"+e,null)},t.prototype.isUserLoggedIn=function(){return this.$auth.isAuthenticated()&&!_.isEmpty(this.$rootScope.currentUser)},t.prototype.validatePassword=function(e){var t={minCharacters:e&&e.length>=8,lowercase:!!/^(?=.*[a-z])/.exec(e),uppercase:!!/^(?=.*[A-Z])/.exec(e),digits:!!/^(?=.*\d)/.exec(e),specials:!!/^(?=.*[$@$!%*?&])/.exec(e)};return t.isValid=!_.includes(_.values(t),!1),t},t.prototype.requireLogin=function(){return!this.isUserLoggedIn()&&(this.$mdDialog.show({template:"\n          <md-dialog aria-label='Login Required' class='modal-dialog action-required'>\n            <dt-login-required></dt-login-required>\n          </md-dialog>\n        ",parent:angular.element(document.body),clickOutsideToClose:!0}),!0)},t.prototype.requireSubscription=function(e){return!!this.requireLogin()||!this.$rootScope.currentUser.hasIndividualProAccess&&(e||(e=""),this.$mdDialog.show({template:"\n          <md-dialog aria-label='Pro Access Required' class='modal-dialog action-required'>\n            <dt-subscription-required custom-message='"+e+"'></dt-subscription-required>\n          </md-dialog>\n        ",parent:angular.element(document.body),clickOutsideToClose:!0}),!0)},t=__decorate([e.Service("QdbdApp.Common","AccountService")],t)}();e.AccountService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.$state=e}return t.$inject=["$state"],t.prototype.diagramFactory=function(){var e=this.$state.params.shortcode;return this.currentDiagram&&this.currentDiagram.shortcode===e||(this.currentDiagram={shortcode:e}),this.currentDiagram},t.prototype.getCurrentDiagram=function(){return this.currentDiagram},t=__decorate([e.Service("QdbdApp.Common","AppStateService")],t)}();e.AppStateService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n){this.$rootScope=e,this.$timeout=t,this.$window=i,this.localStorageService=n,this.TOUR_SEEN_KEY="tourSeen"}return t.$inject=["$rootScope","$timeout","$window","localStorageService"],t.prototype.initializeTour=function(){var e=this;this.isTourSeen()||this.$timeout((function(){var t=new e.$window.Shepherd.Tour({defaults:{classes:"shepherd-theme-arrows"}});$(window).width()<600?e.createSmallScreenTour(t):e.createDefaultTour(t),t.on("complete",(function(){angular.element(".tour-overlay-container").removeClass("visible"),angular.element(".tour-overlay").removeClass("active visible"),e.markTourAsSeen()})),t.start()}))},t.prototype.createSmallScreenTour=function(e){e.addStep("Welcome",{title:"Welcome to QuickDBD!",text:"We're glad you're interested in our app but you're seeing only a very limited functionality because you are viewing it on a small screen.For full experience please view it on a bigger screen.",advanceOn:".docs-link click",when:{show:function(){angular.element(".tour-overlay-container").addClass("visible"),angular.element(".tour-overlay").addClass("active visible")}},buttons:{text:"Ok",action:e.complete,classes:"exit-tour"}})},t.prototype.createDefaultTour=function(e){var t=[{text:"Exit",action:e.complete,classes:"exit-tour"},{text:"Next",action:e.next}];e.addStep("Welcome",{title:"Welcome to QuickDBD!",text:"Please click next for a quick tour of QuickDBD (1/4).",advanceOn:".docs-link click",when:{show:function(){angular.element(".tour-overlay-container").addClass("visible"),angular.element(".tour-overlay").addClass("active visible")}},buttons:t}),e.addStep("Editor",{text:"Define your schema here (2/4).",attachTo:".dragger-top right",advanceOn:".docs-link click",when:{show:function(){angular.element(".editor-overlay").removeClass("visible")}},buttons:t}),e.addStep("Renderer",{text:"To get a diagram here (3/4).",attachTo:".dragger-top left",advanceOn:".docs-link click",when:{show:function(){angular.element(".editor-overlay").addClass("visible"),angular.element(".renderer-overlay").removeClass("visible")}},buttons:t}),e.addStep("Docs",{text:"Learn more about the QuickDBD<br />syntax here (4/4).",attachTo:".docs-button bottom",advanceOn:".docs-link click",when:{show:function(){angular.element(".renderer-overlay").addClass("visible"),angular.element(".header-overlay").removeClass("visible")}},buttons:{text:"Exit",action:e.complete,classes:"exit-tour"}})},t.prototype.isTourSeen=function(){return this.localStorageService.get(this.TOUR_SEEN_KEY)},t.prototype.markTourAsSeen=function(){this.localStorageService.set(this.TOUR_SEEN_KEY,!0)},t=__decorate([e.Service("QdbdApp.Common","AppTourService")],t)}();e.AppTourService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.$http=e}return t.$inject=["$http"],t.prototype.post=function(e,t,i){return this.request(e,"post",t,i)},t.prototype.put=function(e,t,i){return this.request(e,"put",t,i)},t.prototype.request=function(e,t,i,n){i.errors={};var o=this.$http[t](e,i);return o.then(n,(function(e){i.errors=e.data.errors,i.validationSummary=e.data.validationSummary})),o},t=__decorate([e.Service("QdbdApp.Common","BaseHttpService")],t)}();e.BaseHttpService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.DialogService=e,this.initialize()}return t.$inject=["DialogService"],t.prototype.initialize=function(){var e=window.navigator.userAgent;this.isUnsupported=_.includes(e,"Trident"),this.isSpecial=!bowser.check({chrome:"69",opera:"55"},!0,e)},t.prototype.isUnsupportedBrowser=function(){return this.isUnsupported},t.prototype.isSpecialSnowflakeBrowser=function(){return this.isSpecial},t=__decorate([e.Service("QdbdApp.Common","BrowserSupportService")],t)}();e.BrowserSupportService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(){}return t.prototype.getUniqHash=function(e){var t,i,n,o,r,a,s,d;for(t=3&e.length,i=e.length-t,n=7,r=3432918353,a=461845907,d=0;d<i;)s=255&e.charCodeAt(d)|(255&e.charCodeAt(++d))<<8|(255&e.charCodeAt(++d))<<16|(255&e.charCodeAt(++d))<<24,++d,n=27492+(65535&(o=5*(65535&(n=(n^=s=(65535&(s=(s=(65535&s)*r+(((s>>>16)*r&65535)<<16)&4294967295)<<15|s>>>17))*a+(((s>>>16)*a&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(s=0,t){case 3:s^=(255&e.charCodeAt(d+2))<<16;case 2:s^=(255&e.charCodeAt(d+1))<<8;case 1:n^=s=(65535&(s=(s=(65535&(s^=255&e.charCodeAt(d)))*r+(((s>>>16)*r&65535)<<16)&4294967295)<<15|s>>>17))*a+(((s>>>16)*a&65535)<<16)&4294967295}return n^=e.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,"h"+((n^=n>>>16)>>>0)},t=__decorate([e.Service("QdbdApp.Common","CryptoService")],t)}();e.CryptoService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i){this.$mdDialog=e,this.$window=t,this.$document=i,this.trackTabFocus()}return t.$inject=["$mdDialog","$window","$document"],t.prototype.trackTabFocus=function(){this.$document.on("visibilitychange",this.onFocusChange.bind(this))},t.prototype.onFocusChange=function(){var e;!document.hidden&&this.onVisibilityChange&&((e=this.onVisibilityChange).fn.apply(e,this.onVisibilityChange.params),this.onVisibilityChange=null)},t.prototype.showDialogNotification=function(e,t){document.hidden?this.onVisibilityChange={fn:this.showDialogNotification.bind(this),params:[e,t]}:this.$mdDialog.show({template:"\n          <md-dialog aria-label='Notification' class='modal-dialog pushed'>\n            <md-dialog-content>\n              <md-content class='md-padding'>\n                <p>"+e+"</p>\n              </md-content>\n            </md-dialog-content>\n          </md-dialog>\n        ",parent:angular.element(document.body),clickOutsideToClose:t||!1})},t.prototype.closDialogNotification=function(){document.hidden?this.onVisibilityChange={fn:this.closDialogNotification.bind(this)}:this.$mdDialog.cancel()},t=__decorate([e.Service("QdbdApp.Common","DialogService")],t)}();e.DialogService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t){this.$http=e,this.$log=t}return t.$inject=["$http","$log"],t.prototype.logError=function(e){var t;try{t=JSON.stringify(e)}catch(e){t=e.message}return this.$http.post("api/v1/error/log",{error:t})},t=__decorate([e.Service("QdbdApp.Common","ErrorService")],t)}();e.ErrorService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function e(e,t,i,n){var o=this;this.$rootScope=e,this.$q=t,this.$log=i,this.AppConfig=n,this.request=function(e){return e.headers=e.headers||{},_.startsWith(e.url,"api")?e.url="//"+o.AppConfig.webApi.host+"/"+e.url:e.headers.Authorization=void 0,e||o.$q.when(e)},this.responseError=function(e){var t;return 0===e.status&&o.$rootScope.$broadcast("error-message",{header:"Unable to use the Internet connection",message:"The webpage can't load any data because your computer isn?t connected to the Internet."}),401!==e.status||o.isUserInfoUrl(e)?404===e.status?o.$rootScope.$broadcast("error-message",{message:"Resource does not exist",status:404}):409===e.status?e.data instanceof ArrayBuffer||o.$rootScope.$broadcast("toast-error",(null===(t=e.data)||void 0===t?void 0:t.message)||"An unknown error occured"):403===e.status?o.$rootScope.$broadcast("toast-error","You do not have permission to access this resource"):422===e.status||e.data&&!o.isUserInfoUrl(e)&&(e.data.exceptionMessage?o.$rootScope.$broadcast("toast-error",e.data.exceptionMessage):e.data.message&&o.$rootScope.$broadcast("toast-error",e.data.message)):o.$rootScope.$broadcast("unauthorized-request",e),o.$q.reject(e)}}return e.Factory=function(t,i,n,o){return new e(t,i,n,o)},e.Factory.$inject=["$rootScope","$q","$log","AppConfig"],e.prototype.isUserInfoUrl=function(e){return _.endsWith(e.config.url,"/api/v1/account/userInfo")},e}();e.HttpRequestInterceptor=t,angular.module("QdbdApp.Common").factory("httpRequestInterceptorFactory",t.Factory)}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.$state=e}return t.$inject=["$state"],t.prototype.pagerFactory=function(e,t,i,n){var o=this;return{onFilterChanged:function(t,r){o.onFilterChanged(t,r,e,i.bind(o),n)},sort:function(t){o.sort(t,e)},isFirstPage:function(){return o.isFirstPage(e)},isLastPage:function(){return o.isLastPage(e,t)},prev:function(){return o.prev(e)},next:function(){return o.next(e,t)},first:function(){return o.first(e)},last:function(){return o.last(e,t)}}},t.prototype.onFilterChanged=function(e,t,i,n,o){e.search!==t.search&&1!==i.page?i.page=1:n(),o&&this.$state.go(o,_.extend(this.$state.params,i))},t.prototype.sort=function(e,t){t.sortBy&&t.sortBy===e?t.sortOrder="descending"===t.sortOrder?"ascending":"descending":(t.sortBy=e,t.sortOrder="ascending")},t.prototype.isFirstPage=function(e){return 1===Number(e.page)},t.prototype.isLastPage=function(e,t){return Number(e.page)===t.pageCount},t.prototype.prev=function(e){e.page||(e.page=1),e.page--,e.page<1&&(e.page=1)},t.prototype.next=function(e,t){e.page||(e.page=1),e.page++,e.page>t.pageCount&&(e.page=t.pageCount)},t.prototype.first=function(e){e.page=1},t.prototype.last=function(e,t){e.page=t.pageCount},t=__decorate([e.Service("QdbdApp.Common","PagingService")],t)}();e.PagingService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.$http=e}return t.$inject=["$http"],t.prototype.filterLicenses=function(e){return this.$http.get("api/v1/proGrantAccessLog/filterLogs",{params:e})},t.prototype.getLatestRowForUser=function(e){return this.$http.get("api/v1/proGrantAccessLog/latest",{params:{email:e}})},t=__decorate([e.Service("QdbdApp.Common","ProAccessGrantLogService")],t)}();e.ProAccessGrantLogService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i){this.$timeout=e,this.$state=t,this.AccountService=i}return t.$inject=["$timeout","$state","AccountService"],t.prototype.handleAuthRedirects=function(){var e=this;this.$timeout((function(){var t=e.$state.$current.data;t&&!0===t.isAnonymousOnlyRoute&&e.AccountService.isUserLoggedIn()&&e.$state.go("root.standardShrinkable.home")}))},t.prototype.stateIncludes=function(e){var t=this;if(_.isString(e))return this.$state.includes(e);if(_.isArray(e)){var i=_.find(e,(function(e){return t.$state.includes(e)}));return!!i&&i.length>0}return!1},t=__decorate([e.Service("QdbdApp.Common","RoutingService")],t)}();e.RoutingService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o){this.$state=e,this.$window=t,this.$location=i,this.AppConfigShared=n,this.TrackingService=o,this.diagramTitleText="Check my QuickDBD diagram! ",this.diagramTitleTextTwitter="Check my @quick_dbd diagram! ",this.landingTitleText="Check out QuickDBD database diagramming tool! ",this.landingTitleTextTwitter="Check out @quick_dbd database diagramming tool! ",this.descriptionText="Quick Database Diagrams"}return t.$inject=["$state","$window","$location","AppConfigShared","TrackingService"],t.prototype.share=function(e){this.TrackingService.trackShare("get_link"===e?"LINK":e.toUpperCase()),this.isDiagramState()?this.shareUrl(this.$location.absUrl(),e):this.shareUrl("https://www.quickdatabasediagrams.com/",e)},t.prototype.shareUrl=function(e,t){var i=this.isDiagramState();switch(t){case"twitter":var n=i?this.diagramTitleTextTwitter:this.landingTitleTextTwitter,o=this.getTwitterShareLink(e,n);this.shareLink(o);break;case"facebook":var r=i?this.diagramTitleText:this.landingTitleText;this.facebookShare(e,r,this.descriptionText);break;case"google":o=this.getGoogleShareLink(e);this.shareLink(o);break;case"linkedin":r=i?this.diagramTitleText:this.landingTitleText,o=this.getLinkedinShareLink(e,r,this.descriptionText);this.shareLink(o);break;default:return}},t.prototype.getTwitterShareLink=function(e,t){return this.AppConfigShared.sharing.providers.twitter+encodeURIComponent(t+e)},t.prototype.getGoogleShareLink=function(e){return this.AppConfigShared.sharing.providers.google+encodeURIComponent(e)},t.prototype.getLinkedinShareLink=function(e,t,i){return this.AppConfigShared.sharing.providers.linkedin+encodeURIComponent(e)+"&title="+encodeURIComponent(t)+"&summary="+encodeURIComponent(i)+"&source=app.quickdatabasediagrams.com"},t.prototype.shareLink=function(e){var t=this.$window.screenLeft,i=this.$window.screenTop,n="width=600,height=600,resizable=yes,menubar=no,toolbar=no,scrollbars=yes,left="+((this.$window.innerWidth?this.$window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-300+t)+",top="+((this.$window.innerHeight?this.$window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-300+i);this.$window.open(e,"a",n).focus()},t.prototype.facebookShare=function(e,t,i){this.$window.FB.ui({method:"feed",name:t,link:encodeURI(e),picture:this.AppConfigShared.sharing.defaultImage,description:i,message:""})},t.prototype.isHomeState=function(){return this.$state.is("root.standardShrinkable.home")},t.prototype.isDiagramState=function(){return this.$state.is("root.standardShrinkable.diagram")},t.prototype.tweet=function(e){var t=this.getTwitterShareLink(window.location.origin,e);t=t.replace("TWITTER_LOVE_EMOJI","%F0%9F%98%8D"),this.shareLink(t)},t=__decorate([e.Service("QdbdApp.Common","SharingService")],t)}();e.SharingService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.$rootScope=e,this.rightSidenav={isOpen:!1}}return t.$inject=["$rootScope"],t.prototype.toggleRightSidenav=function(){this.rightSidenav.isOpen=!this.rightSidenav.isOpen},t=__decorate([e.Service("QdbdApp.Common","SidenavService")],t)}();e.SidenavService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n){this.$http=e,this.$log=t,this.FileSaver=i,this.ToastService=n}return t.$inject=["$http","$log","FileSaver","ToastService"],t.prototype.downloadGet=function(e,t){return this.$http.get(e,this.buildRequestConfig(t)).then(this.onSuccess.bind(this),this.onError.bind(this))},t.prototype.downloadPost=function(e,t,i){return this.$http.post(e,t,this.buildRequestConfig(i)).then(this.onSuccess.bind(this),this.onError.bind(this))},t.prototype.downloadFromString=function(e,t){var i=this;return this.$http.get(t,this.buildRequestConfig()).then((function(t){i.saveFile(e,t.data,"application/octet-stream")}),this.onError.bind(this))},t.prototype.downloadFromBlob=function(e,t){var i=this,n=URL.createObjectURL(t);return this.$http.get(n,this.buildRequestConfig()).then((function(t){i.saveFile(e,t.data,"application/octet-stream"),URL.revokeObjectURL(n)}),this.onError.bind(this))},t.prototype.buildRequestConfig=function(e){return{cache:!1,responseType:"arraybuffer",params:e}},t.prototype.onSuccess=function(e){var t=e.headers(),i=t["x-filename"]?decodeURIComponent(escape(t["x-filename"])):"download",n=t["content-type"]||"application/octet-stream";this.saveFile(i,e.data,n)},t.prototype.saveFile=function(e,t,i){try{var n=new Blob([t],{type:i});this.FileSaver.saveAs(n,e)}catch(e){this.handleException(e)}},t.prototype.onError=function(e){try{var t=String.fromCharCode.apply(null,new Uint8Array(e.data));this.ToastService.showError(t)}catch(e){this.handleException(e)}},t.prototype.handleException=function(e){this.ToastService.showWarning("Blob download not supported by your browser, please try in Chrome"),this.$log.error(e)},t=__decorate([e.Service("QdbdApp.Common","StreamDownloadService")],t)}();e.StreamDownloadService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.$mdToast=e}return t.$inject=["$mdToast"],t.prototype.showInfo=function(e,t){this.showToast(e,void 0,t)},t.prototype.showInfoWithAction=function(e,t,i){this.showToastWithAction(e,t,i,void 0)},t.prototype.showWarning=function(e){this.showToast(e,"warning")},t.prototype.showError=function(e){this.showToast(e,"error")},t.prototype.showToast=function(e,t,i){this.$mdToast.show(this.$mdToast.simple().textContent(e).position("top center").hideDelay(i||3e3).theme(this.getToastTheme(t)))},t.prototype.showToastWithAction=function(e,t,i,n){this.$mdToast.show(this.$mdToast.simple().textContent(e).action(t).highlightAction(!0).highlightClass("md-accent").position("bottom right").hideDelay(4e3).theme(this.getToastTheme(n))).then((function(e){"ok"===e&&i()}))},t.prototype.getToastTheme=function(e){return e?""+e:void 0},t=__decorate([e.Service("QdbdApp.Common","ToastService")],t)}();e.ToastService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r,a){this.$rootScope=e,this.$window=t,this.$filter=i,this.$location=n,this.$state=o,this.AppConfig=r,this.AppTourService=a,this.isChatEnabled=!1}return t.$inject=["$rootScope","$window","$filter","$location","$state","AppConfig","AppTourService"],t.prototype.initializeIntercom=function(){},t.prototype.flipSupportChat=function(){this.isChatEnabled=!this.isChatEnabled,this.restartIntercom()},t.prototype.enableIntercomChat=function(){this.$window.Intercom&&this.$window.Intercom("update",{hide_default_launcher:!1})},t.prototype.restartIntercom=function(){this.$window.Intercom&&(this.$window.Intercom("shutdown"),this.initializeIntercom())},t.prototype.updateUser=function(e){if(this.$window.Intercom){if(!e)return void this.$window.Intercom("update",{email:void 0});this.$window.Intercom("update",{user_id:e.userId,email:e.email,diagrams:e.schemaStats.diagramCount,max_tables:e.schemaStats.maxTableCount,avg_tables:e.schemaStats.avgTableCount,deleted_diagrams:e.schemaStats.deletedDiagramCount,created_at:this.toTimpestamp(e.dateCreated),ip_address:e.ipAddress,ip_find:"https://ipfind.co?ip="+e.ipAddress,mx_toolbox:"https://mxtoolbox.com/SuperTool.aspx?action=ptr%3a"+e.ipAddress+"&run=toolpage",profile_url:this.$state.href("root.standard.user.profile",{userId:e.userId},{absolute:!0}),has_pro_access:e.hasIndividualProAccess,subscription_expires_at:this.toTimpestamp(e.individualSubscriptionExpiresOn)})}},t.prototype.onRouteChange=function(){this.$window.gtag&&this.$window.gtag("config",this.$window.GA_TRACKING_ID,{page_path:this.$location.url()})},t.prototype.trackNewFile=function(){this.trackEvent("New File","Menu","File","",0,{created_at:this.getFormattedTimeNow()})},t.prototype.trackNewFolder=function(){this.trackEvent("New Folder","Menu","File","",0,{created_at:this.getFormattedTimeNow()})},t.prototype.trackSave=function(){this.trackEvent("Save Diagram","Menu","File","",0,{url:this.$window.location.href,saved_at:this.getFormattedTimeNow()})},t.prototype.trackShare=function(e){this.trackEvent("Share Diagram","Menu","Social",e,0,{type:e,url:this.$window.location.href,shared_at:this.getFormattedTimeNow()})},t.prototype.trackColorPalette=function(e){this.trackEvent("Color Palette","Menu","File",e,0,{changed_at:this.getFormattedTimeNow()})},t.prototype.trackExportToDoc=function(e){this.trackExport("Export to Doc",e)},t.prototype.trackExportToImg=function(e){this.trackExport("Export to Img",e)},t.prototype.trackExportToSql=function(e){this.trackExport("Export to SQL",e)},t.prototype.trackExport=function(e,t){var i="";switch(t.toUpperCase()){case"ANSISQL":i="ANSI";break;case"TSQL":i="T-SQL";break;default:i=t.toUpperCase()}this.trackEvent(e,"Menu","Export",i,0,{type:t,url:this.$window.location.href,exported_at:this.getFormattedTimeNow()})},t.prototype.trackImportFromSql=function(e){var t="";switch(e.toUpperCase()){case"ANSISQL":t="ANSI";break;case"TSQL":t="T-SQL";break;default:t=e.toUpperCase()}this.trackEvent("Import from SQL","Menu","Import",t,0,{type:e,url:this.$window.location.href,exported_at:this.getFormattedTimeNow()})},t.prototype.trackDocumetation=function(e){this.trackEvent("Documentation","Menu","Docs",e,0)},t.prototype.trackAccount=function(e){this.trackEvent("Account","Menu","Account",e,0)},t.prototype.trackZoom=function(e,t){this.trackEvent("Zoom","Diagram","Zoom",t,e)},t.prototype.trackEditor=function(e,t,i){this.trackEvent(i,"Editor",t,"",e)},t.prototype.trackPurchase=function(e,t){this.trackEvent("Subscribed","Commerce","Purchase",t,e,{type:t,purchased_at:this.getFormattedTimeNow()})},t.prototype.trackEvent=function(e,t,i,n,o,r){this.$window.gtag&&this.$window.gtag("event",e,{event_category:t,event_action:i||"click",event_label:n,value:o||0})},t.prototype.toTimpestamp=function(e){return e?Math.round(new Date(e).getTime()/1e3):"-"},t.prototype.getFormattedTimeNow=function(){return this.$filter("date")(new Date,"yyyy-MM-dd HH:mm:ss")},t.prototype.profitWellTrack=function(){var e={event:"start_pw"};this.$rootScope.currentUser&&this.$rootScope.currentUser.email&&(e.pw_user_email=this.$rootScope.currentUser.email),dataLayer&&dataLayer.push&&dataLayer.push(e)},t=__decorate([e.Service("QdbdApp.Common","TrackingService")],t)}();e.TrackingService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t){this.$state=e,this.$timeout=t,this.initializeFilters(),this.setupRoutes(),this.handleRouting()}t.$inject=["$state","$timeout"],t.prototype.setupRoutes=function(){var e=this;this.routes=[{caption:"Users",name:"root.standard.admin.userList"},{caption:"Diagrams",name:"root.standard.admin.diagramList"},{caption:"Organizations",name:"root.standard.admin.organizationList"},{caption:"Vouchers",name:"root.standard.admin.vouchersList"}],this.$timeout((function(){e.selectedTab=_.findIndex(e.routes,{name:e.$state.current.name})}))},t.prototype.handleRouting=function(){this.$state.is("root.standard.admin")&&this.$state.go("root.standard.admin.userList")},t.prototype.initializeFilters=function(){var e={page:this.$state.params.page||1,pageSize:this.$state.params.pageSize||20,search:this.$state.params.search,sortBy:this.$state.params.sortBy,sortOrder:this.$state.params.sortOrder};this.usersFilter={page:e.page,pageSize:e.pageSize,search:e.search,sortBy:["id","email","firstName","lastName","userDetail.lastActive","userDetail.createdAt"].includes(e.sortBy)?e.sortBy:"email",sortOrder:e.sortOrder},this.schemasFilter={page:e.page,pageSize:e.pageSize,search:e.search,sortBy:e.sortBy||"id",sortOrder:e.sortOrder},this.organizationsFilter={page:e.page,pageSize:e.pageSize,search:e.search,sortBy:"name",sortOrder:e.sortOrder},this.voucherFilter={page:e.page,pageSize:e.pageSize,search:e.search,sortBy:"id",sortOrder:e.sortOrder}},t.prototype.loadRoute=function(e){var t="root.standard.admin.userList"===e?this.usersFilter:"root.standard.admin.vouchersList"===e?this.voucherFilter:this.schemasFilter;this.$state.go(e,t)},t=__decorate([e.Controller("QdbdApp.Admin","AdminCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i){this.$http=e,this.$mdDialog=t,this.BaseHttpService=i}return t.$inject=["$http","$mdDialog","BaseHttpService"],t.prototype.getCollaborators=function(e,t){return"diagram"===t?this.getDiagramCollaborators(e):this.getFolderCollaborators(e)},t.prototype.getDiagramCollaborators=function(e){return this.$http.get("api/v1/collab/forDiagram/"+e)},t.prototype.getFolderCollaborators=function(e){return this.$http.get("api/v1/collab/forDiagramFolder/"+e)},t.prototype.createCollaborator=function(e,t){return"diagram"===t?this.createDiagramCollaborator(e):this.createDiagramFolderCollaborator(e)},t.prototype.createDiagramCollaborator=function(e){return delete e.folderId,this.BaseHttpService.post("api/v1/collab/forDiagram",e)},t.prototype.createDiagramFolderCollaborator=function(e){return e.folderId=+e.folderId,delete e.shortcode,this.BaseHttpService.post("api/v1/collab/forDiagramFolder",e)},t.prototype.removeCollaborator=function(e){return e.shortcode?this.removeDiagramCollaborator(e):this.removeDiagramFolderCollaborator(e)},t.prototype.removeDiagramCollaborator=function(e){return this.$http.put("api/v1/collab/removeForDiagram",e)},t.prototype.removeDiagramFolderCollaborator=function(e){return this.$http.put("api/v1/collab/removeForDiagramFolder",e)},t.prototype.leaveCollab=function(e){return this.$http.delete("api/v1/collab/leave/"+e)},t.prototype.collaborate=function(e,t,i){this.$mdDialog.show({template:"\n          <md-dialog aria-label='Shortcode' class='modal-dialog'>\n            <dt-collaborators identifier=\""+e+'"\n                              collab-type="'+t+'"\n                              is-owned-by-current-user="'+i+'">\n            </dt-collaborators>\n          </md-dialog>\n        ',parent:angular.element(document.body),clickOutsideToClose:!0})},t=__decorate([e.Service("QdbdApp.Collaborators","CollaboratorsService")],t)}();e.CollaboratorsService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){this.$scope=e,this.$mdDialog=t,this.CollaboratorsService=i,this.ToastService=n,this.model={},this.collaborators=[]}t.$inject=["$scope","$mdDialog","CollaboratorsService","ToastService"],t.prototype.$onInit=function(){this.collaborators=[],this.loadCollabs()},t.prototype.loadCollabs=function(){var e=this;this.CollaboratorsService.getCollaborators(this.identifier,this.collabType).then((function(t){e.collaborators=t.data}))},t.prototype.addCollaborator=function(e){var t=this;e.preventDefault(),"folder"===this.collabType?(this.model.folderId=this.identifier,this.model.shortcode=0):(this.model.folderId=0,this.model.shortcode=this.identifier),this.CollaboratorsService.createCollaborator(this.model,this.collabType).then((function(){t.loadCollabs(),t.model.email="";var e="folder"===t.collabType?"folder":"diagram";t.ToastService.showInfo("Invited user to collaborate on this  "+e+".")}))},t.prototype.removeCollaborator=function(e,t){var i=this;e.preventDefault();var n="<p>Are you sure you want to remove the collaborator <b>"+t.email+"</b> from this item?</p>",o=this.$mdDialog.confirm().title("Remove collaborator").htmlContent(n).ok("Yes").cancel("No").multiple(!0).clickOutsideToClose(!0);this.$mdDialog.show(o).then((function(){i.CollaboratorsService.removeCollaborator(t).then((function(){i.loadCollabs(),i.ToastService.showInfo("Collaborator successfully removed")}))}))},t.prototype.closeDialog=function(){this.$mdDialog.cancel()},t=__decorate([e.Component("QdbdApp.Collaborators","dtCollaborators",{bindings:{identifier:"@",collabType:"@",isOwnedByCurrentUser:"="},templateUrl:"cache/modules/collaborators/dt-collaborators.html",controllerAs:"DtCollaboratorsVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r,a,s,d){this.$rootScope=e,this.$http=t,this.$state=i,this.$q=n,this.$mdDialog=o,this.localStorageService=r,this.BaseHttpService=a,this.ToastService=s,this.SchemaService=d,this.folderTreeState={isOpen:!1,showSharedDiagrams:!1},this.EXPANDED_FOLDER_IDS="expandedFolderIds",this.SHOW_SHARED_DIAGRAMS="showSharedDiagrams",this.folderTreeState.showSharedDiagrams=this.getShowSharedDiagrams(),this.expandedFolderIds=this.getExpandedFolderIds(),this.cache=this.cacheFactory()}return t.$inject=["$rootScope","$http","$state","$q","$mdDialog","localStorageService","BaseHttpService","ToastService","SchemaService"],t.prototype.getExpandedFolderIds=function(){return this.localStorageService.get(this.EXPANDED_FOLDER_IDS)||[]},t.prototype.getShowSharedDiagrams=function(){return this.localStorageService.get(this.SHOW_SHARED_DIAGRAMS)||!1},t.prototype.getFolderTree=function(){return this.getFlatTree().then((function(e){return e.data}))},t.prototype.getFlatFolderTree=function(){return this.getSharedFlatTree().then((function(e){return e.data}))},t.prototype.getFirstFolderDiagram=function(){return this.getFolderTree().then((function(e){return _.find(e,{itemType:"diagram"})}))},t.prototype.getFlatTree=function(){return this.$http.get("api/v1/diagramFolders/flatTree")},t.prototype.getSharedFlatTree=function(){return this.$http.get("api/v1/diagramFolders/sharedFlatTree")},t.prototype.removeExpandedFolderId=function(e){var t=this.expandedFolderIds.indexOf(e,0);t>-1&&this.expandedFolderIds.splice(t,1)},t.prototype.saveExpandedFolderIds=function(){this.localStorageService.set(this.EXPANDED_FOLDER_IDS,this.expandedFolderIds)},t.prototype.updateShowSharedDiagrams=function(e){this.folderTreeState.showSharedDiagrams=e,this.localStorageService.set(this.SHOW_SHARED_DIAGRAMS,e)},t.prototype.createFolder=function(){var e=this,t=this.$q.defer(),i=this.$mdDialog.prompt().title("Enter new folder name").placeholder("New Name").ariaLabel("New Folder Name").initialValue("New Folder").ok("Save").cancel("Cancel").clickOutsideToClose(!0);return this.$mdDialog.show(i).then((function(i){var n=e.$http.post("api/v1/diagramFolders",{name:i||"New Folder"});n.then((function(){e.ToastService.showInfo("Folder successfully created")}),(function(){e.ToastService.showInfo("An error occured, please try again")})),t.resolve(n)})),t.promise},t.prototype.renameFolder=function(e){return this.BaseHttpService.put("api/v1/diagramFolders/rename",e)},t.prototype.deleteFolder=function(e){return this.$http.delete("api/v1/diagramFolders/"+e)},t.prototype.openFolderTree=function(){this.folderTreeState.isOpen=!0},t.prototype.closeFolderTree=function(){this.folderTreeState.isOpen=!1},t.prototype.toggleFolderTree=function(){this.folderTreeState.isOpen=!this.folderTreeState.isOpen},t.prototype.goToFirstDiagram=function(e){var t=_.find(e,{itemType:"diagram"});t&&this.$state.go("root.standardShrinkable.diagram",{shortcode:t.shortcode})},t.prototype.cacheFactory=function(){var e=this;return{expandFolder:function(t){_.contains(e.expandedFolderIds,t)||(e.expandedFolderIds.push(t),e.saveExpandedFolderIds())},collapseFolder:function(t){e.removeExpandedFolderId(t),e.saveExpandedFolderIds()},isFolderExpanded:function(t){return _.contains(e.expandedFolderIds,t)}}},t=__decorate([e.Service("QdbdApp.DiagramFolder","DiagramFolderService")],t)}();e.DiagramFolderService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r,a,s,d,c,l,u){this.$scope=e,this.$rootScope=t,this.$state=i,this.$mdDialog=n,this.$timeout=o,this.SchemaService=r,this.DiagramFolderService=a,this.SourceEditorService=s,this.CollaboratorsService=d,this.OrganizationService=c,this.ToastService=l,this.TrackingService=u,this.tabIndex=0,this.folderTreeState=this.DiagramFolderService.folderTreeState,this.registerMenuActionListener(),this.initializeTree()}t.$inject=["$scope","$rootScope","$state","$mdDialog","$timeout","SchemaService","DiagramFolderService","SourceEditorService","CollaboratorsService","OrganizationService","ToastService","TrackingService"],t.prototype.registerMenuActionListener=function(){var e=this;this.$scope.$on("editor-menu-action",(function(t,i){e[i]&&e[i]()}))},t.prototype.initializeTree=function(){return this.DiagramFolderService.getShowSharedDiagrams()?this.getSharedFlatTree():this.getFlatTree()},t.prototype.getFlatTree=function(){var e=this;return this.DiagramFolderService.updateShowSharedDiagrams(!1),this.folderTree=null,this.resolveIndex(),this.DiagramFolderService.getFolderTree().then((function(t){return e.folderTree=t,e.autoExpandTreeItems(),t}))},t.prototype.getSharedFlatTree=function(){var e=this;return this.DiagramFolderService.updateShowSharedDiagrams(!0),this.folderTree=null,this.resolveIndex(),this.DiagramFolderService.getFlatFolderTree().then((function(t){return e.folderTree=t,e.autoExpandTreeItems(),t}))},t.prototype.autoExpandTreeItems=function(){var e=this;if(_.each(this.folderTree,(function(t){if(e.shouldexpandFolderTreeItem(t)){var i="folder"===t.itemType?t.id:t.parentId;e.expandTreeItems(i,!0)}})),!_.find(this.folderTree,{isExpanded:!0})){var t=this.getFirstFolderId();this.DiagramFolderService.cache.expandFolder(t),this.expandTreeItems(t,!0)}},t.prototype.shouldexpandFolderTreeItem=function(e){return"folder"===e.itemType&&this.DiagramFolderService.cache.isFolderExpanded(e.id)},t.prototype.shouldHideItemMenu=function(e){return"folder"===e.itemType&&(-1===e.id||0===e.id&&!e.isOwnedByCurrentUser||!e.isOwnedByCurrentUser&&!e.collabPermissionId)||"empty-folder-holder"===e.itemType},t.prototype.expandTreeItems=function(e,t){_.each(this.folderTree,(function(i){("folder"===i.itemType&&i.id===e||"folder"!==i.itemType&&i.parentId===e)&&(i.isExpanded=t)}))},t.prototype.onTreeItemClick=function(e){"empty-folder-holder"!==e.itemType&&("folder"===e.itemType?(e.isExpanded?this.DiagramFolderService.cache.collapseFolder(e.id):this.DiagramFolderService.cache.expandFolder(e.id),this.expandTreeItems(e.id,!e.isExpanded)):"diagram"===e.itemType?this.goToDiagram(e.shortcode):this.addDiagram(e))},t.prototype.isSelected=function(e){return e===this.$state.params.shortcode},t.prototype.addDiagram=function(e){var t=this;this.TrackingService.trackNewFile();var i=e.id||e.parentId;if(e.isOrganizationOwned){var n=this.$mdDialog.prompt().title("Enter new file name").placeholder("New Name").ariaLabel("New File Name").initialValue(this.SchemaService.getNewFileName()).ok("Save").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(n).then((function(e){t.OrganizationService.createOrganizationDiagram({folderId:i,organizationId:t.$rootScope.currentUser.organizationId,name:e}).then((function(){t.DiagramFolderService.cache.expandFolder(i),t.initializeTree()}))}))}else this.SchemaService.createDiagramInFolderWithNamePrompt(i).then((function(){t.DiagramFolderService.cache.expandFolder(i),t.initializeTree()}))},t.prototype.addFolder=function(){this.$rootScope.$broadcast("editor-menu-action","addRootFolder")},t.prototype.goToDiagram=function(e){var t=this;this.SchemaService.transitionToDiagram(e).then((function(){t.$rootScope.$broadcast("diagram-url-changed")}))},t.prototype.renameItem=function(e){var t=this,i=this.$mdDialog.prompt().title("Rename "+("folder"===e.itemType?"folder":"diagram")).placeholder("New name").ariaLabel("New name").initialValue(e.name).ok("Save").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(i){i?("folder"===e.itemType?t.DiagramFolderService.renameFolder({id:e.id,name:i}):t.SchemaService.renameDiagram({name:i,shortcode:e.shortcode})).then((function(){t.initializeTree(),t.ToastService.showInfo(("folder"===e.itemType?"Folder":"Diagram")+" successfully renamed")})):t.ToastService.showWarning("Name is required")}))},t.prototype.collaborate=function(e){this.CollaboratorsService.collaborate(e.shortcode||e.id,e.itemType,e.isOwnedByCurrentUser)},t.prototype.manageAccess=function(e){var t=this.$rootScope.currentUser.organizationId;if("folder"===e.itemType){var i=this.$state.href("root.standard.organization.foldersAccess",{organizationId:t,folderId:e.id});window.open(i,"_blank")}else if("diagram"===e.itemType){i=this.$state.href("root.standard.organization.diagramsAccess",{organizationId:t,diagramId:e.id});window.open(i,"_blank")}},t.prototype.deleteItem=function(e){var t=this,i=this.shouldUnloadSchemaAfterDelete(e),n="Confirm "+("folder"===e.itemType?"folder":"diagram")+" deletion",o="<p>Are you sure you want to delete "+(e.name?"<em>"+e.name+"</em>":"this item")+"?</p>";"folder"===e.itemType&&(o+="<p>Deleting this folder will also delete all files within it.</p>");var r=this.$mdDialog.confirm().title(n).htmlContent(o).ok("Yes").cancel("No").clickOutsideToClose(!0);this.$mdDialog.show(r).then((function(){i&&(t.SourceEditorService.clearLocalShortcode(),t.$rootScope.$broadcast("unload-editor-diagram")),("folder"===e.itemType?t.executeFolderDeletion(e):t.executeDiagramDeletion(e)).then((function(){t.ToastService.showInfo(("folder"===e.itemType?"Folder":"Diagram")+" successfully deleted"),t.initializeTree().then((function(e){i&&t.DiagramFolderService.goToFirstDiagram(e)}))}))}))},t.prototype.executeFolderDeletion=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return e.isOrganizationOwned?[4,this.OrganizationService.deleteOrganizationFolder(this.$rootScope.currentUser.organizationId,e.id)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,this.DiagramFolderService.deleteFolder(e.id)];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},t.prototype.executeDiagramDeletion=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return e.isOrganizationOwned?[4,this.OrganizationService.deleteOrganizationDiagram(this.$rootScope.currentUser.organizationId,e.id)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,this.SchemaService.deleteDiagram(e.shortcode)];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},t.prototype.leaveCollab=function(e){var t=this,i="<p>Are you sure you want to leave this "+("folder"===e.itemType?"folder":"diagram")+"?</p>",n=this.$mdDialog.confirm().title("Confirm share leaving").htmlContent(i).ok("Yes").cancel("No").clickOutsideToClose(!0);this.$mdDialog.show(n).then((function(){t.CollaboratorsService.leaveCollab(e.collabPermissionId).then(t.initializeTree.bind(t))}))},t.prototype.shouldUnloadSchemaAfterDelete=function(e){var t=this.$state.params.shortcode;if(!t)return!1;if("folder"===e.itemType){var i=e.id;return!!_.find(this.folderTree,(function(e){return e.parentId===i&&e.shortcode===t}))}return e.shortcode===t},t.prototype.onDragEnter=function(){var e=this;return function(t,i){e.folderTreeState.showSharedDiagrams||(angular.element(".drag-over").removeClass("drag-over"),i.addClass("drag-over"))}},t.prototype.onDrop=function(){var e=this;return function(t,i,n,o){if(!e.folderTreeState.showSharedDiagrams){var r=parseInt(i.attr("item-id"));i.removeClass("drag-over"),"true"===i.attr("is-droppable-folder")?(e.DiagramFolderService.cache.expandFolder(r),e.SchemaService.moveDiagramToFolder({parentId:r,shortcode:o.shortcode}).then(e.initializeTree.bind(e))):-1===r&&e.ToastService.showWarning("Items can't be moved to 'Unsaved Files'")}}},t.prototype.addRootFolder=function(){this.TrackingService.trackNewFolder(),this.DiagramFolderService.createFolder().then(this.initializeTree.bind(this))},t.prototype.addRootDiagram=function(){var e=this;this.TrackingService.trackNewFile(),this.SchemaService.createDiagramInFolderWithNamePrompt(0).then((function(){e.DiagramFolderService.cache.expandFolder(0),e.initializeTree()}))},t.prototype.getFolderIconClass=function(e){return-1===e.id&&"Unsaved Files"===e.name?"mdi-file-hidden":e.isExpanded?"mdi-folder-open":"mdi-folder"},t.prototype.getFolderName=function(e){return _.find(this.folderTree,{id:e,itemType:"folder"}).name},t.prototype.isLocked=function(e){return"diagram"===e.itemType&&!e.isEditable},t.prototype.isDefaultFolder=function(e){return"folder"===e.itemType&&0===e.id},t.prototype.resolveIndex=function(){this.tabIndex=this.DiagramFolderService.folderTreeState.showSharedDiagrams?1:0},t.prototype.getFirstFolderId=function(){var e=_.find(this.folderTree,{itemType:"folder"});return e?e.id:0},t=__decorate([e.Component("QdbdApp.DiagramFolder","dtDiagramFolder",{templateUrl:"cache/modules/diagram-folder/dt-diagram-folder.html",controllerAs:"DtDiagramFolderVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r){this.$rootScope=e,this.$log=t,this.TrackingService=i,this.StreamDownloadService=n,this.BrowserSupportService=o,this.ToastService=r,this.defaults={topLeft:{x:20,y:12},padding:{x:22,y:30}}}return t.$inject=["$rootScope","$log","TrackingService","StreamDownloadService","BrowserSupportService","ToastService"],t.prototype.exportToSVG=function(e,t){try{this.TrackingService.trackExportToImg("svg");var i=this.generateSVG(e,t),n=this.createExportImageName(e);this.StreamDownloadService.downloadFromString(n+".svg","data:application/svg+xml;charset=utf-8,"+encodeURIComponent(i))}catch(e){this.ToastService.showWarning("SVG export failed, please try in Chrome"),this.$log.error(e)}},t.prototype.exportToPNG=function(e,t){var i=this;if(this.BrowserSupportService.isSpecialSnowflakeBrowser())this.ToastService.showWarning("PNG export is unsupported by your browser. Please try Chrome, Brave or Opera.");else try{this.TrackingService.trackExportToImg("png");var n=this.generateSVG(e,t),o=this.createExportImageName(e),r=this.getBoundingBoxDimensions(e),a=document.createElement("canvas"),s=a.getContext("2d"),d=new Image;d.src="data:image/svg+xml;utf8,"+encodeURIComponent(n),d.onload=function(){a.width=r.width,a.height=r.height,s.drawImage(d,0,0),s.canvas.toBlob((function(e){i.StreamDownloadService.downloadFromBlob(o+".png",e)}))}}catch(e){this.ToastService.showWarning("PNG export failed, please try in Chrome"),this.$log.error(e)}},t.prototype.generateSVG=function(e,t){var i=angular.copy(angular.element(".canvas")),n=i.find(".drawing-wrapper")[0],o=this.getTopLeftPoint(e,t);n.setAttribute("transform","translate("+-o.x+", "+-o.y+") scale(1,1)");var r=i[0].innerHTML,a=$(r).wrapAll("<div>");return a.find(".connector").remove(),this.$rootScope.currentUser&&this.$rootScope.currentUser.hasIndividualProAccess||a.closest("svg").append("<text class='qdbd-link' x='10' y='20'>www.quickdatabasediagrams.com</text>"),a.closest("div").html()},t.prototype.getTopLeftPoint=function(e,t){var i={};_.each(e.layout,(function(e){i.x=_.min([e.x,i.x]),i.y=_.min([e.y,i.y])}));var n=_.size(t.sections.tables)===_.size(e.layout);return _.isEmpty(i)?(i.x=this.defaults.topLeft.x,i.y=this.defaults.topLeft.y):n||(i.x=_.min([this.defaults.topLeft.x,i.x]),i.y=_.min([this.defaults.topLeft.y,i.y])),i.x-=this.defaults.padding.x,i.y-=this.defaults.padding.y,i},t.prototype.getBoundingBoxDimensions=function(e){var t=angular.element(".canvas")[0].querySelector("svg").getBBox(),i=e.viewport?e.viewport.zoom:100;return{height:100*t.height/i+3*this.defaults.padding.x,width:100*t.width/i+2*this.defaults.padding.y}},t.prototype.createExportImageName=function(e){var t=e.sharedMetadata?e.sharedMetadata.name:null;return t?"QuickDBD-"+t:"QuickDBD-export"},t=__decorate([e.Service("QdbdApp.DiagramRenderer","DiagramExportService")],t)}();e.DiagramExportService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r,a,s,d){this.$rootScope=e,this.$scope=t,this.$timeout=i,this.QRendService=n,this.QRendConfig=o,this.SourceEditorService=r,this.SchemaFirebaseService=a,this.BrowserSupportService=s,this.TrackingService=d,this.isUnsupportedBrowser=this.BrowserSupportService.isUnsupportedBrowser(),this.$scope.$on("render-diagram",this.onRenderDiagram.bind(this)),this.registerOnSidebarResizeHandler()}t.$inject=["$rootScope","$scope","$timeout","QRendService","QRendConfig","SourceEditorService","SchemaFirebaseService","BrowserSupportService","TrackingService"],t.prototype.onRenderDiagram=function(e,t,i){var n=this;this.diagram=t,this.qdbdSchema=i,this.$timeout((function(){n.QRendService.initializeRendering(i,t,n.getDiagramStyle())}))},t.prototype.getDiagramStyle=function(){var e=angular.copy(this.QRendConfig.style);return this.SourceEditorService.isBasicPaletteActive()&&_.merge(e,this.QRendConfig.basicStyle),e},t.prototype.registerOnSidebarResizeHandler=function(){var e=this;angular.element("#dragger").mousedown((function(t){t.preventDefault();var i=angular.element("#main-content").width(),n=angular.element(".side-toolbar").width();angular.element(document).mousemove((function(t){var o=100*(t.pageX-n)/i;o<0&&(o=0),e.$timeout((function(){e.SourceEditorService.editorSize.x=o}))}))})),angular.element(document).mouseup((function(){angular.element(document).unbind("mousemove"),e.SourceEditorService.saveLocalEditorSize()}))},t.prototype.centerDiagram=function(){this.$rootScope.$broadcast("center-diagram",!0)},t.prototype.zoomIn=function(){var e=this.diagram.viewport.zoom;e=this.SourceEditorService.resolveZoomDiffValue(e,10),this.$rootScope.$broadcast("diagram-zoom-set",e,!0),this.TrackingService.trackZoom(e,"IN")},t.prototype.setZoom=function(e){this.$rootScope.$broadcast("diagram-zoom-set",e,!0),this.TrackingService.trackZoom(e,"SET")},t.prototype.zoomOut=function(){var e=this.diagram.viewport.zoom;e=this.SourceEditorService.resolveZoomDiffValue(e,-10),this.$rootScope.$broadcast("diagram-zoom-set",e,!0),this.TrackingService.trackZoom(e,"OUT")},t=__decorate([e.Component("QdbdApp.DiagramRenderer","dtDiagramRenderer",{templateUrl:"cache/modules/diagram-renderer/dt-diagram-renderer.html",controllerAs:"DtDiagramRendererVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function e(){}return Object.defineProperty(e,"Default",{get:function(){return{style:{canvas:{background:"#f5f6f6"},table:{minWidth:64,minMidSpacing:20,header:{background:"#005aa0",color:"#fff",border:{},height:40,padding:{x:13,y:25},highlighting:{color:"#1b9bff"}},contentPadding:{height:5},field:{background:"#fff",backgroundHover:"#f7f7f7",color:"#323c46",pkColor:"#005aa0",typeColor:"#adb1b5",border:{},height:25,padding:{x:13,y:16},icon:{color:"#c2c7ce",rightOffset:5,pk:{scale:.65,width:15,offset:{y:3}},uniq:{scale:.5,width:11,offset:{y:5.5}},index:{fill:"#afb3b6",stroke:"#000",scale:.014,width:10,offset:{y:5}}},highlighting:{color:"#e7f4ff"}}},relationship:{verticalOverlapOffset:60,stroke:{color:"#c3c3c3",width:1},hover:{stroke:{color:"#323c46",opacity:.035,width:13}},delete:{circle:{radius:6,color:"#fa5a3c"},x:{width:1,radius:3,color:"white"}},highlighting:{color:"#1b9bff"}},layout:{nonExisting:{padding:30,width:175}},port:{maxBasePull:50,pullCoefficient:1.6,defaultRadius:1,offset:{x:12,y:17},one:{height:6,offset:{x:6}},many:{length:7,height:6},zeroOne:{radius:3,offset:{x:5}},zeroMany:{radius:2.5},connector:{radius:4,sameSideThreshold:40,color:"#d2d2dc",padding:{y:12}}}},basicStyle:{canvas:{background:"white"},table:{header:{background:"white",color:"#323c46",fontWeight:"bold",border:{color:"#323c46",width:2},highlighting:{color:"#323c46",textColor:"white"}},field:{color:"#323c46",pkColor:"#323c46",typeColor:"#323c46",background:"white",backgroundHover:"#f3f3f3",border:{color:"#323c46",width:2},icon:{color:"#a0a0a0",index:{fill:"#a0a0a0",stroke:"#000"}},highlighting:{color:"#efefef"}}},relationship:{stroke:{color:"#4e4e4e"},highlighting:{color:"black"}},port:{connector:{color:"#424242"}}},shapes:{keyShape:"M7,14A2,2 0 0,1 5,12A2,2 0 0,1 7,10A2,2 0 0,1 9,12A2,2 0 0,1 7,14M12.65,10C11.83,7.67 9.61,6 7, 6A6, 6 0 0, 0 1, 12A6, 6 0 0, 0 7, 18C9.61, 18 11.83, 16.33 12.65, 14H17V18H21V14H23V10H12.65Z",uniqShape:"M22,18V22H18V19H15V16H12L9.74,13.74C9.19,13.91 8.61,14 8,14A6,6 0 0,1 2,8A6,6 0 0,1 8,2A6,6 0 0,1 14,8C14,8.61 13.91, 9.19 13.74, 9.74L22, 18M7, 5A2, 2 0 0, 0 5, 7A2, 2 0 0, 0 7, 9A2, 2 0 0, 0 9, 7A2, 2 0 0, 0 7, 5Z",indexShape:"M814.545 581.818v-23.273H535.273v-93.09h-46.546v93.09H209.455v139.637H256V605.09h232.727v93.09h46.546v-93.09H768v93.09h46.545V581.819zM674.91 465.455H349.091V139.636h325.818v325.819zM325.82 884.364H139.635V698.182h186.182v186.182z m279.272 0H418.909V698.182h186.182v186.182z m279.273 0H698.182V698.182h186.182v186.182zM395.636 418.909h232.728V186.182H395.636v232.727zM186.182 837.82h93.09v-93.092h-93.09v93.091z m279.273 0h93.09v-93.092h-93.09v93.091z m279.272 0h93.091v-93.092h-93.09v93.091z"}}},enumerable:!1,configurable:!0}),e}();e.QRendConfig=t,angular.module("QdbdApp.DiagramRenderer").constant("QRendConfig",t.Default)}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t){this.QRendTableService=e,this.QRendUtilsService=t,this.initializeCache()}return t.$inject=["QRendTableService","QRendUtilsService"],t.prototype.initializeCache=function(){this.cache={tableToHl:"",tableHashesToLeave:[],tableHashesToDim:[],relHashesToDim:[],relHashesToHl:[],style:null}},t.prototype.highlightCached=function(){var e=this.QRendUtilsService.createTableHtmlId(this.cache.tableToHl);0!==angular.element(".canvas").find("#"+e).length?this.highlight(this.cache):this.resetHighlighting()},t.prototype.highlight=function(e){this.dimElements(e.tableHashesToDim),this.dimElements(e.relHashesToDim),this.hlElements(e.relHashesToHl),this.QRendUtilsService.moveTablesToFront(e.tableHashesToLeave),this.highlightTable(e.tableToHl),this.highlightFields(e.fieldsToHl,e.style)},t.prototype.resetHighlighting=function(){this.clearDimming(),this.clearHighlighting(),this.initializeCache()},t.prototype.clickHighlight=function(e,t,i,n){this.resetHighlighting();var o=this.getRelsToLeave(e.sections.relationships,t),r=_.map(o,(function(e){return e.hash})),a=this.getRelsToDim(e.sections.relationships,r),s=_.map(a,(function(e){return e.hash})),d=this.getTablesIdentifiersToLeave(o,t),c=this.QRendUtilsService.createTableHtmlIds(d),l=this.getTableIdentifiersToDim(e.sections.tables,d,t),u=this.QRendUtilsService.createTableHtmlIds(l),h=this.getRelHashesToHl(o,i),m=this.getFieldsToHl(e.sections.tables,o,t,i);this.cache={tableToHl:t,fieldsToHl:m,tableHashesToLeave:c,tableHashesToDim:u,relHashesToHl:h,relHashesToDim:s,style:n},this.highlight(this.cache)},t.prototype.getRelsToLeave=function(e,t){return _.filter(e,(function(e){return e.table1.tableIdentifier===t||e.table2.tableIdentifier===t}))},t.prototype.getRelsToDim=function(e,t){return _.filter(e,(function(e){return!_.include(t,e.hash)}))},t.prototype.getTablesIdentifiersToLeave=function(e,t){var i=[];return _.each(e,(function(e){var n;e.table1.tableIdentifier===t?n=e.table2.tableIdentifier:e.table2.tableIdentifier===t&&(n=e.table1.tableIdentifier),n&&!_.find(i,(function(e){return e===n}))&&i.push(n)})),i},t.prototype.getTableIdentifiersToDim=function(e,t,i){return _.filter(_.keys(e),(function(e){return e!==i&&!_.includes(t,e)}))},t.prototype.getRelHashesToHl=function(e,t){if(!t)return[];var i=this.getRelsToHl(e,t);return _.map(i,(function(e){return e.hash}))},t.prototype.getRelsToHl=function(e,t){return _.filter(e,(function(e){return e.table1.fieldIdentifier===t||e.table2.fieldIdentifier===t}))},t.prototype.getFieldsToHl=function(e,t,i,n){return n?[{tableIdentifier:i,fieldIdentifier:n,fieldIndex:e[i].fields[n].order,tableWidth:null,cssClass:"fhl",drawConnectors:!1}]:[]},t.prototype.getSecondaryRelMember=function(e,t,i){var n;return e.table1.tableIdentifier===t&&e.table1.fieldIdentifier===i&&(n=e.table2),e.table2.tableIdentifier===t&&e.table2.fieldIdentifier===i&&(n=e.table1),n},t.prototype.hlElements=function(e){this.addClassToCanvasElements(e,"hl")},t.prototype.dimElements=function(e){this.addClassToCanvasElements(e,"dim")},t.prototype.addClassToCanvasElements=function(e,t){var i=angular.element(".canvas");_.each(e,(function(e){var n=i.find("#"+e);n&&n.addClass(t)}))},t.prototype.highlightTable=function(e){var t=this.QRendUtilsService.createTableHtmlId(e);angular.element(".canvas").find("#"+t).addClass("hl"),this.QRendUtilsService.moveTableToFront(t)},t.prototype.highlightFields=function(e,t){var i=this,n=angular.element(".canvas").find(".ts")[0];_.each(e,(function(e){var o=i.QRendUtilsService.createTableHtmlId(e.tableIdentifier),r=n.querySelector("#"+o),a=r.querySelector(".fa")||r.querySelector(".tf");e.tableWidth=parseInt(r.getAttribute("width"));var s=i.QRendTableService.createFieldBackground(e,t);r.insertBefore(s,a)}))},t.prototype.clearDimming=function(){angular.element(".canvas").find(".dim").removeClass("dim")},t.prototype.clearHighlighting=function(){var e=angular.element(".canvas");e.find(".hl").removeClass("hl"),e.find(".fhl").remove()},t=__decorate([e.Service("QdbdApp.DiagramRenderer","QRendEventHighlightService")],t)}();e.QRendEventHighlightService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r,a,s){this.$rootScope=e,this.QRendTableService=t,this.QRendRelService=i,this.QRendSvgService=n,this.QRendUtilsService=o,this.QRendEventHighlightService=r,this.SourceEditorService=a,this.TrackingService=s}return t.$inject=["$rootScope","QRendTableService","QRendRelService","QRendSvgService","QRendUtilsService","QRendEventHighlightService","SourceEditorService","TrackingService"],t.prototype.addEventHandlers=function(e,t,i,n){var o=angular.element(".canvas"),r=angular.element(".diagram-root")[0],a=angular.element(".drawing-wrapper")[0],s=angular.element(".hrs"),d=null,c=null,l=null,u=!1,h=null,m=null,p=null,g=this;function f(){var e=angular.element("#temp-connection");e&&e.remove()}function v(e){var t=document.elementFromPoint(e.clientX,e.clientY);return t&&t.classList.contains("dc")}!function(){var e;function i(i,o){if(i){var r=-(i.x-d.x),s=-(i.y-d.y);t.viewport.position.x+=r,t.viewport.position.y+=s,n(a,t.viewport),g.$rootScope.$broadcast("diagram-dragged",t.viewport.position),e=!0}}function s(t){c=null,l&&(l(),l=null),o.removeClass("dragged"),function(t){!e&&function(e){var t=document.elementFromPoint(e.clientX,e.clientY);return t&&t.classList.contains("diagram-root")}(t)&&g.QRendEventHighlightService.resetHighlighting()}(t),f()}r.addEventListener("mousedown",(function(t){return e=!1,c=i,void o.addClass("dragged")})),r.addEventListener("mousemove",(function(e){return t=e,i=d,n=o.offset(),d={x:t.clientX-n.left,y:t.clientY-n.top},void(c&&c(i,d));var t,i,n})),r.addEventListener("mouseup",(function(e){return s(e)})),r.addEventListener("mouseleave",(function(e){return s(e)})),r.addEventListener("wheel",(function(e){return function(e){if(g.SourceEditorService.isCanvasMouseZoomEnabled()){var i=Math.sign(-1*e.deltaY),o=10*i,r=!1,s=t.viewport.zoom/100;t.viewport.zoom+=o,t.viewport.zoom>200?(t.viewport.zoom=200,r=!0):t.viewport.zoom<10&&(t.viewport.zoom=10,r=!0);var c=t.viewport.zoom/100;if(!r&&d){var l={x:t.viewport.position.x/s,y:t.viewport.position.y/s},u={x:d.x/s,y:d.y/s},h={x:u.x-l.x,y:u.y-l.y},m={x:d.x/c,y:d.y/c},p={x:m.x-h.x,y:m.y-h.y},f={x:p.x*c,y:p.y*c};t.viewport.position.x=f.x,t.viewport.position.y=f.y}n(a,t.viewport),g.$rootScope.$broadcast("diagram-viewport-set",t.viewport),g.TrackingService.trackZoom(t.viewport.zoom,i>0?"IN":"OUT")}}(e)}))}(),_.each(t.layout,(function(n,a){return function(n,a){var s=g.QRendUtilsService.createTableHtmlId(a),v=r.querySelector("#"+s),b=null;function S(e){c=D,b=null,u=!1,g.QRendUtilsService.moveTableElementToFront(v),e.stopPropagation()}function y(t){c=null,u?m=null:(m||p?m=null:g.QRendEventHighlightService.clickHighlight(e,a),m&&m.line&&g.$rootScope.$broadcast("diagram-table-row-clicked",m.line))}function D(e){var i=t.viewport.zoom/100;u=!0,w(e,i),A()}function w(e,t){var i=-(e.x-d.x)/t,o=-(e.y-d.y)/t;n.x+=i,n.y+=o,v.setAttribute("x",n.x),v.setAttribute("y",n.y),g.$rootScope.$broadcast("diagram-table-moved",n,a)}function A(){if(!b){var n=_.filter(e.sections.relationships,(function(e){return e.table1.tableIdentifier===a||e.table2.tableIdentifier===a}));b=_.map(n,(function(e){return{object:e,element:r.querySelector("#"+g.QRendUtilsService.createRelationshipHtmlId(e))}}))}_.each(b,(function(n){g.QRendRelService.updateRelationship(n.element,e,t,n.object,i)}))}function C(n){n&&(function(n,a,s,v){if(!v.querySelector(".fa")){var b=parseInt(v.getAttribute("width")),S=v.querySelector(".tf");_.each(n.fields,(function(a){var y=g.QRendTableService.createFieldBackground({fieldIdentifier:a.identifier,fieldIndex:a.order,tableIdentifier:s,tableWidth:b,cssClass:"fa",drawConnectors:"qdbdvirtualfield"!==a.identifier},i);v.insertBefore(y,S),function(n,a,s,v,b){var S=g.QRendUtilsService.createConnectorHtmlClass(a.identifier,n.identifier),y="temp-connection",D=null,w=null,A=null;function C(){var e=b.getElementsByClassName(S);A={left:{element:e[0],orientation:"left"},right:{element:e[1],orientation:"right"}}}function M(e){e.element.addEventListener("mousedown",(function(t){return x(t,e)}))}function T(e){m=n}function $(t){u||m!==n||g.QRendEventHighlightService.clickHighlight(e,a.identifier,n.identifier,i)}function I(e){p&&(l=P,v.querySelector(".bg").classList.add("hover"))}function k(e){p&&(l=O,v.querySelector(".bg").classList.remove("hover"))}function x(e,i){e.stopPropagation();var r=t.viewport.zoom/100,a=o.offset();c=E,p=n,D=b.width.baseVal.value*r;var s=V(e,r);w={x:s-a.left,y:e.y-a.top,orientation:i.orientation,type:"none"}}function E(){F(),z(g.QRendRelService.createConnectorPath(w,d,i))}function V(e,t){return document.elementFromPoint(e.clientX,e.clientY).getBoundingClientRect().left+i.port.connector.radius*t}function P(){p&&g.$rootScope.$broadcast("diagram-ports-connected",{fromLine:p.line,toTable:a.caption,toField:n.caption,toLine:n.line}),O()}function F(){"left"===w.orientation?d.x>w.x+D+i.port.connector.sameSideThreshold&&(w.orientation="right",w.x+=D):d.x<w.x-D-i.port.connector.sameSideThreshold&&(w.orientation="left",w.x-=D)}function z(e){(h=r.querySelector("#"+y))?h.setAttribute("d",e):r.appendChild(g.QRendSvgService.svgRelationshipPathFactory(y,e))}function O(){f(),w=null,h=null,D=null,p=null,m=null}v.addEventListener("mousedown",T),v.addEventListener("mouseup",$),"qdbdvirtualfield"!==n.identifier&&(v.addEventListener("mouseenter",I),v.addEventListener("mouseleave",k),C(),M(A.left),M(A.right))}(a,n,0,y,v)}))}}(e.sections.tables[a],0,a,v),p||v.classList.add("hover"))}function M(e){e&&(v.classList.remove("hover"),angular.element(".fa").remove())}v.addEventListener("mousedown",S),v.addEventListener("mouseup",y),v.addEventListener("mouseenter",C),v.addEventListener("mouseleave",M)}(n,a)})),function(){var n=angular.element(".r");function o(e){v(e)||s.empty()}function r(e){s.empty()}n.on("mouseenter",(function(n){if(s.empty(),!p){var a=n.target,d=a.attributes.d.value,c=_.find(e.sections.relationships,{hash:a.id}),l=g.QRendRelService.getRelationshipMidpoint(e,t,c,i),u=g.QRendSvgService.svgPathFactory(d,{class:"hr"}),h=g.QRendSvgService.svgCircleFactory(l.x,l.y,i.relationship.delete.circle.radius,{class:"dc"}),m=g.QRendSvgService.svgDeletePathX(l,i.relationship.delete.x.radius);s.append(u),s.append(h),s.append(m),u.addEventListener("mouseleave",o),h.addEventListener("mouseleave",r),h.addEventListener("click",(function(e){return t=c,g.$rootScope.$broadcast("diagram-link-removed",t.line),void s.empty();var t}))}})),n.on("mouseleave",(function(e){(function(e){var t=document.elementFromPoint(e.clientX,e.clientY);return t&&t.classList.contains("hr")})(e)||v(e)||s.empty()}))}()},t=__decorate([e.Service("QdbdApp.DiagramRenderer","QRendEventService")],t)}();e.QRendEventService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t){this.QRendSvgService=e,this.QRendUtilsService=t}return t.$inject=["QRendSvgService","QRendUtilsService"],t.prototype.createRelationships=function(e,t,i){var n=this,o=this.QRendSvgService.svgGroupFactory({class:"rs"});return _.each(e.sections.relationships,(function(r){var a=n.createRelationship(e,t,r,i);o.appendChild(a)})),o},t.prototype.createRelationship=function(e,t,i,n){var o=this.createRelationshipPath(e,t,i,n);return i.hash=this.QRendUtilsService.createRelationshipHtmlId(i),this.QRendSvgService.svgRelationshipPathFactory(i.hash,o)},t.prototype.updateRelationship=function(e,t,i,n,o){var r=this.createRelationshipPath(t,i,n,o);e.setAttribute("d",r)},t.prototype.createRelationshipPath=function(e,t,i,n){var o=this.createRelationshipPort(e,t,i.table1,n),r=this.createRelationshipPort(e,t,i.table2,n);return this.isSelfReferencingRelationship(i)?this.createSameSideRelationshipPath(o,r,n):this.isVerticallyOverlappingRelationship(o,r,n)?(this.adjustSameSidePortOrientation(o,r),this.createSameSideRelationshipPath(o,r,n)):(this.adjustDifferentSidePortOrientation(o,r),this.createDifferentSideRelationshipPath(o,r,n))},t.prototype.getRelationshipMidpoint=function(e,t,i,n){var o=this.createRelationshipPort(e,t,i.table1,n),r=this.createRelationshipPort(e,t,i.table2,n);if(this.isSelfReferencingRelationship(i)){var a=this.getCShapedBezier(o,r,n);return this.getCShapeBezierMidpoint(a)}if(this.isVerticallyOverlappingRelationship(o,r,n)){this.adjustSameSidePortOrientation(o,r);a=this.getCShapedBezier(o,r,n);return this.getCShapeBezierMidpoint(a)}return this.adjustDifferentSidePortOrientation(o,r),this.getSShapedBezier(o,r,n).portMidpoint},t.prototype.isSelfReferencingRelationship=function(e){return e.table1.tableIdentifier===e.table2.tableIdentifier},t.prototype.isVerticallyOverlappingRelationship=function(e,t,i){var n=i.relationship.verticalOverlapOffset;return e.x>=t.x-n&&e.x<=t.adjustedRightX+n||e.adjustedRightX>=t.x-n&&e.adjustedRightX<=t.adjustedRightX+n},t.prototype.adjustSameSidePortOrientation=function(e,t){var i=Math.abs(e.x-t.x);Math.abs(e.adjustedRightX-t.adjustedRightX)<i&&(e.x=e.adjustedRightX,e.orientation="right",t.x=t.adjustedRightX,t.orientation="right")},t.prototype.createSameSideRelationshipPath=function(e,t,i){var n=this.getCShapedBezier(e,t,i),o="M"+this.QRendSvgService.formatPathPoint(n.port1)+" C "+this.QRendSvgService.formatPathPoint(n.controlPoint1)+", "+this.QRendSvgService.formatPathPoint(n.controlPoint2)+", "+this.QRendSvgService.formatPathPoint(n.port2);return this.createRelationshipPathCommand(o,e,t,i)},t.prototype.getCShapedBezier=function(e,t,i){var n=this.calculatePointDistance(e,t)/3,o="left"===e.orientation,r=o?-1:1,a=e.x-t.x,s=_.min([n,i.port.maxBasePull])*r,d=a*i.port.pullCoefficient,c=0,l=0;return o?a<0?l=d:c=-d:a<0?c=-d:l=d,{port1:e,controlPoint1:{x:e.x+s+c,y:e.y},controlPoint2:{x:t.x+s+l,y:t.y},port2:t}},t.prototype.createDifferentSideRelationshipPath=function(e,t,i){var n=this.getSShapedBezier(e,t,i),o="M"+this.QRendSvgService.formatPathPoint(n.port1)+" Q "+this.QRendSvgService.formatPathPoint(n.controlPoint)+", "+this.QRendSvgService.formatPathPoint(n.portMidpoint)+" T "+this.QRendSvgService.formatPathPoint(t);return this.createRelationshipPathCommand(o,e,t,i)},t.prototype.createRelationshipPathCommand=function(e,t,i,n){return this.createCrowsFootPath(t,n)+" "+e+" "+this.createCrowsFootPath(i,n)},t.prototype.getSShapedBezier=function(e,t,i){var n=this.calculateMidpoint(e,t);return{port1:e,controlPoint:{x:this.calculateMidpoint(e,n).x,y:e.y},portMidpoint:n,port2:t}},t.prototype.adjustDifferentSidePortOrientation=function(e,t){e.adjustedRightX<t.x?(e.x=e.adjustedRightX,e.orientation="right"):e.x>t.adjustedRightX&&(t.x=t.adjustedRightX,t.orientation="right")},t.prototype.createRelationshipPort=function(e,t,i,n){var o=i.tableIdentifier,r=i.fieldIdentifier,a=this.QRendUtilsService.getSchemaField(e,o,r),s=t.layout[o];return this.createPort(s,a,i.type,n)},t.prototype.createPort=function(e,t,i,n){var o=e.x,r=_.round(o+e.width,2),a=o-n.port.offset.x,s=r+n.port.offset.x,d=n.table.header.height-n.table.field.height+(t.order+1)*n.table.field.height;return{x:a,y:e.y+d+n.port.offset.y,baseLeftX:o,baseRightX:r,adjustedLeftX:a,adjustedRightX:s,orientation:"left",type:i}},t.prototype.createCrowsFootPath=function(e,t){switch(e.type){case"one":return this.createOneCrowsFootPath(e,t);case"many":return this.createManyCrowsFootPath(e,t);case"zeroOne":return this.createZeroOneCrowsFootPath(e,t);case"zeroMany":return this.createZeroManyCrowsFootPath(e,t);case"none":return"";default:return this.createDefaultCrowsFootPath(e,t)}},t.prototype.createDefaultCrowsFootPath=function(e,t){var i="left"===e.orientation,n=i?-1:1,o=i?e.baseLeftX:e.baseRightX;return this.createDotPath(o,e.y,t.port.defaultRadius)+" "+this.createLinePath(o,e.y,o+n*t.port.offset.x,e.y)},t.prototype.createOneCrowsFootPath=function(e,t){var i="left"===e.orientation,n=i?-1:1,o=i?e.baseLeftX:e.baseRightX;return this.createDotPath(o,e.y,t.port.defaultRadius)+" "+this.createLinePath(o,e.y,o+n*t.port.offset.x,e.y)+" "+this.createLinePath(o+n*t.port.one.offset.x,e.y+t.port.one.height,o+n*t.port.one.offset.x,e.y-t.port.one.height)},t.prototype.createManyCrowsFootPath=function(e,t){var i="left"===e.orientation,n=i?-1:1,o=i?e.baseLeftX:e.baseRightX;return this.createDotPath(o,e.y,t.port.defaultRadius)+" "+this.createLinePath(o,e.y,o+n*t.port.offset.x,e.y)+" "+this.createFootPath(o,e.y,n,t)},t.prototype.createZeroOneCrowsFootPath=function(e,t){var i="left"===e.orientation,n=i?-1:1,o=i?e.baseLeftX:e.baseRightX,r=t.port.offset.x/2;return this.createDotPath(o,e.y,t.port.defaultRadius)+" "+this.createLinePath(o,e.y,o+n*(r-t.port.zeroOne.radius),e.y)+" "+this.createCirclePath(o+n*r,e.y,t.port.zeroOne.radius)+" "+this.createLinePath(o+n*(r+t.port.zeroOne.radius),e.y,o+n*t.port.offset.x,e.y)},t.prototype.createZeroManyCrowsFootPath=function(e,t){var i="left"===e.orientation,n=i?-1:1,o=i?e.baseLeftX:e.baseRightX;return this.createDotPath(o,e.y,t.port.defaultRadius)+" "+this.createLinePath(o,e.y,o+n*t.port.many.length,e.y)+" "+this.createFootPath(o,e.y,n,t)+" "+this.createCirclePath(o+n*(t.port.offset.x-t.port.zeroMany.radius),e.y,t.port.zeroMany.radius)},t.prototype.createLinePath=function(e,t,i,n){var o=this.QRendSvgService.formatPathCoordinates(e,t);return"M"+o+" L"+o+" "+this.QRendSvgService.formatPathCoordinates(i,n)},t.prototype.createFootPath=function(e,t,i,n){var o=this.createDotPath(e,t+n.port.many.height,n.port.defaultRadius),r=this.QRendSvgService.formatPathCoordinates(e,t+n.port.many.height);return o+" M"+r+" L"+r+" "+this.QRendSvgService.formatPathCoordinates(e+i*n.port.many.length,t)+" "+this.QRendSvgService.formatPathCoordinates(e,t-n.port.many.height)+" "+this.createDotPath(e,t-n.port.many.height,n.port.defaultRadius)},t.prototype.createDotPath=function(e,t,i){return i<=0?"":this.createCirclePath(e,t,i)+" "+this.createDotPath(e,t,i-.5)},t.prototype.createCirclePath=function(e,t,i){return["M "+e+" "+t,"m -"+i+", 0","a "+i+","+i+" 0 1,0 "+2*i+",0","a "+i+","+i+" 0 1,0 -"+2*i+",0"].join(" ")},t.prototype.calculateMidpoint=function(e,t){return{x:_.round((e.x+t.x)/2,2),y:_.round((e.y+t.y)/2,2)}},t.prototype.calculatePointDistance=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},t.prototype.createHoverRelationshipsContainer=function(){return this.QRendSvgService.svgGroupFactory({class:"hrs"})},t.prototype.getCShapeBezierMidpoint=function(e){for(var t=[e.port1,e.controlPoint1,e.controlPoint2,e.port2],i=[],n=1;n<4;n++){var o=this.calculateMidpoint(t[n-1],t[n]);i.push(o)}return i.push(this.calculateMidpoint(i[0],i[1])),i.push(this.calculateMidpoint(i[1],i[2])),i.push(this.calculateMidpoint(i[3],i[4])),i[5]},t.prototype.createConnectorPath=function(e,t,i){return t.type="none",this.isSameSameSideConnection(e,t,i)?this.createSameSideRelationshipPath(e,t,i):this.createDifferentSideRelationshipPath(e,t,i)},t.prototype.isSameSameSideConnection=function(e,t,i){return"left"===e.orientation?e.x-i.port.connector.sameSideThreshold<t.x:e.x+i.port.connector.sameSideThreshold>t.x},t=__decorate([e.Service("QdbdApp.DiagramRenderer","QRendRelService")],t)}();e.QRendRelService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t){this.QRendSvgService=e,this.QRendUtilsService=t}return t.$inject=["QRendSvgService","QRendUtilsService"],t.prototype.createStyleSheet=function(e){var t=this.QRendSvgService.svgStyleFactory(),i=this.getStyleRules(e);return t.textContent=this.buildStyle(i),t},t.prototype.getStyleRules=function(e){return{".diagram-root":{"font-family":'"Helvetica Neue", sans-serif',"font-size":"12px"},".t":{overflow:"visible"},".t-bg":{y:e.table.header.height,fill:e.table.field.background,stroke:e.table.field.border.color,"stroke-width":e.table.field.border.width},".th":{fill:e.table.header.background,stroke:e.table.header.border.color,"stroke-width":e.table.header.border.width},".tht":{fill:e.table.header.color,"font-size":"14px","font-weight":e.table.header.fontWeight},".tf":{fill:e.table.field.color,overflow:"visible"},".tf.pk":{fill:e.table.field.pkColor,"font-weight":"bold"},".tf.fk":{"font-weight":"bold"},".ty":{fill:e.table.field.typeColor,"font-weight":"normal","text-anchor":"end"},".r":{fill:"transparent",stroke:e.relationship.stroke.color,"stroke-width":e.relationship.stroke.width},".l":{stroke:e.relationship.stroke.width},".i":{fill:e.table.field.icon.color,stroke:e.table.field.icon.color},".i.ix":{fill:e.table.field.icon.index.fill,stroke:e.table.field.icon.index.stroke},".fa":{fill:"transparent",overflow:"visible"},".fa .bg.hover":{fill:e.table.field.backgroundHover},".c":{cy:e.port.connector.padding.y,r:e.port.connector.radius,stroke:e.port.connector.color,fill:e.port.connector.color},".hr":{fill:"transparent",stroke:e.relationship.hover.stroke.color,"stroke-opacity":e.relationship.hover.stroke.opacity,"stroke-width":e.relationship.hover.stroke.width},".dc":{stroke:e.relationship.delete.circle.color,fill:e.relationship.delete.circle.color},".x":{stroke:e.relationship.delete.x.color,"stroke-width":e.relationship.delete.x.width},".hl .th":{fill:e.table.header.highlighting.color},".hl .tht":{fill:e.table.header.highlighting.textColor},".fhl .bg":{fill:e.table.field.highlighting.color},".fhls .bg":{fill:e.table.field.highlighting.softColor},".r.hl":{stroke:e.relationship.highlighting.color},".dim":{opacity:.25}}},t.prototype.buildStyle=function(e){var t=this;return _.map(e,(function(e,i){return t.buildSelectorStyle(i,e)})).join(" ")},t.prototype.buildSelectorStyle=function(e,t){return e+" { "+this.serializeRules(t)+" }"},t.prototype.serializeRules=function(e){return _.map(e,(function(e,t){return e?t+": "+e+";":""})).join(" ")},t=__decorate([e.Service("QdbdApp.DiagramRenderer","QRendStyleService")],t)}();e.QRendStyleService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.QRendConfig=e,this.shapes=this.QRendConfig.shapes}return t.$inject=["QRendConfig"],t.prototype.svgRootFactory=function(e){return this.svgElementFactory("svg",e)},t.prototype.svgStyleFactory=function(){return this.svgElementFactory("style")},t.prototype.svgGroupFactory=function(e){return this.svgElementFactory("g",e)},t.prototype.svgRectFactory=function(e){return this.svgElementFactory("rect",e)},t.prototype.svgTextFactory=function(e){return this.svgElementFactory("text",e)},t.prototype.svgPlainTextFactory=function(e,t){var i=this.svgElementFactory("text",t);return i.innerHTML=e,i},t.prototype.svgTSpanFactory=function(e,t){var i=this.svgElementFactory("tspan",t);return i.innerHTML=e,i},t.prototype.svgLineFactory=function(e,t){return this.svgElementFactory("line",{x1:e.x,y1:e.y,x2:t.x,y2:t.y,class:"l"})},t.prototype.svgRelationshipPathFactory=function(e,t){return this.svgPathFactory(t,{id:e,class:"r"})},t.prototype.svgPkIconFactory=function(e,t,i){var n={class:"i pk",transform:"translate("+e+", "+(t+i.table.field.icon.pk.offset.y)+")"+" "+("scale("+i.table.field.icon.pk.scale+")")};return this.svgPathFactory(this.shapes.keyShape,n)},t.prototype.svgUniqIconFactory=function(e,t,i){var n={class:"i uq",transform:"translate("+e+", "+(t+i.table.field.icon.uniq.offset.y)+")"+" "+("scale("+i.table.field.icon.uniq.scale+")")};return this.svgPathFactory(this.shapes.uniqShape,n)},t.prototype.svgIndexIconFactory=function(e,t,i){var n={class:"i ix",transform:"translate("+e+", "+(t+i.table.field.icon.index.offset.y)+")"+" "+("scale("+i.table.field.icon.index.scale+")")};return this.svgPathFactory(this.shapes.indexShape,n)},t.prototype.svgPathFactory=function(e,t){return this.svgElementFactory("path",_.extend({d:e},t))},t.prototype.svgConnectorFactory=function(e,t,i){return this.svgElementFactory("circle",_.extend({cx:e,class:t},i))},t.prototype.svgCircleFactory=function(e,t,i,n){var o=_.extend({cx:e,cy:t,r:i||5},n);return o.color&&(o.stroke=o.color,o.fill=o.color,delete o.color),this.svgElementFactory("circle",o)},t.prototype.svgDeletePathX=function(e,t){var i={x:e.x-t,y:e.y-t},n={x:e.x+t,y:e.y+t},o={x:e.x-t,y:e.y+t},r={x:e.x+t,y:e.y-t},a="M"+this.formatPathPoint(i)+" "+this.formatPathPoint(n)+" M"+this.formatPathPoint(o)+" "+this.formatPathPoint(r);return this.svgPathFactory(a,{class:"x"})},t.prototype.svgElementFactory=function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg",e);return t&&_.each(t,(function(e,t){i.setAttribute(t,e)})),i},t.prototype.formatPathPoint=function(e){return this.formatPathCoordinates(e.x,e.y)},t.prototype.formatPathCoordinates=function(e,t){return e+" "+t},t=__decorate([e.Service("QdbdApp.DiagramRenderer","QRendSvgService")],t)}();e.QRendSvgService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t){this.QRendSvgService=e,this.QRendUtilsService=t}return t.$inject=["QRendSvgService","QRendUtilsService"],t.prototype.createTables=function(e,t,i){var n=this,o=this.QRendSvgService.svgGroupFactory({class:"ts"});return _.each(e.sections.tables,(function(e,r){var a=n.createTable(e,r,t,i);o.appendChild(a)})),o},t.prototype.createTable=function(e,t,i,n){var o=this,r=i.layout[t],a=this.calculateTableWidth(e,i.sharedMetadata,n);r.width=a;var s=this.QRendSvgService.svgRootFactory({width:a,height:n.table.header.height+2*n.table.contentPadding.height+n.table.field.height*_.size(e.fields),x:r.x,y:r.y,id:this.QRendUtilsService.createTableHtmlId(t),class:"t"}),d=this.QRendUtilsService.getTableNameCaption(e),c=this.createTableHeader(d,a,n);_.each(c,(function(e){s.appendChild(e)}));var l=this.createTableBackground(a,_.size(e.fields),n);s.appendChild(l);var u=0;if(_.each(e.fields,(function(e){var t=o.createTableField(e,u,i.sharedMetadata,a,n);_.each(t,(function(e){return s.appendChild(e)})),u++})),_.isEmpty(e.fields)){var h=this.createEmptyTableField(u,i.sharedMetadata,a,n);_.each(h,(function(e){return s.appendChild(e)})),u++}return s},t.prototype.createTableHeader=function(e,t,i){return[this.QRendSvgService.svgRectFactory({height:i.table.header.height,width:t,class:"th"}),this.QRendSvgService.svgPlainTextFactory(e,{x:i.table.header.padding.x,y:i.table.header.padding.y,class:"tht"})]},t.prototype.createTableBackground=function(e,t,i){var n=2*i.table.contentPadding.height;t=t||1;var o={height:i.table.field.height*t+n,width:e,class:"t-bg"};return i.isSupportedBrowser||(o.y=i.table.header.height),this.QRendSvgService.svgRectFactory(o)},t.prototype.createTableField=function(e,t,i,n,o){var r=o.table.header.height+o.table.contentPadding.height+o.table.field.height*t,a=this.createTableFieldText(e,i,n,r,o),s=this.createTableFieldIcons(e,i,n,r,o);return __spreadArrays([a],s)},t.prototype.createEmptyTableField=function(e,t,i,n){return this.createTableField({caption:"..."},e,t,i,n)},t.prototype.createTableFieldText=function(e,t,i,n,o){var r=this.QRendUtilsService.getTableFieldNameCaption(e),a=this.QRendSvgService.svgPlainTextFactory(r,{x:o.table.field.padding.x,y:n+o.table.field.padding.y,class:this.getTableFieldCssClass(e)});if(e.type){var s=this.QRendUtilsService.getTableFieldTypeCaption(e,t);a.appendChild(this.QRendSvgService.svgTSpanFactory(s,{x:i-o.table.field.padding.x,class:"ty"}))}return a},t.prototype.getTableFieldCssClass=function(e){var t="tf";return e.isPk?t+=" pk":e.isFk&&(t+=" fk"),t},t.prototype.createTableFieldIcons=function(e,t,i,n,o){var r=[],a=this.QRendUtilsService.getTableFieldTypeCaption(e,t),s=a?this.QRendUtilsService.calculateTableFieldTextWidth(a):0,d=i-o.table.field.padding.x-s;return e.isPk&&(d-=o.table.field.icon.pk.width,a&&(d-=o.table.field.icon.rightOffset),r.push(this.QRendSvgService.svgPkIconFactory(d,n,o))),e.isUniq&&(d-=o.table.field.icon.uniq.width,a&&(d-=o.table.field.icon.rightOffset),r.push(this.QRendSvgService.svgUniqIconFactory(d,n,o))),e.isIdx&&(d-=o.table.field.icon.index.width,a&&(d-=o.table.field.icon.rightOffset),r.push(this.QRendSvgService.svgIndexIconFactory(d,n,o))),r},t.prototype.calculateTableWidth=function(e,t,i){var n=this.QRendUtilsService.getTableNameCaption(e),o=this.QRendUtilsService.calculateTableHeaderTextWidth(n),r=this.calculateMaxFieldLength(e.fields,t,i),a=2*i.table.field.padding.x,s=_.max([i.table.minWidth,o,r]);return _.round(s+a,2)},t.prototype.calculateMaxFieldLength=function(e,t,i){var n=this;return _.max(_.map(e,(function(e){var o=n.QRendUtilsService.getTableFieldNameCaption(e),r=n.QRendUtilsService.getTableFieldTypeCaption(e,t),a=e.isNullable?"?":"",s=n.QRendUtilsService.calculateTableFieldTextWidth(o+r+a);return e.isPk&&(s+=i.table.field.icon.pk.width,r&&(s+=i.table.field.icon.rightOffset)),e.isUniq&&(s+=i.table.field.icon.uniq.width,r&&(s+=i.table.field.icon.rightOffset)),e.isIdx&&(s+=i.table.field.icon.index.width,r&&(s+=i.table.field.icon.rightOffset)),s})))+i.table.minMidSpacing},t.prototype.createFieldBackground=function(e,t){var i=t.table.header.height+t.table.contentPadding.height+t.table.field.height*e.fieldIndex,n=this.QRendSvgService.svgRootFactory({width:e.tableWidth,height:t.table.field.height,y:i,class:e.cssClass});if(n.appendChild(this.QRendSvgService.svgRectFactory({width:e.tableWidth,height:t.table.field.height,class:"bg"})),e.drawConnectors){var o=this.createFieldConnectors(e.tableIdentifier,e.fieldIdentifier,e.tableWidth,t);_.each(o,(function(e){n.appendChild(e)}))}return n},t.prototype.createFieldConnectors=function(e,t,i,n){var o="c "+this.QRendUtilsService.createConnectorHtmlClass(e,t),r={cy:n.port.connector.padding.y,r:n.port.connector.radius};return[this.QRendSvgService.svgConnectorFactory(0,o+" l",r),this.QRendSvgService.svgConnectorFactory(i,o+" r",r)]},t=__decorate([e.Service("QdbdApp.DiagramRenderer","QRendTableService")],t)}();e.QRendTableService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t){this.$rootScope=e,this.CryptoService=t}return t.$inject=["$rootScope","CryptoService"],t.prototype.getSchemaTable=function(e,t){return e.sections.tables[t]},t.prototype.getSchemaField=function(e,t,i){var n=this.getSchemaTable(e,t);return e.sections.settings.isCaseSensitive?n.fields[i]:_.find(n.fields,(function(e,t){return t.toLowerCase()===i.toLowerCase()}))},t.prototype.createTableHtmlIds=function(e){var t=this;return _.map(e,(function(e){return t.createTableHtmlId(e)}))},t.prototype.createTableHtmlId=function(e){return this.CryptoService.getUniqHash("t"+e)},t.prototype.createActiveFieldHtmlId=function(e,t){return this.CryptoService.getUniqHash("f"+e+t)},t.prototype.createRelationshipHtmlId=function(e){return this.CryptoService.getUniqHash("r"+e.table1.tableIdentifier+e.table1.fieldIdentifier+e.table2.tableIdentifier+e.table2.fieldIdentifier)},t.prototype.createConnectorHtmlClass=function(e,t){return this.CryptoService.getUniqHash("p"+e+t)},t.prototype.calculateTableHeaderTextWidth=function(e){return this.calculateTextWidth(e,"sans-serif",14)},t.prototype.calculateTableFieldTextWidth=function(e){return this.calculateTextWidth(e,"sans-serif",12)},t.prototype.calculateTextWidth=function(e,t,i){var n=this.get2dCtx();return n.font=i+"px "+t,n.measureText(e).width},t.prototype.get2dCtx=function(){if(!this.ctx){var e=document.createElement("canvas");this.ctx=e.getContext("2d")}return this.ctx},t.prototype.getTableNameCaption=function(e){return _.escape(e.caption)},t.prototype.getTableFieldNameCaption=function(e){return"qdbdvirtualfield"===e.identifier?"...":_.escape(e.caption)},t.prototype.getTableFieldTypeCaption=function(e,t){if(this.isObfuscatedField(e))return"";var i=e.type;if(!i||!_.trim(i)){if(!t||!t.defaultType)return"";i=t.defaultType}return e.isNullable?i+"?":i},t.prototype.isObfuscatedField=function(e){return"..."===e.caption&&"..."!==e.identifier},t.prototype.moveTablesToFront=function(e){var t=angular.element(".ts")[0];_.each(e,(function(e){var i=t.querySelector("#"+e);t.appendChild(i)}))},t.prototype.moveTableToFront=function(e){var t=angular.element(".ts")[0].querySelector("#"+e);this.moveTableElementToFront(t)},t.prototype.moveTableElementToFront=function(e){angular.element(".ts")[0].appendChild(e)},t=__decorate([e.Service("QdbdApp.DiagramRenderer","QRendUtilsService")],t)}();e.QRendUtilsService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r,a,s){this.SourceEditorService=e,this.BrowserSupportService=t,this.QRendStyleService=i,this.QRendTableService=n,this.QRendRelService=o,this.QRendSvgService=r,this.QRendEventService=a,this.QRendEventHighlightService=s}return t.$inject=["SourceEditorService","BrowserSupportService","QRendStyleService","QRendTableService","QRendRelService","QRendSvgService","QRendEventService","QRendEventHighlightService"],t.prototype.initializeRendering=function(e,t,i){this.clear(),e?e&&e.sections&&e.sections.tables&&t&&(console.time&&console.time(),e=angular.copy(e),t=angular.copy(t),i=angular.copy(i),this.ensureAllTableDataSet(e,t,i),this.optimizeCoordinateValues(t),this.resolveBrowserSupport(i),this.render(e,t,i),console.timeEnd&&console.timeEnd()):this.clear()},t.prototype.ensureAllTableDataSet=function(e,t,i){var n=0;this.SourceEditorService.ensureViewportExists(t),this.SourceEditorService.ensureSharedMetadataExists(t),this.SourceEditorService.ensureLayoutExists(t),_.each(e.sections.tables,(function(e){t.sharedMetadata.defaultType&&_.each(e.fields,(function(e){e.type||"qdbdvirtualfield"===e.identifier||(e.type=t.sharedMetadata.defaultType)})),t.layout[e.identifier]||(t.layout[e.identifier]={x:i.layout.nonExisting.padding+n*i.layout.nonExisting.width,y:i.layout.nonExisting.padding},n++)}))},t.prototype.optimizeCoordinateValues=function(e){_.each(e.layout,(function(e){e.x=_.round(e.x,2),e.y=_.round(e.y,2)}))},t.prototype.resolveBrowserSupport=function(e){e.isSupportedBrowser=!this.BrowserSupportService.isSpecialSnowflakeBrowser()},t.prototype.render=function(e,t,i){var n=this,o=this.getCanvas(),r=this.createDiagramRoot(i),a=this.QRendStyleService.createStyleSheet(i),s=this.createMainGroup(t),d=this.QRendTableService.createTables(e,t,i),c=this.QRendRelService.createRelationships(e,t,i),l=this.QRendRelService.createHoverRelationshipsContainer();o.appendChild(r),r.appendChild(a),r.appendChild(s),s.appendChild(c),s.appendChild(l),s.appendChild(d),this.QRendEventHighlightService.highlightCached(),this.QRendEventService.addEventHandlers(e,t,i,(function(e,t){return n.setDrawingTransformation(e,t)}))},t.prototype.clear=function(){for(var e=this.getCanvas();e.lastChild;)e.removeChild(e.lastChild)},t.prototype.getCanvas=function(){return angular.element(".canvas")[0]},t.prototype.createDiagramRoot=function(e){return this.QRendSvgService.svgRootFactory({class:"diagram-root",style:"background: "+e.canvas.background,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"})},t.prototype.createMainGroup=function(e){var t=this.QRendSvgService.svgGroupFactory({class:"drawing-wrapper"});return this.setDrawingTransformation(t,e.viewport),t},t.prototype.setDrawingTransformation=function(e,t){var i="translate("+t.position.x+", "+t.position.y+")",n=t.zoom?"scale("+t.zoom/100+")":"";e.setAttribute("transform",i+" "+n)},t=__decorate([e.Service("QdbdApp.DiagramRenderer","QRendService")],t)}();e.QRendService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){this.$scope=e,this.SidenavService=t,this.SourceEditorService=i,this.DiagramFolderService=n,this.folderTreeState={},this.rightSidenav=this.SidenavService.rightSidenav,this.editorSize=this.SourceEditorService.editorSize,this.folderTreeState=this.DiagramFolderService.folderTreeState}t.$inject=["$scope","SidenavService","SourceEditorService","DiagramFolderService"],t=__decorate([e.Controller("QdbdApp.Home","HomeCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t){this.$scope=e,this.AccountService=t,this.credentials={}}t.$inject=["$scope","AccountService"],t.prototype.login=function(){this.AccountService.login(this.credentials)},t.prototype.authenticate=function(e){this.AccountService.socialAuth(e)},t=__decorate([e.Controller("QdbdApp.Login","LoginCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e){this.MessageScreenService=e,this.init()}t.$inject=["MessageScreenService"],t.prototype.init=function(){this.message=this.MessageScreenService.message},t=__decorate([e.Controller("QdbdApp.MessageScreen","MessageScreenCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.$state=e,this.message={}}return t.$inject=["$state"],t.prototype.showSuccess=function(e){this.showMessage(e,"root.centered.successMessage")},t.prototype.showError=function(e){this.showMessage(e,"root.centered.errorMessage")},t.prototype.showMessage=function(e,t){this.resetErrorState(),this.message.status=e.status,this.message.header=e.header,this.message.message=e.message,this.message.buttonText=e.buttonText?e.buttonText:"Continue",this.message.redirectRoute=e.redirectRoute?e.redirectRoute:"root.standardShrinkable.home",this.$state.go(t)},t.prototype.resetErrorState=function(){this.message.status="",this.message.header=""},t=__decorate([e.Service("QdbdApp.MessageScreen","MessageScreenService")],t)}();e.MessageScreenService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r){this.$scope=e,this.$state=t,this.$rootScope=i,this.OrganizationService=n,this.ToastService=o,this.AccountService=r}t.$inject=["$scope","$state","$rootScope","OrganizationService","ToastService","AccountService"],t.prototype.$onInit=function(){var e=this;this.$rootScope.currentUser?this.$rootScope.currentUser.organizationId?this.$state.go("root.standardShrinkable.home"):this.OrganizationService.acceptOrganizationInvite(this.$state.params.organizationId).then((function(t){e.ToastService.showInfo("Invitation accepted successfully"),e.AccountService.reAuthenticate(),e.$state.go("root.standardShrinkable.home")})).catch((function(t){e.showValidationErrors(t)})):this.$state.go("root.standard.login")},t.prototype.showValidationErrors=function(e){if(422===e.status){var t=e.data.errors;for(var i in t)if(t.hasOwnProperty(i))for(var n=0,o=t[i];n<o.length;n++){var r=o[n];this.ToastService.showError(r)}}},t=__decorate([e.Controller("QdbdApp.Organization","AcceptOrganizationInviteCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r){this.$scope=e,this.$state=t,this.$mdDialog=i,this.OrganizationService=n,this.ToastService=o,this.PagingService=r,this.users={}}t.$inject=["$scope","$state","$mdDialog","OrganizationService","ToastService","PagingService"],t.prototype.$onInit=function(){var e=this;this.OrganizationService.getOrganizationDiagram(this.$state.params.organizationId,this.$state.params.diagramId).then((function(t){e.diagramName=t.data.name,e.shortcode=t.data.shortcode})),this.pager=this.PagingService.pagerFactory(this.filter,this.users,this.loadUsers.bind(this),"root.standard.organization.diagramAccess"),this.$scope.$watch("DtOrganizationDiagramAccessVM.filter",this.pager.onFilterChanged.bind(this),!0)},t.prototype.loadUsers=function(){var e=this;this.OrganizationService.filterOrganizationUsersForDiagram(__assign({organizationId:this.$state.params.organizationId,diagramId:this.$state.params.diagramId},this.filter)).then((function(t){_.extend(e.users,t.data)}))},t.prototype.changeCollaboratorStatus=function(e){e.isCollaborator?this.removeAccess(e):this.grantAccess(e)},t.prototype.grantAccess=function(e){var t=this,i=this.$mdDialog.confirm().title("Grant access?").htmlContent("Are you sure you want to grant access to this user for this diagram?").ok("Yes, grant access").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.OrganizationService.grantAccessToOrganizationDiagram(t.$state.params.diagramId,e.id).then((function(){t.ToastService.showInfo("Access Granted"),t.loadUsers()})).catch((function(e){t.showValidationErrors(e)}))}))},t.prototype.removeAccess=function(e){var t=this,i=this.$mdDialog.confirm().title("Remove access?").htmlContent("Are you sure you want to remove access from this user for this diagram?").ok("Yes, remove access").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.OrganizationService.removeAccessFromOrganizationDiagram(t.$state.params.diagramId,e.id).then((function(){t.ToastService.showInfo("Access Removed"),t.loadUsers()})).catch((function(e){t.showValidationErrors(e)}))}))},t.prototype.showValidationErrors=function(e){if(422===e.status){var t=e.data.errors;for(var i in t)if(t.hasOwnProperty(i))for(var n=0,o=t[i];n<o.length;n++){var r=o[n];this.ToastService.showError(r)}}},t=__decorate([e.Component("QdbdApp.Organization","dtOrganizationDiagramAccess",{bindings:{filter:"="},templateUrl:"cache/modules/organization/dt-organization-diagram-access/dt-organization-diagram-access.html",controllerAs:"DtOrganizationDiagramAccessVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o){this.$scope=e,this.$state=t,this.$mdDialog=i,this.OrganizationService=n,this.ToastService=o,this.folderItems=[]}t.$inject=["$scope","$state","$mdDialog","OrganizationService","ToastService"],t.prototype.$onInit=function(){this.initializeDiagrams()},t.prototype.initializeDiagrams=function(){var e=this;this.OrganizationService.getOrganizationFlatFolderTree(+this.$state.params.organizationId).then((function(t){_.extend(e.folderItems,t.data)}))},t.prototype.addFolder=function(){var e=this,t=this.$mdDialog.prompt().title("Rename Folder").placeholder("New name").ariaLabel("New name").initialValue("").ok("Save").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(t).then((function(t){e.OrganizationService.createOrganizationFolder({name:t,organizationId:+e.$state.params.organizationId}).then((function(){e.initializeDiagrams(),e.ToastService.showInfo("Folder created successfully")}))}))},t.prototype.addDiagram=function(e){var t=this,i=this.$mdDialog.prompt().title("Create Diagram").placeholder("Name").ariaLabel("Name").initialValue("").ok("Save").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(i){t.OrganizationService.createOrganizationDiagram({name:i,organizationId:+t.$state.params.organizationId,folderId:e.folderId}).then((function(){t.initializeDiagrams(),t.ToastService.showInfo("Diagram created successfully")}))}))},t.prototype.renameItem=function(e){"folder"===e.itemType?this.renameFolder(e):this.renameDiagram(e)},t.prototype.renameDiagram=function(e){var t=this,i=this.$mdDialog.prompt().title("Rename Diagram").placeholder("New name").ariaLabel("New name").initialValue(e.name).ok("Save").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(i){t.OrganizationService.renameOrganizationDiagram({name:i,diagramId:e.diagramId}).then((function(){t.initializeDiagrams(),t.ToastService.showInfo("Diagram renamed successfully")}))}))},t.prototype.renameFolder=function(e){var t=this,i=this.$mdDialog.prompt().title("Rename Folder").placeholder("New name").ariaLabel("New name").initialValue(e.name).ok("Save").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(i){t.OrganizationService.renameOrganizationFolder({name:i,folderId:e.folderId}).then((function(){t.initializeDiagrams(),t.ToastService.showInfo("Folder renamed successfully")}))}))},t.prototype.deleteItem=function(e){"folder"===e.itemType?this.deleteFolder(e):this.deleteDiagram(e)},t.prototype.deleteDiagram=function(e){var t=this,i=this.$mdDialog.confirm().title("Delete Diagram").htmlContent("Are you sure you want to delete this diagram?").ok("Yes, delete").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.OrganizationService.deleteOrganizationDiagram(t.$state.params.organizationId,e.diagramId).then((function(){t.initializeDiagrams(),t.ToastService.showInfo("Diagram deleted successfully")}))}))},t.prototype.deleteFolder=function(e){var t=this,i=this.$mdDialog.confirm().title("Delete Folder").htmlContent("Are you sure you want to delete this folder?").ok("Yes, delete").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.OrganizationService.deleteOrganizationFolder(t.$state.params.organizationId,e.folderId).then((function(){t.initializeDiagrams(),t.ToastService.showInfo("Folder deleted successfully")}))}))},t.prototype.onDragEnter=function(){return function(e,t){angular.element(".drag-over").removeClass("drag-over"),t.addClass("drag-over")}},t.prototype.onDrop=function(){var e=this;return function(t,i,n,o){var r=parseInt(i.attr("item-id"));i.removeClass("drag-over"),"true"===i.attr("is-droppable-folder")?e.OrganizationService.moveOrganizationDiagramToFolder(o.diagramId,r).then((function(){e.ToastService.showInfo("Diagram moved successfully"),e.initializeDiagrams()})):-1===r&&e.ToastService.showWarning("Items can't be moved to 'Unsaved Files'")}},t=__decorate([e.Component("QdbdApp.Organization","dtOrganizationDiagrams",{templateUrl:"cache/modules/organization/dt-organization-diagrams/dt-organization-diagrams.html",controllerAs:"DtOrganizationDiagramsVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r){this.$scope=e,this.$state=t,this.$mdDialog=i,this.OrganizationService=n,this.ToastService=o,this.PagingService=r,this.users={}}t.$inject=["$scope","$state","$mdDialog","OrganizationService","ToastService","PagingService"],t.prototype.$onInit=function(){var e=this;this.OrganizationService.getOrganizationFolder(this.$state.params.organizationId,this.$state.params.folderId).then((function(t){e.folderName=t.data.name})),this.pager=this.PagingService.pagerFactory(this.filter,this.users,this.loadUsers.bind(this),"root.standard.organization.folderAccess"),this.$scope.$watch("DtOrganizationFolderAccessVM.filter",this.pager.onFilterChanged.bind(this),!0)},t.prototype.loadUsers=function(){var e=this;this.OrganizationService.filterOrganizationUsersForFolder(__assign({organizationId:this.$state.params.organizationId,folderId:this.$state.params.folderId},this.filter)).then((function(t){_.extend(e.users,t.data)}))},t.prototype.changeCollaboratorStatus=function(e){e.isCollaborator?this.removeAccess(e):this.grantAccess(e)},t.prototype.grantAccess=function(e){var t=this,i=this.$mdDialog.confirm().title("Grant access?").htmlContent("Are you sure you want to grant access to this user for this folder?").ok("Yes, grant access").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.OrganizationService.grantAccessToOrganizationFolder(t.$state.params.folderId,e.id).then((function(){t.ToastService.showInfo("Access Granted"),t.loadUsers()})).catch((function(e){t.showValidationErrors(e)}))}))},t.prototype.removeAccess=function(e){var t=this,i=this.$mdDialog.confirm().title("Remove access?").htmlContent("Are you sure you want to remove access from this user for this folder?").ok("Yes, remove access").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.OrganizationService.removeAccessFromOrganizationFolder(t.$state.params.folderId,e.id).then((function(){t.ToastService.showInfo("Access Removed"),t.loadUsers()})).catch((function(e){t.showValidationErrors(e)}))}))},t.prototype.showValidationErrors=function(e){if(422===e.status){var t=e.data.errors;for(var i in t)if(t.hasOwnProperty(i))for(var n=0,o=t[i];n<o.length;n++){var r=o[n];this.ToastService.showError(r)}}},t=__decorate([e.Component("QdbdApp.Organization","dtOrganizationFolderAccess",{bindings:{filter:"="},templateUrl:"cache/modules/organization/dt-organization-folder-access/dt-organization-folder-access.html",controllerAs:"DtOrganizationFolderAccessVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i){this.$scope=e,this.OrganizationService=t,this.PagingService=i,this.organizations={}}t.$inject=["$scope","OrganizationService","PagingService"],t.prototype.$onInit=function(){this.pager=this.PagingService.pagerFactory(this.filter,this.organizations,this.loadOrganizations.bind(this),"root.standard.admin.organizationList"),this.$scope.$watch("DtOrganizationListVM.filter",this.pager.onFilterChanged.bind(this),!0)},t.prototype.loadOrganizations=function(){var e=this;this.OrganizationService.filterOrganizations(__assign({},this.filter)).then((function(t){_.extend(e.organizations,t.data)}))},t=__decorate([e.Component("QdbdApp.Organization","dtOrganizationList",{bindings:{filter:"="},templateUrl:"cache/modules/organization/dt-organization-list/dt-organization-list.html",controllerAs:"DtOrganizationListVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){this.$scope=e,this.$state=t,this.OrganizationService=i,this.PagingService=n,this.logs={}}t.$inject=["$scope","$state","OrganizationService","PagingService"],t.prototype.$onInit=function(){this.filter={organizationId:+this.$state.params.organizationId,page:this.$state.params.page||1,pageSize:this.$state.params.pageSize||40,search:this.$state.params.search,sortBy:this.$state.params.sortBy||"createdAt",sortOrder:this.$state.params.sortOrder||"descending"},this.pager=this.PagingService.pagerFactory(this.filter,this.logs,this.loadProGrantLogs.bind(this),"root.standard.admin.organizationProGrantLogs"),this.$scope.$watch("DtOrganizationProGrantLogListVM.filter",this.pager.onFilterChanged.bind(this),!0)},t.prototype.loadProGrantLogs=function(){var e=this;this.OrganizationService.filterProGrantLogs(__assign({organizationId:+this.$state.params.organizationId},this.filter)).then((function(t){_.extend(e.logs,t.data)}))},t=__decorate([e.Component("QdbdApp.Organization","dtOrganizationProGrantLogList",{templateUrl:"cache/modules/organization/dt-organization-pro-grant-log-list/dt-organization-pro-grant-log-list.html",controllerAs:"DtOrganizationProGrantLogListVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r){this.$scope=e,this.$state=t,this.$mdDialog=i,this.OrganizationService=n,this.ToastService=o,this.PagingService=r,this.users={}}t.$inject=["$scope","$state","$mdDialog","OrganizationService","ToastService","PagingService"],t.prototype.$onInit=function(){this.pager=this.PagingService.pagerFactory(this.filter,this.users,this.loadUsers.bind(this),"root.standard.organization.userList"),this.$scope.$watch("DtOrganizationUserListVM.filter",this.pager.onFilterChanged.bind(this),!0)},t.prototype.loadUsers=function(){var e=this;this.OrganizationService.filterOrganizationUsers(__assign({organizationId:+this.$state.params.organizationId},this.filter)).then((function(t){_.extend(e.users,t.data)}))},t.prototype.inviteUser=function(){var e=this,t=this.$mdDialog.prompt().title("Invite user").placeholder("Email").ariaLabel("Email").initialValue("").ok("Ok").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(t).then((function(t){t?e.OrganizationService.inviteUserToOrganization({organizationId:+e.$state.params.organizationId,email:t}).then((function(){e.ToastService.showInfo("User Invited"),e.loadUsers()})).catch((function(t){e.showValidationErrors(t)})):e.ToastService.showWarning("Email required")}))},t.prototype.changeAdminStatus=function(e){e.isAdmin?this.removeOrganizationAdmin(e):this.makeOrganizationAdmin(e)},t.prototype.makeOrganizationAdmin=function(e){var t=this,i=this.$mdDialog.confirm().title("WARNING - Promote User to Admin").htmlContent("Are you sure you want to make this user an admin of your organization?").ok("Yes, make admin").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.OrganizationService.makeOrganizationAdmin(+t.$state.params.organizationId,e.id).then((function(){t.ToastService.showInfo("User Made Admin"),t.loadUsers()}))}))},t.prototype.removeOrganizationAdmin=function(e){var t=this,i=this.$mdDialog.confirm().title("WARNING - Demote User from Admin").htmlContent("Are you sure you want to remove this user as an admin of your organization?").ok("Yes, remove admin").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.OrganizationService.removeOrganizationAdmin(+t.$state.params.organizationId,e.id).then((function(){t.ToastService.showInfo("Admin Removed"),t.loadUsers()}))}))},t.prototype.removeUser=function(e){var t,i,n=this,o=(null===(i=null===(t=this.users.items)||void 0===t?void 0:t.find((function(t){return t.id===e})))||void 0===i?void 0:i.hasProAccess)?"<br />This user still has an active subscription.":"",r=this.$mdDialog.confirm().title("WARNING - User Removal").htmlContent("Are you sure you want to remove this user from your organization? "+o).ok("Yes, remove user").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(r).then((function(){n.OrganizationService.removeUserFromOrganization(+n.$state.params.organizationId,e).then((function(){n.ToastService.showInfo("User Removed"),n.loadUsers()})).catch((function(e){n.showValidationErrors(e)}))}))},t.prototype.grantProAccess=function(e){var t=this,i=this.$mdDialog.confirm().title("WARNING - Grant Pro Access").htmlContent("Are you sure you want to grant a year of pro access to this user?").ok("Yes, grant access").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.OrganizationService.grantProAccess({organizationId:+t.$state.params.organizationId,userId:e}).then((function(){t.ToastService.showInfo("Pro access granted"),t.loadUsers()}))}))},t.prototype.showValidationErrors=function(e){if(422===e.status){var t=e.data.errors;for(var i in t)if(t.hasOwnProperty(i))for(var n=0,o=t[i];n<o.length;n++){var r=o[n];this.ToastService.showError(r)}}},t=__decorate([e.Component("QdbdApp.Organization","dtOrganizationUserList",{bindings:{filter:"="},templateUrl:"cache/modules/organization/dt-organization-user-list/dt-organization-user-list.html",controllerAs:"DtOrganizationUserListVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){this.$scope=e,this.$transitions=t,this.$state=i,this.$timeout=n,this.initializeFilters(),this.setupRoutes(),this.handleRouting()}t.$inject=["$scope","$transitions","$state","$timeout"],t.prototype.setupRoutes=function(){var e=this;this.$transitions.onSuccess({to:"root.standard.organization.**"},(function(t){e.handleCurrentRoute()})),this.routes=[{caption:"Users",name:"root.standard.organization.userList"},{caption:"Diagrams",name:"root.standard.organization.diagrams"}],this.handleCurrentRoute()},t.prototype.handleCurrentRoute=function(){var e=this;this.$timeout((function(){e.selectedTab=_.findIndex(e.routes,{name:e.$state.current.name})}))},t.prototype.handleRouting=function(){this.$state.is("root.standard.organization")&&this.$state.go("root.standard.organization.userList")},t.prototype.initializeFilters=function(){var e={page:this.$state.params.page||1,pageSize:this.$state.params.pageSize||20,search:this.$state.params.search,sortBy:this.$state.params.sortBy,sortOrder:this.$state.params.sortOrder},t=e.sortBy;t&&t.endsWith("email")&&(t="email"),this.usersFilter={page:e.page,pageSize:e.pageSize,search:e.search,sortBy:t||"email",sortOrder:e.sortOrder}},t.prototype.getParams=function(e){if("root.standard.organization.userList"===e)return this.usersFilter},t.prototype.loadRoute=function(e){var t=this.getParams(e);this.$state.go(e,t)},t=__decorate([e.Controller("QdbdApp.Organization","OrgAdminCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.$http=e}return t.$inject=["$http"],t.prototype.filterOrganizations=function(e){return this.$http.get("api/v1/organizations/filter",{params:e})},t.prototype.filterProGrantLogs=function(e){return this.$http.get("api/v1/organizations/proGrantLogs/filter",{params:e})},t.prototype.inviteUserToOrganization=function(e){return this.$http.post("api/v1/organizations/users/invite",e)},t.prototype.grantProAccess=function(e){return this.$http.post("api/v1/organizations/users/grantProAccess",e)},t.prototype.removeUserFromOrganization=function(e,t){return this.$http.delete("api/v1/organizations/"+e+"/users/"+t+"/remove")},t.prototype.acceptOrganizationInvite=function(e){return this.$http.post("api/v1/organizations/"+e+"/acceptInvite",null)},t.prototype.makeOrganizationAdmin=function(e,t){return this.$http.post("api/v1/organizations/"+e+"/users/"+t+"/makeAdmin",null)},t.prototype.removeOrganizationAdmin=function(e,t){return this.$http.delete("api/v1/organizations/"+e+"/users/"+t+"/removeAdmin",null)},t.prototype.filterOrganizationUsers=function(e){return this.$http.get("api/v1/organizations/users/filter",{params:e})},t.prototype.createOrganizationDiagram=function(e){return this.$http.post("api/v1/organizations/diagrams",e)},t.prototype.renameOrganizationDiagram=function(e){return this.$http.put("api/v1/organizations/diagrams/rename",e)},t.prototype.getOrganizationDiagram=function(e,t){return this.$http.get("api/v1/organizations/"+e+"/diagrams/"+t)},t.prototype.deleteOrganizationDiagram=function(e,t){return this.$http.delete("api/v1/organizations/"+e+"/diagrams/"+t)},t.prototype.grantAccessToOrganizationDiagram=function(e,t){return this.$http.post("api/v1/organizations/diagrams/"+e+"/grantAccessToUser/"+t,null)},t.prototype.moveOrganizationDiagramToFolder=function(e,t){return this.$http.post("api/v1/organizations/diagrams/"+e+"/moveToFolder/"+t,null)},t.prototype.removeAccessFromOrganizationDiagram=function(e,t){return this.$http.delete("api/v1/organizations/diagrams/"+e+"/removeAccessFromUser/"+t)},t.prototype.filterOrganizationUsersForDiagram=function(e){return this.$http.get("api/v1/organizations/diagrams/users/filter",{params:e})},t.prototype.createOrganizationFolder=function(e){return this.$http.post("api/v1/organizations/folders",e)},t.prototype.renameOrganizationFolder=function(e){return this.$http.put("api/v1/organizations/folders/rename",e)},t.prototype.getOrganizationFolder=function(e,t){return this.$http.get("api/v1/organizations/"+e+"/folders/"+t)},t.prototype.deleteOrganizationFolder=function(e,t){return this.$http.delete("api/v1/organizations/"+e+"/folders/"+t)},t.prototype.grantAccessToOrganizationFolder=function(e,t){return this.$http.post("api/v1/organizations/folders/"+e+"/grantAccessToUser/"+t,null)},t.prototype.removeAccessFromOrganizationFolder=function(e,t){return this.$http.delete("api/v1/organizations/folders/"+e+"/removeAccessFromUser/"+t)},t.prototype.getOrganizationFlatFolderTree=function(e){return this.$http.get("api/v1/organizations/"+e+"/flatFolderTree")},t.prototype.filterOrganizationUsersForFolder=function(e){return this.$http.get("api/v1/organizations/folders/users/filter",{params:e})},t=__decorate([e.Service("QdbdApp.Organization","OrganizationService")],t)}();e.OrganizationService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t){this.AccountService=e,this.MessageScreenService=t,this.changeEmailModel={}}t.$inject=["AccountService","MessageScreenService"],t.prototype.changeEmail=function(){var e=this;this.AccountService.changeEmail(this.changeEmailModel).then((function(){e.MessageScreenService.showSuccess({header:"Please confirm your new e-mail",message:"A confirmation e-mail was sent to your new email, after you confirm it your e-mail will be updated."})}))},t=__decorate([e.Controller("QdbdApp.Register","ChangeEmailCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t){this.AccountService=e,this.MessageScreenService=t,this.changePasswordModel={}}t.$inject=["AccountService","MessageScreenService"],t.prototype.changePassword=function(){var e=this;this.AccountService.changePassword(this.changePasswordModel).then((function(){e.MessageScreenService.showSuccess({header:"Password changed",message:"Your password has been successfully changed"})}))},t=__decorate([e.Controller("QdbdApp.Register","ChangePasswordCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i){this.$state=e,this.ToastService=t,this.AccountService=i,this.confirmEmail()}t.$inject=["$state","ToastService","AccountService"],t.prototype.confirmEmail=function(){var e=this;this.AccountService.confirmChangeEmail(this.$state.params.userId,this.$state.params.email,this.$state.params.token).then((function(){e.ToastService.showInfo("Email confirmed, you may log in now."),e.$state.go("root.standardShrinkable.home")}))},t=__decorate([e.Controller("QdbdApp.Register","ConfirmChangeEmailCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i){this.$state=e,this.ToastService=t,this.AccountService=i,this.confirmEmail()}t.$inject=["$state","ToastService","AccountService"],t.prototype.confirmEmail=function(){var e=this;this.AccountService.confirmEmail(this.$state.params.userId,this.$state.params.token).then((function(){e.ToastService.showInfo("Email confirmed, you may log in now."),e.$state.go("root.standardShrinkable.home")}))},t=__decorate([e.Controller("QdbdApp.Register","ConfirmEmailCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t){this.AccountService=e,this.MessageScreenService=t,this.forgotPasswordModel={}}t.$inject=["AccountService","MessageScreenService"],t.prototype.forgotPassword=function(){var e=this;this.AccountService.forgotPassword(this.forgotPasswordModel).then((function(){e.MessageScreenService.showSuccess({header:"Email sent",message:"An email with password reset details has been sent to your email address"})}))},t=__decorate([e.Controller("QdbdApp.Register","ForgotPasswordCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i){this.$scope=e,this.ToastService=t,this.AccountService=i,this.credentials={}}t.$inject=["$scope","ToastService","AccountService"],t.prototype.register=function(){this.AccountService.registerAccount(this.credentials)},t.prototype.authenticate=function(e){this.AccountService.socialAuth(e)},t=__decorate([e.Controller("QdbdApp.Register","RegisterCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i){this.$state=e,this.ToastService=t,this.AccountService=i,this.resetPasswordModel={}}t.$inject=["$state","ToastService","AccountService"],t.prototype.resetPassword=function(){var e=this;this.AccountService.validatePassword(this.resetPasswordModel.password).isValid&&(this.resetPasswordModel.userId=this.$state.params.userId,this.resetPasswordModel.token=this.$state.params.token,this.AccountService.resetPassword(this.resetPasswordModel).then((function(){e.ToastService.showInfo("You are now logged in."),e.$state.go("root.standardShrinkable.home")})))},t=__decorate([e.Controller("QdbdApp.Register","ResetPasswordCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r,a,s,d,c,l){this.$rootScope=e,this.$scope=t,this.$state=i,this.$timeout=n,this.$transitions=o,this.AccountService=r,this.RoutingService=a,this.SourceEditorService=s,this.DiagramFolderService=d,this.ToastService=c,this.TrackingService=l,this.registerEventListeners(),this.loadInitialPageTitle(),this.$rootScope.stateIncludes=this.RoutingService.stateIncludes.bind(this)}t.$inject=["$rootScope","$scope","$state","$timeout","$transitions","AccountService","RoutingService","SourceEditorService","DiagramFolderService","ToastService","TrackingService"],t.prototype.loadInitialPageTitle=function(){var e=this;this.$timeout((function(){e.setPageTitle(e.$state.current)}))},t.prototype.registerEventListeners=function(){var e=this;this.$scope.$on("error-message",(function(t,i){e.ToastService.showError(JSON.stringify(i))})),this.$rootScope.$on("toast-error",(function(t,i){e.ToastService.showError(i)})),this.$scope.$on("unauthorized-request",(function(t,i){e.AccountService.onUnauthorizedRequest(t,i)})),this.$rootScope.$on("current-user-changed",(function(){e.RoutingService.handleAuthRedirects(),e.TrackingService.profitWellTrack(),e.DiagramFolderService.folderTreeState.showSharedDiagrams=!1})),this.$transitions.onSuccess({},(function(t){t.from();var i=t.to();e.setPageTitle(i),e.RoutingService.handleAuthRedirects(),e.TrackingService.onRouteChange()}))},t.prototype.setPageTitle=function(e){e.data&&e.data.title?e.data.usesCustomPageTitleHandler||(this.$rootScope.pageTitle=e.data.title+" - QuickDBD"):this.$rootScope.pageTitle="QuickDBD"},t=__decorate([e.Controller("QdbdApp.Common","RootCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i){this.$scope=e,this.SchemaService=t,this.PagingService=i,this.diagrams={}}t.$inject=["$scope","SchemaService","PagingService"],t.prototype.$onInit=function(){this.pager=this.PagingService.pagerFactory(this.filter,this.diagrams,this.loadDiagrams.bind(this),"root.standard.admin.diagramList"),this.$scope.$watch("DtSchemaListVM.filter",this.pager.onFilterChanged.bind(this),!0)},t.prototype.loadDiagrams=function(){var e=this;this.SchemaService.filterDiagrams(this.filter).then((function(t){_.extend(e.diagrams,t.data)}))},t=__decorate([e.Component("QdbdApp.Schema","dtSchemaList",{bindings:{filter:"="},templateUrl:"cache/modules/schema/dt-schema-list/dt-schema-list.html",controllerAs:"DtSchemaListVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o){this.$http=e,this.FileSaver=t,this.ToastService=i,this.StreamDownloadService=n,this.TrackingService=o}return t.$inject=["$http","FileSaver","ToastService","StreamDownloadService","TrackingService"],t.prototype.exportToSQL=function(e,t,i,n,o){var r=this;if(this.TrackingService.trackExportToSql(i),0===Object.keys(t.errors).length){var a=this.createExportFileName(o);this.$http.post("api/v1/schemaExport/toSql",{shortcode:e,quickDbdSchema:this.convertSchemaToExportModel(t),exportType:i,schemaUrl:n,schemaName:o,fileName:a}).then((function(e){var t=new Blob([e.data],{type:"text/plain;charset=utf-8"});r.FileSaver.saveAs(t,a+".sql")})).catch((function(e){var t,i,n;if(422===(null==e?void 0:e.status)){var o=null===(n=null===(i=null===(t=e.data)||void 0===t?void 0:t.errors)||void 0===i?void 0:i[""])||void 0===n?void 0:n[0];o&&r.ToastService.showError(o)}}))}else this.ToastService.showError("Schema contains errors and cannot be exported.")},t.prototype.exportToDoc=function(e,t,i,n,o){if(this.TrackingService.trackExportToDoc(i),0===Object.keys(t.errors).length){var r=this.createExportFileName(o);this.StreamDownloadService.downloadPost("api/v1/schemaExport/toDoc",{shortcode:e,quickDbdSchema:this.convertSchemaToExportModel(t),exportType:i,schemaUrl:n,schemaName:o,fileName:r})}else this.ToastService.showError("Schema contains errors and cannot be exported.")},t.prototype.createExportFileName=function(e){return e?"QuickDBD-"+e:"QuickDBD-export"},t.prototype.convertSchemaToExportModel=function(e){var t=this,i={comments:e.sections.comments,tables:_.values(angular.copy(e.sections.tables)),relationships:_.values(angular.copy(e.sections.relationships))};return _.each(i.tables,this.convertTableAndFieldNames.bind(this)),_.each(i.relationships,(function(i){t.convertRelTableFieldNames(e,i)})),i},t.prototype.convertTableAndFieldNames=function(e){e.identifier=e.caption,delete e.caption,e.fields=_.values(_.filter(e.fields,(function(e){return"qdbdvirtualfield"!==e.identifier}))),_.each(e.fields,(function(e){e.identifier=e.caption,delete e.caption}))},t.prototype.convertRelTableFieldNames=function(e,t){this.convertRelTableFieldName(e,t.table1),this.convertRelTableFieldName(e,t.table2)},t.prototype.convertRelTableFieldName=function(e,t){var i=_.find(e.sections.tables,(function(e){return e.identifier.toLowerCase()===t.tableIdentifier.toLowerCase()})),n=_.find(i.fields,(function(e){return e.identifier.toLowerCase()===t.fieldIdentifier.toLowerCase()}));t.fieldIdentifier=n.caption},t=__decorate([e.Service("QdbdApp.Schema","SchemaExportService")],t)}();e.SchemaExportService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r,a,s){this.$q=e,this.$rootScope=t,this.$http=i,this.$timeout=n,this.AccountService=o,this.ToastService=r,this.DialogService=a,this.AppConfig=s,this.isDisconnectHandlerInitialized=!1,this.initializeFirebase()}return t.$inject=["$q","$rootScope","$http","$timeout","AccountService","ToastService","DialogService","AppConfig"],t.prototype.initializeFirebase=function(){firebase.initializeApp(this.AppConfig.firebase)},t.prototype.signIn=function(){return this.AccountService.isUserLoggedIn()?this.signInWithCredentials():this.$q.resolve()},t.prototype.signInAnonymously=function(){var e=this,t=firebase.auth().signInAnonymously();return t.catch((function(t){return e.onFirebaseSignInError(t)})),t},t.prototype.signInWithCredentials=function(){var e=this;return this.getFirebaseSignOn().then((function(t){var i=t.data.user,n=t.data.token,o=firebase.auth().signInWithEmailAndPassword(i,n);return o.catch((function(t){return e.onFirebaseSignInError(t)})),o}))},t.prototype.onFirebaseSignInError=function(e){if(e&&e.message){var t=e.message;try{_.isString(t)&&(t=JSON.parse(t)),t.error&&"Requests from referer https://www.googleapis.com/ are blocked."===t.error.message&&this.DialogService.showDialogNotification("Access to Google Firebase is blocked - either by a firewall or an ad-blocker. It's required for the app to work. Please ensure Firebase is not blocked and then refresh the browser.")}catch(e){console.log(e),_.isString(t)&&this.DialogService.showDialogNotification(t)}}},t.prototype.getCurrentUser=function(){return firebase.auth().currentUser},t.prototype.getCurrentUserUid=function(){var e=this.getCurrentUser();return e?e.uid:null},t.prototype.currentUserExists=function(){return!!this.getCurrentUser()},t.prototype.getFirebaseSignOn=function(){return this.$http.get("api/v1/account/firebaseSignOn")},t.prototype.disposeRefs=function(e){e&&(this.disposeFirepad(e.firepad),e.sharedMetadata&&e.sharedMetadata.off("value"),e.layout&&e.layout.off("value"),e.viewport&&e.viewport.off("value"))},t.prototype.disposeFirepad=function(e){e&&!e.zombie_&&e.dispose()},t.prototype.editorFactory=function(e,t,i){var n=this.getDiagramReference(t),o=Firepad.fromACE(n,e,{defaultText:i});return this.registerDiagramUnreadableHandler(n,o),this.registerDiagramUnwritableHandler(n),this.registerOnDisconnectHandler(),o},t.prototype.registerDiagramUnreadableHandler=function(e,t){var i=this;e.on("value",(function(){}),(function(e){t&&!t.zombie_&&(e&&"PERMISSION_DENIED"===e.code?(i.ToastService.showError("Diagram does not exist."),t.firebaseAdapter_.ready_&&t.setText(""),i.disposeFirepad(t)):e&&i.ToastService.showError(e.message))}))},t.prototype.registerDiagramUnwritableHandler=function(e){var t=this;e.child("writeCheck").set(firebase.database.ServerValue.TIMESTAMP,(function(e){e&&"PERMISSION_DENIED"===e.code?t.$rootScope.$broadcast("diagram-writable-changed",!1):e&&t.ToastService.showError(e.message)}))},t.prototype.headlessFactory=function(e){var t=this.getDiagramReference(e);return new Firepad.Headless(t)},t.prototype.registerOnDisconnectHandler=function(){var e=this;this.isDisconnectHandlerInitialized||this.getConnectionReference().on("value",(function(t){t.val()?(e.isDisconnectHandlerInitialized&&e.DialogService.closDialogNotification(),e.isDisconnectHandlerInitialized=!0):e.isDisconnectHandlerInitialized&&e.DialogService.showDialogNotification("Uh-oh. We can't connect to our server. Please check your internet connection.")}))},t.prototype.getRootReference=function(){return firebase.database().ref()},t.prototype.getConnectionReference=function(){return firebase.database().ref(".info/connected")},t.prototype.getChildReference=function(e,t,i){var n=e+"/"+t;return i&&(n=n+"/"+i),this.getRootReference().child(n)},t.prototype.getUserChildReference=function(e,t,i){return this.getRootReference().child(e+"/"+t+"/"+i)},t.prototype.getDiagramReference=function(e){return this.getChildReference("diagram",e)},t.prototype.getDiagramLayoutTableReference=function(e,t){return this.getChildReference("diagramLayout",e,t)},t.prototype.setData=function(e,t,i,n,o){return this.dbSave(e,t,i,"set",n,o)},t.prototype.updateData=function(e,t,i,n,o){return this.dbSave(e,t,i,"update",n,o)},t.prototype.dbSave=function(e,t,i,n,o,r){if(!t||!i||!this.currentUserExists())return this.$q.resolve();var a=this.$q.defer();return(o?this.getUserChildReference(e,this.getCurrentUserUid(),t):this.getChildReference(e,t,r))[n](this.clearUndefinedProperties(i),(function(e){e?a.reject():a.resolve()})),a.promise},t.prototype.setDiagramSchema=function(e,t){if(!e||!t||!this.currentUserExists())return this.$q.resolve();var i=this.headlessFactory(e),n=this.$q.defer();return i.setText(t,(function(e,t){i.dispose(),e||!t?n.reject():n.resolve()})),n.promise},t.prototype.setDiagramSharedMetadata=function(e,t){return this.setData("diagramSharedMetadata",e,t)},t.prototype.setDiagramLayout=function(e,t){return this.setData("diagramLayout",e,t)},t.prototype.setDiagramLayoutTable=function(e,t,i){return this.setData("diagramLayout",e,i,null,t)},t.prototype.setDiagramViewport=function(e,t){return this.setData("diagramViewport",e,t,this.getCurrentUserUid())},t.prototype.removeDiagramLayoutTables=function(e,t){return e&&t&&0!==t.length?this.getChildReference("diagramLayout",e).transaction((function(e){return _.each(t,(function(t){e[t]=null})),e})):this.$q.resolve()},t.prototype.setDiagram=function(e){return e?this.setDiagramSchema(e.shortcode,e.schema):this.$q.resolve()},t.prototype.saveDiagram=function(e){var t=[this.setDiagram(e),this.setDiagramSharedMetadata(e.shortcode,e.sharedMetadata),this.setDiagramLayout(e.shortcode,e.layout),this.setDiagramViewport(e.shortcode,e.viewport)];return this.$q.all(t)},t.prototype.saveDiagramMetadata=function(e){var t=[this.setDiagramSharedMetadata(e.shortcode,e.sharedMetadata),this.setDiagramLayout(e.shortcode,e.layout),this.setDiagramViewport(e.shortcode,e.viewport)];return this.$q.all(t)},t.prototype.saveDiagrams=function(e){var t=this;if(!e||0===e.length)return this.$q.resolve();var i=[];return _.each(e,(function(e){i.push(t.saveDiagram(e))})),this.$q.all(i)},t.prototype.renameDiagram=function(e){return this.updateData("diagramSharedMetadata",e.shortcode,{name:e.name})},t.prototype.registerOnValueChangedHandler=function(e,t,i,n){var o=this,r=n?this.getUserChildReference(e,n,t):this.getChildReference(e,t);return r.on("value",(function(e){o.$timeout((function(){i(null,e.val())}))}),(function(e){o.$timeout((function(){i(e)}))})),r},t.prototype.registerSharedMetadataListener=function(e,t){return this.registerOnValueChangedHandler("diagramSharedMetadata",e,t)},t.prototype.registerLayoutListener=function(e,t){return this.registerOnValueChangedHandler("diagramLayout",e,t)},t.prototype.registerViewportListener=function(e,t){return this.registerOnValueChangedHandler("diagramViewport",e,t,this.getCurrentUserUid())},t.prototype.clearUndefinedProperties=function(e){var t=this;return Object.keys(e).forEach((function(i){e[i]&&"object"==typeof e[i]?t.clearUndefinedProperties(e[i]):void 0===e[i]&&delete e[i]})),e},t=__decorate([e.Service("QdbdApp.Schema","SchemaFirebaseService")],t)}();e.SchemaFirebaseService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o){this.$http=e,this.$q=t,this.$mdDialog=i,this.MessageScreenService=n,this.TrackingService=o}return t.$inject=["$http","$q","$mdDialog","MessageScreenService","TrackingService"],t.prototype.importFromSQL=function(e,t){var i=this,n=this.$mdDialog.confirm().title("Import From SQL").htmlContent("<p>WARNING: This is an irreversible action. Your current diagram will</br>be replaced with the imported diagram. Would you like to proceed?</p>").ok("Yes").cancel("No").clickOutsideToClose(!0);return this.$mdDialog.show(n).then((function(){return i.TrackingService.trackImportFromSql(t),i.$http.post("api/v1/schemaImport/fromSql",{sql:e,importType:t,parsedSql:""}).then((function(e){return i.onImportFromSql(t,e.data)}))}))},t.prototype.onImportFromSql=function(e,t){var i=t.errors,n="<p><strong>Important: You may lose information when importing your database schema because QuickDBD does not support all databases features. For example, QuickDBD will not import compound indexes, enums or triggers. <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Therefore, DO NOT attempt to use QuickDBD for round-trip engineering.</strong></p> ";if(t.parsedSql)return i.length||this.MessageScreenService.showSuccess({header:"File successfully imported",message:"Your file has been successfully imported "+n}),this.$q.resolve(t.parsedSql);if(i&&i.length||this.showUnhandledErrorsMessage(e,n),i&&i.length){var o=_.map(i,(function(e){return o+" Line/Column: "+e.line+"/"+e.column+" - "+e.message+"<br />"})).join("");this.MessageScreenService.showError({header:"The parser got the following errors",message:o+" "+n})}return this.$q.reject()},t.prototype.showUnhandledErrorsMessage=function(e,t){var i="";switch(e){case"mySql":i="a MySQL/MariaDB";break;case"oracle":i="an Oracle";break;case"tSql":default:i="a SQL Server";break;case"postgresql":i="a PostgreSQL";break;case"ansiSql":i="an ANSI SQL"}var n="Sorry, QuickDBD could not understand your schema file. We have logged this and will investigate it. Please run it against "+i+" database and check it is valid.";this.MessageScreenService.showError({header:"Import unhandled error",message:n})},t=__decorate([e.Service("QdbdApp.Schema","SchemaImportService")],t)}();e.SchemaImportService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r,a,s){this.$rootScope=e,this.$http=t,this.$location=i,this.$q=n,this.localStorageService=o,this.SchemaFirebaseService=r,this.SourceEditorService=a,this.AccountService=s,this.SCHEMA_KEY="schema",this.RUN_DIAGNOSTICS=!0,this.removeLegacySchemaFromLocalStorage()}return t.$inject=["$rootScope","$http","$location","$q","localStorageService","SchemaFirebaseService","SourceEditorService","AccountService"],t.prototype.removeLegacySchemaFromLocalStorage=function(){this.localStorageService.remove(this.SCHEMA_KEY)},t.prototype.migrateToFirebase=function(){var e=this;return this.isMigrationToFirebaseRequired()?this.AccountService.reAuthenticate().then((function(){return e.backupLocalDiagrams()})).then((function(){return e.migrateOwnServerSchemas()})).then((function(t){return e.migrateOwnLocalUnsavedSchemas(t)})).then((function(){e.removeLocalSchemas(),e.SourceEditorService.clearLocalShortcode()})):this.backupAndRemoveLocalSchemas()},t.prototype.isMigrationToFirebaseRequired=function(){return!!this.AccountService.isUserLoggedIn()&&!this.$rootScope.currentUser.firebaseUserId},t.prototype.schemaToDiagramModels=function(e){return e&&0!==e.length?_.map(e,(function(e){var t=e.schemaSource||"",i={shortcode:e.shortcode,legacyShortcode:e.legacyShortcode,schema:t.split("\r\n").join("\n"),sharedMetadata:{name:e.name,parentId:e.parentId,parentName:e.parentName,tableCount:e.tableCount}};if(e.settings){var n=e.settings,o=i.sharedMetadata;o.isCaseSensitive=n.isCaseSensitive,o.defaultType=n.defaultType,i.viewport={zoom:n.zoom||100},n.position&&(i.viewport.position=angular.copy(n.position))}return e.layout&&(i.layout=angular.copy(e.layout)),i})):[]},t.prototype.backupLocalDiagrams=function(){var e=this.getLocalSchemas();if(!(e=_.filter(e,(function(e){return e.schemaSource||e.shortcode||e.name})))||0===e.length)return this.$q.resolve();if(this.RUN_DIAGNOSTICS){var t=_.filter(e,{userId:this.$rootScope.currentUser.userId}),i=_.filter(t,{isDirty:!0}),n=_.filter(t,{isDirty:!1}),o=_.filter(e,{userId:0});console.log("User's diagrams to backup: "+t.length+" ("+i.length+" dirty, "+n.length+" non-dirty)"),console.log("Anonymous diagrams to backup: "+o.length),console.log("Previous users diagrams to backup: "+(e.length-t.length-o.length))}return this.$http.post("api/v1/diagrams/backup",e)},t.prototype.migrateOwnServerSchemas=function(){var e=this;return this.$http.get("api/v1/diagrams/toMigrate").then((function(t){var i=e.schemaToDiagramModels(t.data);return e.RUN_DIAGNOSTICS&&console.log("Server diagrams to migrate: "+i.length),e.SchemaFirebaseService.saveDiagrams(i).then((function(){return i}))}))},t.prototype.migrateOwnLocalUnsavedSchemas=function(e){var t=this.getOwnUnsavedLocalSchemas(),i=this.schemaToDiagramModels(t);return this.updateWithServerShotcodes(i,e),this.RUN_DIAGNOSTICS&&(console.log("Local diagrams to migrate: "+i.length),console.log("Local diagram shortcodes:",_.sortBy(_.map(t||[],"shortcode"))),console.log("Server diagram shortcodes:",_.sortBy(_.map(e||[],"shortcode")))),this.SchemaFirebaseService.saveDiagrams(i)},t.prototype.updateWithServerShotcodes=function(e,t){_.each(e,(function(e){var i=_.find(t,{legacyShortcode:e.shortcode});e.shortcode=i.shortcode}))},t.prototype.backupAndRemoveLocalSchemas=function(){var e=this;return this.AccountService.isUserLoggedIn()?this.backupLocalDiagrams().then((function(){e.removeLocalSchemas()})):this.$q.resolve()},t.prototype.removeLocalSchemas=function(){var e=this,t=this.localStorageService.keys(),i=_.filter(t,(function(t){return _.startsWith(t,""+e.SCHEMA_KEY)}));_.each(i,(function(t){e.localStorageService.remove(t)}))},t.prototype.getLocalSchemasKeys=function(){var e=this,t=this.localStorageService.keys();return _.filter(t,(function(t){return _.startsWith(t,e.SCHEMA_KEY+".")}))},t.prototype.getLocalSchemas=function(){var e=this,t=this.getLocalSchemasKeys();return _.map(t,(function(t){return e.localStorageService.get(t)}))||[]},t.prototype.getUnsavedLocalSchemas=function(){var e=this.getLocalSchemas();return _.filter(e,(function(e){return e.shortcode&&(e.isDirty||e.isLocalOnly)}))},t.prototype.getOwnUnsavedLocalSchemas=function(){var e=this,t=this.getUnsavedLocalSchemas();return _.filter(t,(function(t){return t.userId===e.$rootScope.currentUser.userId}))},t=__decorate([e.Service("QdbdApp.Schema","SchemaMigrationService")],t)}();e.SchemaMigrationService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n){this.$rootScope=e,this.QdbdParserConfig=t,this.AccountService=i,this.TrackingService=n,this.allowedRelTypes=_.map(this.QdbdParserConfig.allowedRelTypes,"symbol")}return t.$inject=["$rootScope","QdbdParserConfig","AccountService","TrackingService"],t.prototype.isValidLine=function(e){return!!this.errors[e.toString()]},t.prototype.getSchemaLine=function(e,t){return this.splitDataByNewLine(t)[e-1]},t.prototype.parseSource=function(e,t,i){this.settings=t,this.security=i,this.initializeFields();var n=this.tokenizeData(e);this.parseSettings(n.settings),this.parseTables(n.tables),this.parseRelationships(),this.parseLayout(n.layout);var o={sections:this.sections,errors:this.errors};return t&&(t.tableCount=_.size(this.sections.tables)||0),i&&(i.isTableLimitReached=this.isTableLimitReached()),o},t.prototype.getDefaultQdbdSchema=function(){return this.parseSource("")},t.prototype.getToken=function(e,t,i){var n=this.getSection(e,t);if(n){var o=this.splitDataByNewLine(n);return _.find(o,(function(e){return _.startsWith(_.trim(e),i)}))}},t.prototype.getSection=function(e,t){var i=e.split("["+t+"]");if(1!==i.length)return _.first(i.pop().split("["))},t.prototype.initializeFields=function(){this.sections={settings:{},tables:{},relationships:[],layout:{},comments:[]},this.relParsingQueue=[],this.errors={},this.isLimitReached=!1},t.prototype.tokenizeData=function(e){var t=this,i=this.splitDataByNewLine(e),n=[],o="tables",r=[],a=!1,s={settings:[],tables:[],relationships:[],layout:[]};return _.each(i,(function(e,i){var d=!_.trimRight(e),c=t.getLineData(e);if(c.comment?n.push(c.comment):d&&(a||(t.sections.comments.push.apply(t.sections.comments,n),n=[])),c.data.match(/\t/g)){t.addError((i+1).toString(),"Whitespace expected, tab character found (To untabify the whole document use: Menu -> Edit -> Untabify)")}if(c.data&&(a=!0),!(d&&"tables"!==o||!d&&!c.data)){var l={line:(i+1).toString(),value:c.data,comments:a&&c.data?n:[]};a&&c.data&&(n=[]);var u=_.startsWith(c.data,"[")&&_.endsWith(c.data,"]");if(u){var h=_.trimLeft(_.trimRight(c.data,"]"),"[").toLowerCase();if(h=t.replaceSectionAliases(h),!t.validateSection(h,r,l.line))return;r.push(h),o=h}u||s[o].push(l)}})),s},t.prototype.replaceSectionAliases=function(e){return this.QdbdParserConfig.aliasSchemaSections[e]?this.QdbdParserConfig.aliasSchemaSections[e]:e},t.prototype.validateSection=function(e,t,i){var n=this.QdbdParserConfig.schemaSections;if(!_.includes(n,e))return this.addError(i,"Invalid section name '["+e+"]' (allowed: "+n.join(", ")+")"),!1;if(_.includes(t,e))return this.addError(i,"Section '["+e+"]' is already defined"),!1;var o=_.takeWhile(n,(function(t){return t!==e})),r=_.difference(t,o);return!(r.length>0)||(this.addError(i,"Section '["+e+"]' is out of order. It must be defined before: '["+r.join(", ")+"]'"),!1)},t.prototype.parseSettings=function(e){var t=this;_.each(e,(function(e){var i=t.splitTokenByFirstDelimiter(e.value," "),n=_.trim(i[0]),o=n.toLowerCase(),r=_.trim(i[1]);o?_.includes(o," ")?t.addError(e.line,"Setting key cannot contain whitespace"):r?t.sections.settings[o]?t.addError(e.line,"Setting '"+n+"' already defined"):("casesensitive"!==o&&"casesensitivity"!==o||(o="casesensitive",r=t.parseCaseSensitiveSettingValue(r,e.line)),"position"===o&&(r=t.parsePositionSettingValue(r,e.line)),"zoom"===o&&(r=t.parseZoomSettingValue(r,e.line)),t.sections.settings[o]=r):t.addError(e.line,"Setting value missing"):t.addError(e.line,"Setting key missing")})),this.resolveDefaultSettings()},t.prototype.getSettingTokenValue=function(e){return _.trim(this.splitTokenByFirstWhitespace(e).pop())},t.prototype.parseCaseSensitiveSettingValue=function(e,t){var i;return"off"===e.toLowerCase()?i=!1:"on"===e.toLowerCase()?i=!0:t&&this.addError(t,"Invalid 'CaseSensitive' value (allowed: 'on', 'off')"),i},t.prototype.parsePositionSettingValue=function(e,t){var i=this.splitTokenByFirstWhitespace(e);if(t&&2!==i.length)this.addError(t,"Position setting requires 2 values (x, y)");else{var n=_.trim(i[0]);if(!t||this.isNumeric(n)){var o=parseInt(n),r=_.trim(i[1]);if(!t||this.isNumeric(r))return{x:o,y:parseInt(r)};this.addError(t,"Invalid Y coordinate '"+(r||void 0)+"', number expected")}else this.addError(t,"Invalid X coordinate '"+(n||void 0)+"', number expected")}},t.prototype.parseZoomSettingValue=function(e,t){var i=parseFloat(e);return t&&(!this.isNumeric(i)||i<10||i>200)&&this.addError(t,"Invalid 'Zoom' value (allowed: number between 10 and 200)"),i},t.prototype.resolveDefaultSettings=function(){_.isBoolean(this.sections.settings.casesensitive)||(this.sections.settings.casesensitive=!1),this.sections.settings.position||(this.sections.settings.position={x:0,y:0}),this.isNumeric(this.sections.settings.zoom)||(this.sections.settings.zoom=100)},t.prototype.parseTables=function(e){var t=this.splitAndGroupTokensByWhitespace(e);_.each(t,this.parseTable.bind(this))},t.prototype.parseTable=function(e){var t,i=this,n=!1;_.each(e,(function(e,o){if(i.isTableFieldsSeparator(e.value))return 0===o&&i.addError(e.line,"Table name not defined"),void(n=!0);if(0!==o){if(t)if(n){var r=i.parseTableField(t,e);i.setSectionTableField(t,r,e.line)}else i.parseTableMetadata(t,e)}else t=i.parseTableName(e)}))},t.prototype.parseTableName=function(e){var t=this,i=this.parseTableNamesAndAliases(e);if(i){if(!this.sections.tables[i.tableIdentifier]){if(this.sections.tables[i.tableIdentifier]={identifier:i.tableIdentifier,caption:i.tableCaption,fields:{},aliases:i.tableAliases,line:e.line,comments:e.comments},this.isTableLimitReached()){var n="Table "+_.size(this.sections.tables);this.sections.tables[i.tableIdentifier].caption=n,this.TrackingService.trackEditor(_.size(this.sections.tables),"TableLimitReached","table_limit_reached")}return this.sections.aliases=this.sections.aliases||{},_.each(i.tableAliases,(function(e,n){t.sections.aliases[e]=i.tableIdentifier})),i.tableIdentifier}this.addError(e.line,"Table '"+i.tableCaption+"' already defined")}},t.prototype.parseTableNamesAndAliases=function(e){var t=e.value.split(" as "),i=[],n=t[0];if(_.contains(n,'"')||!_.contains(n," ")&&!_.contains(n,".")){t.length>1&&(i=t[1].replace(/ /g,"").split(","));var o=this.unquoteText(n);return{tableIdentifier:this.decimalEncodeText(o),tableCaption:o,tableAliases:i}}this.addError(e.line,"Invalid table name (use double quotes)")},t.prototype.parseTableMetadata=function(e,t){_.startsWith(t.value,"rel")?this.parseTableMetadataRelationship(e,t):this.addError(t.line,"Unrecognized table metadata '"+t.value+"'")},t.prototype.parseTableMetadataRelationship=function(e,t){var i=this.splitByWhitespaceAndRemoveEmptyStrings(t.value);i.length>3?this.addError(t.line,"Unknown relationship param '"+i[3]+"'"):this.queueRelationshipParsing({relMember1:e,relationType:3===i.length?i[1]:"-",relMember2:3===i.length?i[2]:i[1],line:t.line})},t.prototype.parseTableField=function(e,t){var i=this.tokenizeFieldLine(t.value);if(0!==i.length){var n=_.trim(i[0].value),o=this.decimalEncodeText(n),r=this.isTableLimitReached();if(o){if(this.isTableVirtualField(o))return{identifier:"qdbdvirtualfield"};for(var a={identifier:o,caption:r?"...":n,line:t.line,comments:t.comments},s=-1,d=1;d<i.length;d++){var c=i[d],l=_.trim(c.value);if(s>-1)if(d===s+1){if(this.isRelationshipTypeToken(c.value)){d===i.length-1&&this.addError(t.line,"Relationship key cannot be empty");continue}s=-1}else if(d===s+2){var u=i[d-1];this.queueRelationshipParsing({relMember1:e+"."+o,relationType:u.value||"-",relMember2:c.encoded||c.value||"",line:t.line}),s=-1;continue}var h=l.toLowerCase();if("null"===h||"nullable"===h)a.isNullable=!0;else if("pk"===h)a.isUniq&&this.addError(t.line,"The field cannot be a primary key and an unique key, since a primary key is unique"),a.isIdx&&this.addError(t.line,"The field cannot be a primary key and an index, since a primary key is an index"),a.isPk=!0;else if("unique"===h)a.isPk&&this.addError(t.line,"The field cannot be a primary key and an unique key, since a primary key is unique"),a.isIdx&&this.addError(t.line,"The field cannot be an unique key and an index, since an unique key is an index"),a.isUniq=!0;else if("index"===h)a.isPk&&this.addError(t.line,"The field cannot be a primary key and an index, since a primary key is an index"),a.isUniq&&this.addError(t.line,"The field cannot be an unique key and an index, since an unique key is an index"),a.isIdx=!0;else if("fk"===h)a.isFk=!0,s=d;else if("identity"===h||"autoincrement"===h)a.isIdentity=!0;else if(_.startsWith(h,"default="))a.defaultValue=h.replace("default=","");else if(a.type)this.addError(t.line,"Unrecognized keyword '"+l+"'");else if(r)a.type=" ";else if(_.includes(l,"=")){var m=l.split("=");a.type=m[0],a.defaultValue=m[1]}else a.type=l}return a}this.addError(t.line,"Table field name cannot be empty")}else this.addError(t.line,"Table field name cannot be empty")},t.prototype.tokenizeFieldLine=function(e){if(!_.contains(e,'"'))return _.map(this.splitByWhitespaceAndRemoveEmptyStrings(e),(function(e){return{value:e}}));for(var t=_.startsWith(e,'"')?0:1,i=[],n=[],o=[],r=0===t?1:0;r<e.length;r++){var a=e[r];0===t?'"'===a?t=1:(n.push(a),o.push(a)):1===t?" "===a?n.length>0&&(i.push(this.buildTableFieldToken(n,o)),n=[],o=[]):'"'===a?t=2:(n.push(a),o.push(a)):2===t&&('"'===a?t=1:(n.push(a),this.isAllowedName(a)||(a=this.decimalEncodeCharacter(a)),o.push(a)))}return n.length>0&&i.push(this.buildTableFieldToken(n,o)),i},t.prototype.buildTableFieldToken=function(e,t){var i=e.join(""),n=t.join(""),o={value:i};return i!==n&&(o.encoded=n),o},t.prototype.setSectionTableField=function(e,t,i){if(t&&0!==Object.keys(this.sections.tables).length)if(this.sections.tables[e].fields[t.identifier])this.addError(i,"Table field '"+t.identifier+"' already defined");else{var n=this.sections.tables[e].fields;t.order=_.size(n),n[t.identifier]=t}},t.prototype.isTableFieldsSeparator=function(e){return this.isMadeOfSameCharacters(e,this.QdbdParserConfig.tableSeparator)},t.prototype.isTableVirtualField=function(e){return this.isMadeOfSameCharacters(e,".")},t.prototype.isMadeOfSameCharacters=function(e,t){return!!_.startsWith(e,t)&&(e===t||/^(.)\1+$/.test(e))},t.prototype.getTable=function(e){return this.isCaseSensitive()?this.sections.tables[e]:_.find(this.sections.tables,(function(t){return t.identifier.toLowerCase()===e.toLowerCase()}))},t.prototype.getTableField=function(e,t){return this.isCaseSensitive()?e.fields[t]:_.find(e.fields,(function(e){return e.identifier.toLowerCase()===t.toLowerCase()}))},t.prototype.queueRelationshipParsing=function(e){this.relParsingQueue.push(e)},t.prototype.parseRelationships=function(){var e=this;_.each(this.relParsingQueue,(function(t){var i=e.parseRelationship(t);i&&e.postProcessRelationship(i)}))},t.prototype.parseRelationship=function(e){if(this.isRelationshipTypeToken(e.relationType)){var t=this.parseRelationshipToken(e.relMember1,e.line),i=this.parseRelationshipToken(e.relMember2,e.line);if(t&&i){this.resolveRelationshipAliases([t,i]);var n={table1:t,table2:i,line:e.line};if(this.resolveAssociationTypes(n,e.relationType),this.relationshipAlreadyExists(n))return this.sections.relationships.push(n),n}}else{var o=this.allowedRelTypes.join(", ");this.addError(e.line,"Invalid relationship description (allowed: "+o+")")}},t.prototype.isRelationshipTypeToken=function(e){return _.includes(this.allowedRelTypes,_.trim(e))},t.prototype.parseRelationshipToken=function(e,t){var i=_.trim(e);if(i){var n=i.split(".");if(!(n.length>2)){var o,r=this.getTable(n[0]);2===n.length&&r&&(o=this.getTableField(r,n[1]));var a=r&&r.identifier?r.identifier:n[0],s=r&&r.caption?r.caption:n[0];return{tableIdentifier:a,fieldIdentifier:2===n.length?o&&o.identifier?o.identifier:n[1]:"qdbdvirtualfield",tableCaption:s,type:"one",isPk:!1,isFk:!1}}this.addError(t,"Multi-nested relationships are not allowed")}else this.addError(t,"Relationship key cannot be empty")},t.prototype.resolveRelationshipAliases=function(e){var t=this;this.sections.aliases=this.sections.aliases||{},_.each(e,(function(e){var i=t.sections.aliases[e.tableIdentifier];i&&(e.tableIdentifier=i);var n=t.getTable(e.tableIdentifier);n&&(e.tableIdentifier=n.identifier)}))},t.prototype.resolveAssociationTypes=function(e,t){switch(t){case">-<":e.table1.type="many",e.table2.type="many";break;case">-":e.table1.type="many",e.table2.type="one";break;case"-<":e.table1.type="one",e.table2.type="many";break;case"-":e.table1.type="one",e.table2.type="one";break;case"0-":e.table1.type="zeroOne",e.table2.type="one";break;case"-0":e.table1.type="one",e.table2.type="zeroOne";break;case"0-0":e.table1.type="zeroOne",e.table2.type="zeroOne";break;case">0-":e.table1.type="zeroMany",e.table2.type="one";break;case"-0<":e.table1.type="one",e.table2.type="zeroMany"}},t.prototype.relationshipAlreadyExists=function(e){var t=this,i=_.find(this.sections.relationships,(function(i){return t.getDuplicateRelationship(i,e)}));return i&&this.addError(e.line,"Relationship already defined at line "+i.line),!i},t.prototype.getDuplicateRelationship=function(e,t){if(e.table1.tableIdentifier===t.table1.tableIdentifier&&e.table1.fieldIdentifier===t.table1.fieldIdentifier&&e.table2.tableIdentifier===t.table2.tableIdentifier&&e.table2.fieldIdentifier===t.table2.fieldIdentifier||e.table1.tableIdentifier===t.table2.tableIdentifier&&e.table1.fieldIdentifier===t.table2.fieldIdentifier&&e.table2.tableIdentifier===t.table1.tableIdentifier&&e.table2.fieldIdentifier===t.table1.fieldIdentifier)return e},t.prototype.postProcessRelationship=function(e){var t=this.validateRelationshipTable(e.table1,e.line),i=this.validateRelationshipTable(e.table2,e.line);if(t&&i){var n=this.validateRelationshipField(e.table1,t,e.line),o=this.validateRelationshipField(e.table2,i,e.line);n&&o&&this.resolveRelationshipKeys(e,n,o)}},t.prototype.validateRelationshipTable=function(e,t){var i=this.getTable(e.tableIdentifier);if(i)return i;this.addError(t,"Invalid relationship, the table '"+e.tableIdentifier+"' does not exist")},t.prototype.validateRelationshipField=function(e,t,i){var n;if(e.fieldIdentifier){if(!(n=this.getTableField(t,e.fieldIdentifier))){if("qdbdvirtualfield"!==e.fieldIdentifier)return void this.addError(i,"Invalid relationship, the field '"+e.tableIdentifier+"."+e.fieldIdentifier+"' does not exist");t.fields.qdbdvirtualfield={identifier:"qdbdvirtualfield",order:_.size(t.fields)}}return n}this.addError(i,"Invalid relationship, the field '"+e.tableIdentifier+".' is missing.")},t.prototype.resolveRelationshipKeys=function(e,t,i){this.resolveRelMemberKeys(e.table1,t),this.resolveRelMemberKeys(e.table2,i)},t.prototype.resolveRelMemberKeys=function(e,t){t.isPk?e.isPk=!0:"qdbdvirtualfield"!==t.identifier&&(e.isFk=!0,t.isFk=!0)},t.prototype.containsRelationshipType=function(e){var t=this;return!!_.find(e,(function(e){return _.contains(t.allowedRelTypes,e)}))},t.prototype.parseLayout=function(e){var t=this;_.each(e,(function(e){var i=t.tokenizeLayoutLine(e.value);if(3===i.length){var n=i[0],o=t.decimalEncodeText(n);if(o)if(t.getTable(o))if(t.sections.layout[o])t.addError(e.line,"Layout for '"+n+"' already defined");else{var r=_.trim(i[1]);if(t.isNumeric(r)){var a=parseFloat(r),s=_.trim(i[2]);if(t.isNumeric(s)){var d={identifier:o,x:a,y:parseFloat(s)};t.sections.layout[d.identifier]=d}else t.addError(e.line,"Invalid Y coordinate '"+s+"', number expected")}else t.addError(e.line,"Invalid X coordinate '"+r+"', number expected")}else t.addError(e.line,"Invalid layout definition name, the table '"+n+"' does not exist");else t.addError(e.line,"Table name cannot be empty")}else t.addError(e.line,"Layout definition requires 3 values (tableName, x, y)")}))},t.prototype.tokenizeLayoutLine=function(e){if(!_.contains(e,'"'))return this.splitByWhitespaceAndRemoveEmptyStrings(e);for(var t=_.startsWith(e,'"')?0:1,i=[],n=[],o=0===t?1:0;o<e.length;o++){var r=e[o];0===t?'"'===r?t=1:n.push(r):1===t&&(" "===r?n.length>0&&(i.push(n.join("")),n=[]):n.push(r))}return n.length>0&&i.push(n.join("")),i},t.prototype.splitByWhitespaceAndRemoveEmptyStrings=function(e){return e?_.filter(e.split(" "),(function(e){return!!e})):[]},t.prototype.splitAndGroupTokensByWhitespace=function(e){var t=[],i=[];return _.each(e,(function(e){if(""===e.value)return _.isEmpty(i)||t.push(i),void(i=[]);i.push(e)})),_.isEmpty(i)||t.push(i),t},t.prototype.getLineData=function(e){if(-1===e.indexOf("#"))return{data:_.trimRight(e)};var t=e.split("#"),i=!1,n="",o="";return _.each(t,(function(e){if(i)return o=e,!1;var t=(n?n+"#":"")+e,r=t.split('"').length-1;n=t,r%2==0&&(i=!0)})),{data:_.trimRight(n),comment:_.trim(o)}},t.prototype.splitDataByNewLine=function(e){return e.split(/\r?\n/)},t.prototype.stripMetadata=function(e){return e?e=(e=e.split(/\r?\n\[layout\]/i)[0]).split(/\r?\n\[settings\]/i)[0]:e},t.prototype.convertTabsToSpaces=function(e){return e?e=e.replace(/\t/g," "):e},t.prototype.splitTokenByFirstDelimiter=function(e,t){var i=e.indexOf(t),n=e.substr(0,i),o=e.substr(i+1);return-1===i?[o]:[n,o]},t.prototype.splitTokenByFirstWhitespace=function(e){return this.splitTokenByFirstDelimiter(e," ")},t.prototype.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},t.prototype.unquoteText=function(e){return _.trim(e,'"')},t.prototype.isAllowedName=function(e){return!!e.match(/[a-zA-Z0-9_]/)},t.prototype.decimalEncodeCharacter=function(e){return e.charCodeAt(0).toString()},t.prototype.decimalEncodeText=function(e){var t=this,i=[];return _.each(e,(function(e){t.isAllowedName(e)||(e=t.decimalEncodeCharacter(e)),i.push(e)})),i.join("")},t.prototype.addError=function(e,t){this.errors[e]||(this.errors[e]=[]),this.errors[e].push(t)},t.prototype.isCaseSensitive=function(){return this.settings?this.settings.isCaseSensitive:this.sections.settings.casesensitive||!1},t.prototype.isTableLimitReached=function(){return!!this.isLimitReached||!(!this.sections||!this.sections.tables)&&(!(_.size(this.sections.tables)<=10)&&(this.isLimitReached=!this.isProAccessEnabled()&&!this.currentUserHasProAccess(),this.isLimitReached))},t.prototype.isProAccessEnabled=function(){var e;return!!(null===(e=this.security)||void 0===e?void 0:e.isProAccessEnabled)},t.prototype.currentUserHasProAccess=function(){var e;return!!(null===(e=this.$rootScope.currentUser)||void 0===e?void 0:e.hasIndividualProAccess)},t=__decorate([e.Service("QdbdApp.Schema","SchemaParserService")],t)}();e.SchemaParserService=t}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r,a,s,d,c){this.$rootScope=e,this.$http=t,this.$state=i,this.$q=n,this.$mdDialog=o,this.SchemaFirebaseService=r,this.AccountService=a,this.AppStateService=s,this.BaseHttpService=d,this.ToastService=c}return t.$inject=["$rootScope","$http","$state","$q","$mdDialog","SchemaFirebaseService","AccountService","AppStateService","BaseHttpService","ToastService"],t.prototype.getDiagram=function(e){return this.$http.get("api/v1/diagrams/"+e)},t.prototype.getShortcode=function(e){return this.$http.get("api/v1/diagrams/shortcode/"+e)},t.prototype.filterDiagrams=function(e){return this.$http.get("api/v1/diagrams/filter",{params:e})},t.prototype.filterUserDiagrams=function(e){return this.$http.get("api/v1/diagrams/filterUserDiagrams",{params:e})},t.prototype.transitionToDiagram=function(e){return this.$state.go("root.standardShrinkable.diagram",{shortcode:e},{location:!0,inherit:!0,relative:this.$state.$current,notify:!1})},t.prototype.createDiagram=function(e){var t=this;return e.sharedMetadata&&e.sharedMetadata.name||_.extend(e.sharedMetadata,{name:this.getNewFileName()}),this.$http.post("api/v1/diagrams",e).then((function(e){var i=e.data;return t.SchemaFirebaseService.saveDiagram(i).then((function(){return i}))}))},t.prototype.createNamedDiagramInDir=function(e,t){var i={sharedMetadata:{name:e,parentId:t}};return this.createDiagram(i)},t.prototype.createDiagramInFolderWithNamePrompt=function(e){var t=this,i=this.$q.defer();return this.isUserAllowedToCreateNewDiagram().then((function(n){if(!n.data.isAllowed)return t.AccountService.requireSubscription(n.data.message),void i.reject();var o=t.$mdDialog.prompt().title("Enter new file name").placeholder("New Name").ariaLabel("New File Name").initialValue(t.getNewFileName()).ok("Save").cancel("Cancel").clickOutsideToClose(!0);t.$mdDialog.show(o).then((function(n){var o=t.createNamedDiagramInDir(n,e);i.resolve(o)}))})),i.promise},t.prototype.renameDiagram=function(e){var t=this;return this.$http.put("api/v1/diagrams/rename",e).then((function(i){var n=i.data;return t.SchemaFirebaseService.renameDiagram(e).then((function(){return n}))}))},t.prototype.deleteDiagram=function(e){return this.$http.delete("api/v1/diagrams/"+e)},t.prototype.moveDiagramToFolder=function(e){return this.BaseHttpService.post("api/v1/diagrams/moveToFolder",e)},t.prototype.getDiagramSecurity=function(e){return this.$http.get("api/v1/diagrams/security/"+e)},t.prototype.flipDiagramPrivacy=function(e){return this.$http.put("api/v1/diagrams/flipPrivacy/"+e,null)},t.prototype.isUserAllowedToCreateNewDiagram=function(){return this.$http.get("api/v1/diagrams/isUserAllowedToCreateNewDiagram")},t.prototype.getNewFileName=function(){var e=this.$rootScope.currentUser;return e&&e.hasIndividualProAccess?"New File":"Free Diagram"},t.prototype.autoSave=function(e){return e&&e.shortcode&&e.schema?this.$http.post("api/v1/diagrams/autoSave",e):this.$q.resolve()},t=__decorate([e.Service("QdbdApp.Schema","SchemaService")],t)}();e.SchemaService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r,a,s){var d=this;this.$rootScope=e,this.$scope=t,this.$timeout=i,this.AccountService=n,this.SourceEditorService=o,this.DiagramFolderService=r,this.SidenavService=a,this.TrackingService=s,this.schema={},this.diagramSecurity={},this.isCanvasMouseZoomEnabled=this.SourceEditorService.isCanvasMouseZoomEnabled(),this.isBasicPaletteActive=this.SourceEditorService.isBasicPaletteActive(),this.$scope.$on("diagram-changed",(function(e,t){t&&(d.schema=angular.copy(t))})),this.$scope.$on("diagram-security-changed",(function(e,t){t&&(d.diagramSecurity=angular.copy(t))}))}t.$inject=["$rootScope","$scope","$timeout","AccountService","SourceEditorService","DiagramFolderService","SidenavService","TrackingService"],t.prototype.newFolder=function(){var e=this;this.DiagramFolderService.openFolderTree(),this.$timeout((function(){e.AccountService.isUserLoggedIn()&&e.menuAction("addRootFolder")}))},t.prototype.newDiagram=function(){var e=this;this.DiagramFolderService.openFolderTree(),this.$timeout((function(){e.AccountService.isUserLoggedIn()&&e.menuAction("addRootDiagram")}))},t.prototype.menuAction=function(e,t){this.$rootScope.$broadcast("editor-menu-action",e,t)},t.prototype.showDocs=function(e){this.SidenavService.toggleRightSidenav(),this.TrackingService.trackDocumetation("Main")},t.prototype.save=function(){this.AccountService.requireLogin()},t.prototype.flipIsCanvasMouseZoomEnabled=function(){this.SourceEditorService.flipIsCanvasMouseZoomEnabled(),this.isCanvasMouseZoomEnabled=this.SourceEditorService.isCanvasMouseZoomEnabled()},t.prototype.flipIsBasicPaletteActive=function(){this.SourceEditorService.flipActivePalette(),this.isBasicPaletteActive=this.SourceEditorService.isBasicPaletteActive(),this.TrackingService.trackColorPalette(this.SourceEditorService.getActivePalette()),this.$rootScope.$broadcast("re-render-diagram")},t=__decorate([e.Component("QdbdApp.SourceEditor","dtSourceEditorMenu",{templateUrl:"cache/modules/source-editor/dt-source-editor-menu.html",controllerAs:"DtSourceEditorMenuVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function e(e,t,i,n,o,r,a,s,d,c,l,u,h,m,p,g,f,v,b,S,y,D,w){this.$rootScope=e,this.$scope=t,this.$timeout=i,this.$state=n,this.$q=o,this.$mdDialog=r,this.SchemaService=a,this.DiagramFolderService=s,this.SourceEditorService=d,this.SchemaParserService=c,this.SchemaImportService=l,this.SchemaExportService=u,this.SchemaFirebaseService=h,this.SchemaMigrationService=m,this.OrganizationService=p,this.CollaboratorsService=g,this.DiagramExportService=f,this.AppStateService=v,this.AppTourService=b,this.AccountService=S,this.TrackingService=y,this.DialogService=D,this.ToastService=w,this.parsingStatus="loading",this.isRenderingInitialized=!1,this.updateCausedByInteraction=!1,this.isMetadataConversionInProgress=!1}return e.$inject=["$rootScope","$scope","$timeout","$state","$q","$mdDialog","SchemaService","DiagramFolderService","SourceEditorService","SchemaParserService","SchemaImportService","SchemaExportService","SchemaFirebaseService","SchemaMigrationService","OrganizationService","CollaboratorsService","DiagramExportService","AppStateService","AppTourService","AccountService","TrackingService","DialogService","ToastService"],e.prototype.$onInit=function(){var e=this;this.SourceEditorService.setLocalShortcode(this.getUrlShortcode()),this.initializeAceEditor(),this.shouldSaveCurrentDiagram().then((function(t){t?e.saveCurrentDiagram():e.initializeDirective()}))},e.prototype.$onDestroy=function(){this.SchemaFirebaseService.disposeRefs(this.firebaseRefs)},e.prototype.shouldSaveCurrentDiagram=function(){var e=this,t=this.getUrlShortcode(),i=this.AppStateService.getCurrentDiagram();return!t&&i&&!i.shortcode&&this.AccountService.isUserLoggedIn()&&!this.isDefaultDiagramAndUserAlreadyHasDiagrams(i)?this.SchemaService.isUserAllowedToCreateNewDiagram().then((function(t){return!!t.data.isAllowed||e.disallowCurrentDiagramSaving()})).catch(this.disallowCurrentDiagramSaving.bind(this)):this.$q.resolve(!1)},e.prototype.disallowCurrentDiagramSaving=function(){return this.ToastService.showError("Pro account required to save the diagram you just created before logging in"),!1},e.prototype.isDefaultDiagramAndUserAlreadyHasDiagrams=function(e){return!!(e&&_.isString(e.schema)&&this.$rootScope.currentUser&&0!==this.$rootScope.currentUser.schemaStats.diagramCount)&&(""===e.schema||this.SourceEditorService.isDemoSampleWithoutMeta(e.schema))},e.prototype.saveCurrentDiagram=function(){var e=this;this.DialogService.showDialogNotification(0===this.$rootScope.currentUser.schemaStats.diagramCount?"Please wait while we set up your account.":"Please wait while we save your new diagram."),this.SchemaFirebaseService.signIn().then((function(){return e.SchemaService.createDiagram(e.AppStateService.getCurrentDiagram())})).then((function(t){e.$state.go("root.standardShrinkable.diagram",{shortcode:t.shortcode})})).finally((function(){e.$mdDialog.cancel()}))},e.prototype.initializeDirective=function(){var e=this.SourceEditorService.getLocalShortcode();if(this.firebaseRefs={},this.diagram=this.AppStateService.diagramFactory(),this.diagram.shortcode){if(this.isLegacySchemaRoute())return void this.$state.go("root.standardShrinkable.diagram",{shortcode:this.diagram.shortcode});this.initializeServerDiagram()}else if(this.diagram&&this.diagram.schema){if(this.isDefaultDiagramAndUserAlreadyHasDiagrams(this.diagram))return void this.goToFirstFolderTreeItemOrLoadDefaultDiagram();this.loadCurrentDiagram()}else{if(e)return void this.$state.go("root.standardShrinkable.diagram",{shortcode:e});this.AccountService.isUserLoggedIn()?this.goToFirstFolderTreeItemOrLoadDefaultDiagram():this.loadDefaultDiagram()}this.registerEventHandlers()},e.prototype.isLegacySchemaRoute=function(){return this.$state.is("root.standardShrinkable.schema")},e.prototype.registerEventHandlers=function(){var e=this;this.registerMenuActionListener(),this.$scope.$on("diagram-writable-changed",this.onDiagramWritableChanged.bind(this)),this.$scope.$on("diagram-dragged",this.onDiagramDragged.bind(this)),this.$scope.$on("diagram-table-row-clicked",this.onDiagramTableRowClicked.bind(this)),this.$scope.$on("diagram-table-moved",this.onDiagramTableMoved.bind(this)),this.$scope.$on("diagram-ports-connected",this.onDiagramPortsConnected.bind(this)),this.$scope.$on("diagram-link-removed",this.onDiagramLinkRemoved.bind(this)),this.$scope.$on("center-diagram",this.centerDiagram.bind(this)),this.$scope.$on("diagram-zoom-set",this.onDiagramZoomSet.bind(this)),this.$scope.$on("diagram-viewport-set",this.onDiagramViewportSet.bind(this)),this.$scope.$on("re-render-diagram",(function(){return e.rerenderCurrentSchema(!0)})),this.$scope.$on("unload-editor-diagram",this.unloadDiagram.bind(this))},e.prototype.initializeAceEditor=function(){this.$scope.aceLoaded=this.onAceLoaded.bind(this),this.$scope.aceChanged=this.onAceChanged.bind(this)},e.prototype.onAceLoaded=function(e){this.aceEditor=e,this.aceEditor.$blockScrolling=1/0,this.aceEditor.setOptions({maxLines:1e4,autoScrollEditorIntoView:!0}),this.aceEditor.resize(!0),this.aceEditor.setValue("",-1),this.AppTourService.initializeTour(),this.aceEditor.commands.addCommand({name:"find",bindKey:{win:"Ctrl-F",mac:"Command-F",sender:"editor|cli"},exec:function(){return!1},readOnly:!0})},e.prototype.onAceChanged=function(e){this.initializeRenderingStage1()},e.prototype.intializeFirePad=function(){var e=this;this.aceEditor.setReadOnly(this.diagramSecurity.isLockedForEditing);var t=this.SchemaMigrationService.isMigrationToFirebaseRequired();t&&this.DialogService.showDialogNotification("Please wait while we update your account."),this.SchemaFirebaseService.signIn().then((function(){return e.SchemaMigrationService.migrateToFirebase()})).then((function(){if(t)return e.$mdDialog.cancel(),void e.goToFirstFolderTreeItemOrLoadDefaultDiagram();e.firebaseRefs.firepad=e.SchemaFirebaseService.editorFactory(e.aceEditor,e.diagram.shortcode),e.firebaseRefs.firepad.setUserColor(e.getRandomUserColor()),e.intializeFirebaseEventHandlers()})).catch((function(t){console.log(t),e.$timeout((function(){e.$mdDialog.cancel()}),1e4)}))},e.prototype.getRandomUserColor=function(){return _.sample(["#63463b","#635e3b","#52633b","#3b6345","#3b6358","#523b63","#613b63","#633b4d"])},e.prototype.intializeFirebaseEventHandlers=function(){var e=this.diagram.shortcode;this.firebaseRefs.sharedMetadata=this.SchemaFirebaseService.registerSharedMetadataListener(e,this.onSharedMetadataHandler.bind(this)),this.firebaseRefs.layout=this.SchemaFirebaseService.registerLayoutListener(e,this.onLayoutHandler.bind(this)),this.firebaseRefs.viewport=this.SchemaFirebaseService.registerViewportListener(e,this.onViewportHandler.bind(this))},e.prototype.onSharedMetadataHandler=function(e,t){e||_.isEqual(this.diagram.sharedMetadata,t)||(this.diagram.sharedMetadata=t,this.initializeRenderingStage1())},e.prototype.onLayoutHandler=function(e,t){e||_.isEqual(this.diagram.layout,t)||(this.diagram.layout=t,this.initializeRenderingStage1())},e.prototype.onViewportHandler=function(e,t){e||_.isEqual(this.diagram.viewport,t)||(this.diagram.viewport=t,this.initializeRenderingStage1())},e.prototype.initializeRenderingStage1=function(){if(this.diagram){this.cancelInitializedRendering();var e=this.aceEditor.getValue();return e?".."===e?(this.demo(),void(this.isRenderingInitialized=!1)):void(this.isMetadataConversionInProgress&&this.SourceEditorService.schemaContainsMetadata(e)||(this.isMetadataConversionInProgress=!1,this.diagram.schema=e,this.qdbdSchema=this.SchemaParserService.parseSource(e,this.diagram.sharedMetadata,this.diagramSecurity),this.SourceEditorService.schemaErrorsExist(this.qdbdSchema)?this.handleSchemaErrors(this.diagram,this.qdbdSchema):(this.setPageTitle(),this.initializeRenderingStage2(this.diagram,this.diagramSecurity,this.qdbdSchema)))):(this.setPageTitle(),this.initializeRenderingStage2(this.diagram,this.diagramSecurity),this.diagram.schema="",void(this.qdbdSchema=this.SchemaParserService.parseSource("")))}},e.prototype.initializeRenderingStage2=function(e,t,i){var n=this;this.SourceEditorService.applySchemaMetadataConversion(e,i)&&this.onMetadataConversion(e),this.SourceEditorService.purgeParentlessLayoutTables(e,i),this.broadcastDiagramChanged(e,i),this.broadcastRenderPromise=this.$timeout((function(){n.aceEditor.getSession().clearAnnotations(),n.broadcastRenderDiagram(e,i),n.autoSave(e),n.profitWellTrack(),n.TrackingService.trackEditor(0,"Keypress","initialize_rendering"),n.isRenderingInitialized=!0,n.updateCausedByInteraction=!1}),this.updateCausedByInteraction?void 0:750)},e.prototype.onMetadataConversion=function(e){this.AccountService.isUserLoggedIn()&&(this.isMetadataConversionInProgress=!0,this.SchemaFirebaseService.saveDiagramMetadata(e)),this.aceEditor.setValue(e.schema,-1),this.SourceEditorService.metadataConversionNotification(e)},e.prototype.cancelInitializedRendering=function(){this.broadcastRenderPromise&&(this.$timeout.cancel(this.broadcastRenderPromise),this.isRenderingInitialized=!1,this.broadcastRenderPromise=void 0)},e.prototype.rerenderCurrentSchema=function(e){void 0===e&&(e=!1),this.updateCausedByInteraction=e,this.initializeRenderingStage1()},e.prototype.initializeServerDiagram=function(){var e=this,t=this.getUrlShortcode();t.length>6?this.resolveShorterShortcodeRoute(t):this.resolveDiagramSecurity().then((function(t){_.isEmpty(t)?(e.ToastService.showError("Diagram does not exist."),e.AccountService.isUserLoggedIn()||(e.SourceEditorService.clearLocalShortcode(),e.$state.go("root.standardShrinkable.home"))):e.intializeFirePad()}))},e.prototype.resolveShorterShortcodeRoute=function(e){var t=this;this.SchemaService.getShortcode(e).then((function(e){e.data?t.$state.go("root.standardShrinkable.diagram",{shortcode:e.data}):t.ToastService.showError("Diagram does not exist.")}))},e.prototype.resolveDiagramSecurity=function(){var e=this;return this.SchemaService.getDiagramSecurity(this.diagram.shortcode).then((function(t){var i=e.diagramSecurity=t.data||{};return e.$rootScope.$broadcast("diagram-security-changed",i),i}))},e.prototype.loadCurrentDiagram=function(){this.loadSchema(this.diagram.schema),this.AccountService.isUserLoggedIn()&&!this.$rootScope.currentUser.hasIndividualProAccess&&this.$rootScope.currentUser.schemaStats.diagramCount>0&&this.aceEditor.setReadOnly(!0)},e.prototype.goToFirstFolderTreeItemOrLoadDefaultDiagram=function(){var e=this;this.DiagramFolderService.getFirstFolderDiagram().then((function(t){t?e.$state.go("root.standardShrinkable.diagram",{shortcode:t.shortcode},{reload:!0}):e.loadDefaultDiagram()}))},e.prototype.loadDefaultDiagram=function(){this.SourceEditorService.isDemoInitialized()?this.loadSchema(""):(this.loadDemoSchema(),this.SourceEditorService.flagDemoAsInitialized())},e.prototype.loadDemoSchema=function(){var e=this.SourceEditorService.getDemoSample();this.loadSchema(e)},e.prototype.loadSchema=function(e){var t=this;angular.element("#schema-canvas").ready((function(){t.aceEditor.setValue(e||"",-1)}))},e.prototype.handleSchemaErrors=function(e,t){var i=this.SourceEditorService.createAceErrors(t.errors);this.aceEditor.getSession().setAnnotations(i),this.broadcastDiagramChanged(e,t)},e.prototype.onDiagramDragged=function(e,t){var i=this;this.delayInteraction((function(){i.SourceEditorService.setViewportPosition(i.diagram,t.x,t.y),i.SchemaFirebaseService.setDiagramViewport(i.diagram.shortcode,i.diagram.viewport)}))},e.prototype.onDiagramTableRowClicked=function(e,t){this.goToLine(t)},e.prototype.onDiagramTableMoved=function(e,t,i){var n=this;this.delayInteraction((function(){n.SourceEditorService.purgeParentlessLayoutTables(n.diagram,n.qdbdSchema),n.SourceEditorService.ensureLayoutExists(n.diagram);var e={x:t.x,y:t.y};n.SourceEditorService.updateTablePosition(n.diagram,i,e),n.SchemaFirebaseService.setDiagramLayoutTable(n.diagram.shortcode,i,e)}))},e.prototype.onDiagramPortsConnected=function(e,t){var i=this;this.diagramSecurity&&this.diagramSecurity.isLockedForEditing?this.ToastService.showInfo("This diagram is in read-only mode."):this.delayInteraction((function(){i.updateCausedByInteraction=!0;var e=parseInt(t.fromLine)-1,n=i.aceEditor.session.getLine(e),o=i.SourceEditorService.addRelationshipToLine(n,t);i.updateAceLine(e,o)}))},e.prototype.onDiagramLinkRemoved=function(e,t){var i=this;this.diagramSecurity&&this.diagramSecurity.isLockedForEditing?this.ToastService.showInfo("This diagram is in read-only mode."):this.delayInteraction((function(){i.updateCausedByInteraction=!0;var e=t-1,n=i.aceEditor.session.getLine(e),o=i.SourceEditorService.removeRelationshipFromLine(n,t);o?i.updateAceLine(e,o):i.removeAceLine(e)}))},e.prototype.centerDiagram=function(e,t){this.SourceEditorService.setViewportPosition(this.diagram,0,0),t&&this.rerenderCurrentSchema(!0),this.SchemaFirebaseService.setDiagramViewport(this.diagram.shortcode,this.diagram.viewport)},e.prototype.onDiagramZoomSet=function(e,t,i){this.SourceEditorService.resolveZoomLevel(this.diagram,t),i&&this.rerenderCurrentSchema(!0),this.SchemaFirebaseService.setDiagramViewport(this.diagram.shortcode,this.diagram.viewport)},e.prototype.onDiagramViewportSet=function(e,t,i){this.SourceEditorService.setViewport(this.diagram,t),i&&this.rerenderCurrentSchema(!0),this.SchemaFirebaseService.setDiagramViewport(this.diagram.shortcode,this.diagram.viewport)},e.prototype.onDiagramWritableChanged=function(e,t){this.aceEditor.setReadOnly(!t)},e.prototype.registerMenuActionListener=function(){var e=this;this.$scope.$on("editor-menu-action",(function(t,i,n){e[i]&&e[i](n)}))},e.prototype.rename=function(){var e=this,t=this.$mdDialog.prompt().title("Rename file").placeholder("New Name").ariaLabel("New File Name").initialValue(this.diagram.sharedMetadata.name).ok("Ok").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(t).then((function(t){t?(e.SchemaService.renameDiagram({name:t,shortcode:e.diagram.shortcode}),e.broadcastDiagramChanged(e.diagram,e.qdbdSchema)):e.ToastService.showWarning("Name is required")}))},e.prototype.copyCurrentDiagram=function(){var e=this;this.AccountService.requireLogin()||this.AccountService.requireSubscription()||this.SchemaService.createDiagram(this.diagram).then((function(t){_.extend(e.diagram,t),e.onSchemaSaved(e.diagram.shortcode),e.ToastService.showInfo("Diagram copied successfully.")}))},e.prototype.onSchemaSaved=function(e){this.SchemaService.transitionToDiagram(e),this.SourceEditorService.setLocalShortcode(e),this.setPageTitle(),this.broadcastDiagramChanged(this.diagram,this.qdbdSchema)},e.prototype.flipPrivate=function(){var e=this;if(!this.AccountService.requireSubscription()){var t=this.$mdDialog.confirm().title(this.diagramSecurity.isPrivate?"Make public":"Make private").htmlContent("<p>Are you sure you want to change the privacy of the diagram?</p>").ok("Yes").cancel("No").clickOutsideToClose(!0);this.$mdDialog.show(t).then((function(){e.SchemaService.flipDiagramPrivacy(e.diagram.shortcode).then((function(){return e.resolveDiagramSecurity()})).then((function(){e.rerenderCurrentSchema(!0)}))}))}},e.prototype.clear=function(){this.aceEditor.setValue("",-1)},e.prototype.demo=function(){var e=this,t=this.$mdDialog.confirm().title("Load Sample Diagram").htmlContent("<p>WARNING: This is an irreversible action. Your current diagram will</br>be replaced with the sample diagram. Would you like to proceed?</p>").ok("Yes").cancel("No").clickOutsideToClose(!0);this.$mdDialog.show(t).then((function(){var t=e.SourceEditorService.getDemoSample();e.aceEditor.setValue(t,-1),e.TrackingService.trackEditor(0,"Reset","reset")}))},e.prototype.undo=function(){this.aceEditor.undo(),this.aceEditor.gotoLine(0,0)},e.prototype.redo=function(){this.aceEditor.redo(),this.aceEditor.gotoLine(0,0)},e.prototype.cut=function(){this.copy(),this.aceEditor.insert("")},e.prototype.copy=function(){this.aceEditor.selection.toJSON();this.aceEditor.focus(),document.execCommand("copy")},e.prototype.exportToSQL=function(e){this.SchemaExportService.exportToSQL(this.diagram.shortcode,this.qdbdSchema,e,this.getSchemaUrl(),this.getSchemaName())},e.prototype.importFromSQL=function(e){var t,i=this;(t=document.getElementById("import-file-input")).onchange=function(n){var o=n.target.files[0],r=new FileReader;r.onload=function(){i.SchemaImportService.importFromSQL(r.result,e).then((function(e){i.aceEditor.setValue(e,-1)}))},r.readAsText(o),t.value=""},t.click()},e.prototype.exportToDoc=function(e){this.SchemaExportService.exportToDoc(this.diagram.shortcode,this.qdbdSchema,e,this.getSchemaUrl(),this.getSchemaName())},e.prototype.exportToSVG=function(){0!==Object.keys(this.qdbdSchema.errors).length?this.ToastService.showError("Schema contains errors and cannot be exported."):this.DiagramExportService.exportToSVG(this.diagram,this.qdbdSchema)},e.prototype.exportToPNG=function(){0!==Object.keys(this.qdbdSchema.errors).length?this.ToastService.showError("Schema contains errors and cannot be exported."):this.DiagramExportService.exportToPNG(this.diagram,this.qdbdSchema)},e.prototype.untabify=function(){var e=this.aceEditor.getValue(),t=this.SchemaParserService.convertTabsToSpaces(e);this.loadSchema(t)},e.prototype.setFieldType=function(){var e=this,t=this.$mdDialog.prompt().title("Enter default field type").placeholder("Field Type").ariaLabel("New Field Type").initialValue(this.getDefaultFieldType()).ok("Ok").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(t).then((function(t){e.SourceEditorService.ensureSharedMetadataExists(e.diagram),e.diagram.sharedMetadata.defaultType=t,e.SchemaFirebaseService.setDiagramSharedMetadata(e.diagram.shortcode,e.diagram.sharedMetadata),e.rerenderCurrentSchema(!0)}))},e.prototype.flipCasing=function(){this.SourceEditorService.ensureSharedMetadataExists(this.diagram),this.diagram.sharedMetadata.isCaseSensitive=!this.diagram.sharedMetadata.isCaseSensitive,this.SchemaFirebaseService.setDiagramSharedMetadata(this.diagram.shortcode,this.diagram.sharedMetadata),this.rerenderCurrentSchema(!0)},e.prototype.getDefaultFieldType=function(){return this.diagram&&this.diagram.sharedMetadata&&this.diagram.sharedMetadata.defaultType||"int"},e.prototype.focusEditor=function(){this.aceEditor.focus()},e.prototype.getTableCount=function(){return this.aceEditor.getValue()&&this.qdbdSchema&&this.qdbdSchema.sections?_.size(this.qdbdSchema.sections.tables):0},e.prototype.unloadDiagram=function(){this.SchemaFirebaseService.disposeRefs(this.firebaseRefs),this.diagram=void 0},e.prototype.delayInteraction=function(e,t){this.interactionTimeout&&this.$timeout.cancel(this.interactionTimeout),this.interactionTimeout=this.$timeout((function(){e()}),t||150)},e.prototype.getParsingStatus=function(){return this.broadcastRenderPromise&&0===this.broadcastRenderPromise.$$state.status&&!this.updateCausedByInteraction?this.parsingStatus="loading":this.SourceEditorService.schemaErrorsExist(this.qdbdSchema)?this.parsingStatus="error":this.parsingStatus="success",this.parsingStatus},e.prototype.updateAceLine=function(e,t,i){void 0===i&&(i=!0),this.aceEditor.session.replace({start:{row:e,column:0},end:{row:e,column:Number.MAX_VALUE}},t),i&&this.goToLine(e+1)},e.prototype.removeAceLine=function(e){this.aceEditor.session.replace({start:{row:e-1,column:Number.MAX_VALUE},end:{row:e,column:Number.MAX_VALUE}},"")},e.prototype.goToLine=function(e){this.aceEditor.resize(!0),this.aceEditor.gotoLine(e,Number.MAX_VALUE),this.aceEditor.focus()},e.prototype.getSchemaUrl=function(){return this.getUrlShortcode()?window.location.href:void 0},e.prototype.getUrlShortcode=function(){return this.$state.params.shortcode},e.prototype.getSchemaName=function(){return this.diagram&&this.diagram.sharedMetadata&&this.diagram.sharedMetadata.name?this.diagram.sharedMetadata.name:void 0},e.prototype.getDiagramLockedReason=function(){if(this.diagramSecurity&&this.diagramSecurity.isLockedForEditing){if(!this.AccountService.isUserLoggedIn())return"Login to edit this diagram.";if(!this.diagramSecurity.isOwnedByCurrentUser)return this.diagramSecurity.organizationOwnerId?"This diagram is in read-only mode for you because you don't have Organization Pro access.":"This diagram is in read-only mode for you because the owner does not have Pro access. Click to copy and enable editing.";if(this.diagramSecurity.requireProAccess)return"Go Pro to edit this diagram."}return"Diagram locked for editing."},e.prototype.onLockButtonClick=function(){if(this.diagramSecurity&&this.diagramSecurity.isLockedForEditing){if(!this.AccountService.isUserLoggedIn())return void this.$state.go("root.centered.login");if(!this.diagramSecurity.isOwnedByCurrentUser)return void(this.diagramSecurity.organizationOwnerId||this.copyCurrentDiagram());if(this.diagramSecurity.requireProAccess)return void this.$state.go("root.centered.subscribe")}},e.prototype.showReadOnlyMessage=function(){return this.diagramSecurity&&this.AccountService.isUserLoggedIn()&&this.diagramSecurity.isLockedForEditing&&!this.diagramSecurity.isOwnedByCurrentUser},e.prototype.setPageTitle=function(){if(this.diagram&&this.diagram.shortcode){var e=(this.diagram.sharedMetadata?this.diagram.sharedMetadata.name:void 0)||this.SchemaService.getNewFileName();e&&(e+=" - "),this.$rootScope.pageTitle=e+"QuickDBD"}else this.$rootScope.pageTitle="QuickDBD"},e.prototype.goPro=function(){this.AccountService.requireLogin()||this.$state.go("root.centered.subscribe")},e.prototype.broadcastDiagramChanged=function(e,t){this.$rootScope.$broadcast("diagram-changed",e,t)},e.prototype.broadcastRenderDiagram=function(e,t){this.$rootScope.$broadcast("render-diagram",e,t),this.broadcastDiagramChanged(e,t)},e.prototype.autoSave=function(e){this.lastAutoSaveAt?this.lastAutoSaveAt.isAfter(moment().add(-1,"minutes"))||(this.lastAutoSaveAt=moment(),this.SchemaService.autoSave(e),this.diagram.sharedMetadata&&!this.diagramSecurity.isLockedForEditing&&this.SchemaFirebaseService.setDiagramSharedMetadata(this.diagram.shortcode,this.diagram.sharedMetadata)):this.lastAutoSaveAt=moment()},e.prototype.profitWellTrack=function(){this.lastProfitWellAt?this.lastProfitWellAt.isAfter(moment().add(-1,"hours"))||(this.lastProfitWellAt=moment(),this.TrackingService.profitWellTrack()):this.lastProfitWellAt=moment()},e.prototype.collaborate=function(){this.CollaboratorsService.collaborate(this.diagram.shortcode,"diagram",this.diagramSecurity.isOwnedByCurrentUser)},e.prototype.manageAccess=function(){var e=this.$state.href("root.standard.organization.diagramsAccess",{diagramId:this.diagramSecurity.diagramId,organizationId:this.diagramSecurity.organizationOwnerId});window.open(e,"_blank")},e.prototype.delete=function(){var e=this,t=this.diagramSecurity.diagramId,i=this.$mdDialog.confirm().title("Delete Diagram").htmlContent("Are you sure you want to delete this diagram?").ok("Yes, delete").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){e.unloadDiagram(),e.OrganizationService.deleteOrganizationDiagram(e.$rootScope.currentUser.organizationId,t).then((function(){e.ToastService.showInfo("Diagram deleted successfully"),e.goToFirstFolderTreeItemOrLoadDefaultDiagram()}))}))},e}();angular.module("QdbdApp.SourceEditor").controller("DtSourceEditorCtrl",t).directive("dtSourceEditor",(function(){return{restrict:"E",templateUrl:"cache/modules/source-editor/dt-source-editor.html"}}))}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r,a,s,d){this.$rootScope=e,this.$state=t,this.$http=i,this.$mdDialog=n,this.localStorageService=o,this.SchemaParserService=r,this.SchemaFirebaseService=a,this.AccountService=s,this.ToastService=d,this.editorSize={},this.SHORTCODE_KEY="shortcode",this.EDITOR_SIZE_KEY="editorSize",this.IS_CANVAS_MOUSE_ZOOM_ENABLED="isCanvasMouseZoomEnabled",this.COLOR_PALETTE="colorPalette",this.DEMO_INITIALIZED_KEY="demoInitialized",this.CONVERSION_NOTIFICATION_KEY="metaConversionNotified",this.initializeEditorSize()}return t.$inject=["$rootScope","$state","$http","$mdDialog","localStorageService","SchemaParserService","SchemaFirebaseService","AccountService","ToastService"],t.prototype.getLocalShortcode=function(){return this.localStorageService.get(this.SHORTCODE_KEY)},t.prototype.setLocalShortcode=function(e){e&&this.localStorageService.set(this.SHORTCODE_KEY,e)},t.prototype.clearLocalShortcode=function(){this.localStorageService.remove(this.SHORTCODE_KEY)},t.prototype.isDemoInitialized=function(){return this.localStorageService.get(this.DEMO_INITIALIZED_KEY)},t.prototype.flagDemoAsInitialized=function(){this.localStorageService.set(this.DEMO_INITIALIZED_KEY,!0)},t.prototype.getDemoSample=function(){return"# Modify this code to update the DB schema diagram.\n# To reset the sample schema, replace everything with\n# two dots ('..' - without quotes).\n\nCustomer\n-\nCustomerID PK int\nName string INDEX\nAddress1 string\nAddress2 NULL string\nAddress3 NULL string\n\nOrder\n-\nOrderID PK int\nCustomerID int FK >- Customer.CustomerID\nTotalAmount money\nOrderStatusID int FK >- os.OrderStatusID\n\nOrderLine as ol\n----\nOrderLineID PK int\nOrderID int FK >- Order.OrderID\nProductID int FK >- p.ProductID\nQuantity int\n\n# Table documentation comment 1 (try the PDF/RTF export)\nProduct as p # Table documentation comment 2\n------------\nProductID PK int\n# Field documentation comment 1\n# Field documentation comment 2 \nName varchar(200) UNIQUE # Field documentation comment 3\nPrice money\n\nOrderStatus as os\n----\nOrderStatusID PK int\nName UNIQUE string\n\n[settings]\nZoom 100\nDefaultFieldType int\nCaseSensitive on\n\n[layout]\nOrder 564 208\nCustomer 189 348\nOrderStatus 819 230\nProduct 63 55\nOrderLine 322 122"},t.prototype.isDemoSample=function(e){return e===this.getDemoSample()},t.prototype.isDemoSampleWithoutMeta=function(e){var t=this.getDemoSample(),i=this.SchemaParserService.stripMetadata(t);return _.trim(e)===_.trim(i)},t.prototype.isCanvasMouseZoomEnabled=function(){var e=this.localStorageService.get(this.IS_CANVAS_MOUSE_ZOOM_ENABLED);return!_.isBoolean(e)||e},t.prototype.flipIsCanvasMouseZoomEnabled=function(){var e=this.isCanvasMouseZoomEnabled();this.localStorageService.set(this.IS_CANVAS_MOUSE_ZOOM_ENABLED,!e)},t.prototype.getActivePalette=function(){return this.localStorageService.get(this.COLOR_PALETTE)},t.prototype.isBasicPaletteActive=function(){return"basic"===this.getActivePalette()},t.prototype.flipActivePalette=function(){var e=this.isBasicPaletteActive();this.localStorageService.set(this.COLOR_PALETTE,e?"default":"basic")},t.prototype.saveLocalEditorSize=function(){this.localStorageService.set(this.EDITOR_SIZE_KEY,this.editorSize.x)},t.prototype.initializeEditorSize=function(){this.editorSize.x=this.getLocalEditorSize()||25},t.prototype.getLocalEditorSize=function(){return this.localStorageService.get(this.EDITOR_SIZE_KEY)},t.prototype.ensureSharedMetadataExists=function(e){e.sharedMetadata||(e.sharedMetadata={})},t.prototype.ensureLayoutExists=function(e){e.layout||(e.layout={})},t.prototype.ensureViewportExists=function(e){e.viewport||(e.viewport={});var t=e.viewport.position;null==t&&(e.viewport.position={x:0,y:0});var i=e.viewport.zoom;null==i&&(e.viewport.zoom=100)},t.prototype.setViewport=function(e,t){this.ensureViewportExists(e),_.extend(e.viewport,t)},t.prototype.setViewportPosition=function(e,t,i){this.ensureViewportExists(e),_.extend(e.viewport.position,{x:t,y:i})},t.prototype.getZoomValue=function(e){return e&&e.viewport&&e.viewport.zoom?e.viewport.zoom:100},t.prototype.resolveZoomLevel=function(e,t){this.ensureViewportExists(e),e.viewport.zoom=this.validateZoom(t)},t.prototype.resolveZoomDiff=function(e,t){this.ensureViewportExists(e),e.viewport.zoom=this.resolveZoomDiffValue(e.viewport.zoom,t)},t.prototype.resolveZoomDiffValue=function(e,t){return this.validateZoom(e+t)},t.prototype.validateZoom=function(e){return null==e?100:e<10?10:e>200?200:e},t.prototype.addRelationshipToLine=function(e,t){if(t.fromLine===t.toLine)return e;if(this.SchemaParserService.isValidLine(parseInt(t.fromLine)))return this.ToastService.showError("Could not create relationship, found error on line "+t.fromLine+"."),e;var i="FK >- "+this.createRelDefinitionSegment(t.toTable)+"."+this.createRelDefinitionSegment(t.toField),n=this.stripExtraWhitespace(e),o=n.split(" "),r=_.findIndex(o,(function(e){return"fk"===e.toLowerCase()}));if(-1===r)n=n+" "+i;else{var a=this.SchemaParserService.containsRelationshipType(o)?3:1,s=o.slice(r,r+a).join(" ");n=n.replace(s,i)}return n},t.prototype.createRelDefinitionSegment=function(e){return _.contains(e,".")?'"'+e+'"':e},t.prototype.removeRelationshipFromLine=function(e,t){if(this.SchemaParserService.isValidLine(t))return this.ToastService.showError("Could not create relationship, found error on line "+t+"."),e;if(_.startsWith(e,"rel ")&&!_.contains(e.toLowerCase(),"fk"))return"";var i=e.split(" "),n=_.findIndex(i,(function(e){return"fk"===e.toLowerCase()}));return i.splice(n,3),i.join(" ")},t.prototype.createAceErrors=function(e){return _.map(e,(function(e,t){return{row:parseInt(t)-1,text:e.join("\r\n"),type:"error"}}))},t.prototype.schemaErrorsExist=function(e){return!!e&&!_.isEmpty(e.errors)},t.prototype.applySchemaMetadataConversion=function(e,t){var i=this;if(!e||!t)return!1;if(!this.schemaContainsMetadata(e.schema))return!1;if(t.sections&&t.sections.settings){var n=t.sections.settings;this.ensureSharedMetadataExists(e),this.ensureViewportExists(e),_.extend(e.sharedMetadata,{isCaseSensitive:n.casesensitive,defaultType:n.defaultfieldtype}),_.extend(e.viewport,{zoom:n.zoom,position:n.position})}return t.sections&&t.sections.layout&&(this.ensureLayoutExists(e),_.each(t.sections.layout,(function(t,n){i.updateTablePosition(e,n,{x:t.x,y:t.y})}))),e.schema=this.SchemaParserService.stripMetadata(e.schema),!0},t.prototype.schemaContainsMetadata=function(e){var t=this.SchemaParserService.stripMetadata(e);return _.trim(t)!==_.trim(e)},t.prototype.updateTablePosition=function(e,t,i){e.layout&&(e.layout[t]=i)},t.prototype.purgeParentlessLayoutTables=function(e,t){if(t&&t.sections){var i=_.map(t.sections.tables,"identifier"),n=this.removeNonExistingLayoutTables(e.layout,i);n.length>0&&this.SchemaFirebaseService.removeDiagramLayoutTables(e.shortcode,n)}},t.prototype.removeNonExistingLayoutTables=function(e,t){var i=_.keys(e),n=_.filter(i,(function(e){return _.indexOf(t,e)<0}));return _.each(n,(function(t){delete e[t]})),n},t.prototype.metadataConversionNotification=function(e){var t=this;this.isDemoSampleWithoutMeta(e.schema)||(this.localStorageService.get(this.CONVERSION_NOTIFICATION_KEY)?this.ToastService.showInfoWithAction("Diagram format updated","INFO",(function(){return t.showMetadataConversionModal()})):(this.localStorageService.set(this.CONVERSION_NOTIFICATION_KEY,!0),this.showMetadataConversionModal()))},t.prototype.showMetadataConversionModal=function(){var e=this.$mdDialog.alert().title("Notification - Diagram format updated").htmlContent("Due to a system upgrade, the [Settings] and [Layout] sections are no longer<br/>visible. This information is now stored in the background. Your diagram has<br/>been automatically converted to the new format.").ok("Ok").clickOutsideToClose(!0);this.$mdDialog.show(e).finally((function(){e=void 0}))},t.prototype.stripExtraWhitespace=function(e){return _.trim(e.replace(/  +/g," "))},t.prototype.getCurrentShortcode=function(){return this.$state.params.shortcode},t=__decorate([e.Service("QdbdApp.SourceEditor","SourceEditorService")],t)}();e.SourceEditorService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r,a,s){this.$rootScope=e,this.$scope=t,this.$state=i,this.$timeout=n,this.SubscriptionService=o,this.AccountService=r,this.ToastService=a,this.CountryCodesService=s,this.isEditEnabled=!1,this.editForm=!1,this.countryCodes=null,this.SubscriptionService.ensureUserNotSubscribed(),this.initialize()}t.$inject=["$rootScope","$scope","$state","$timeout","SubscriptionService","AccountService","ToastService","CountryCodesService"],t.prototype.initialize=function(){var e=this.SubscriptionService.initializeBillingDetails();this.billingDetails=e,this.countryCodes=this.CountryCodesService.codes,this.billingDetails?this.editForm=!this.billingDetails.firstName||!this.billingDetails.lastName:this.$state.go("root.standardShrinkable.home")},t.prototype.confirmEmail=function(){var e=this;this.AccountService.resendConfirmationEmail(this.$rootScope.currentUser.userId).then((function(){e.ToastService.showInfo("Confirmation email sent"),e.$state.go("root.standard.user.profile",{userId:e.$rootScope.currentUser.userId})}))},t.prototype.confirmBillingDetails=function(){var e,t,i=this;this.billingDetails.country=(null===(e=this.billingDetails)||void 0===e?void 0:e.countryCode)?null===(t=this.CountryCodesService)||void 0===t?void 0:t.codes[this.billingDetails.countryCode]:null,this.SubscriptionService.updateBillingDetails(this.billingDetails).then((function(){i.SubscriptionService.setBillingDetails(i.billingDetails),i.SubscriptionService.cacheVoucherCodeChoice(i.billingDetails.voucherCode),i.$state.go("root.centered.checkout")}),(function(){i.SubscriptionService.cacheVoucherCodeChoice("")}))},t.prototype.back=function(){!this.$rootScope.currentUser.hasIndividualProAccess&&this.SubscriptionService.hasVoucherCode()?this.$state.go("root.standardShrinkable.home"):this.$state.go("root.centered.subscribe")},t=__decorate([e.Controller("QdbdApp.Subscription","BillingDetailsCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r,a,s,d,c){this.$scope=e,this.$rootScope=t,this.$log=i,this.$timeout=n,this.SubscriptionService=o,this.MessageScreenService=r,this.ToastService=a,this.ErrorService=s,this.TrackingService=d,this.$state=c,this.braintreeInitStarted=!1,this.isMethodSelectable=!1,this.isMethodSelected=!1,this.acceptedTerms=!1,this.authorizationInProgress=!1,this.isVoucher=!1,this.SubscriptionService.ensureUserNotSubscribed(),this.initialize(),e.$on("$destroy",this.teardown.bind(this))}t.$inject=["$scope","$rootScope","$log","$timeout","SubscriptionService","MessageScreenService","ToastService","ErrorService","TrackingService","$state"],t.prototype.initialize=function(){var e=this;this.SubscriptionService.getBillingDetails()?this.SubscriptionService.getCheckoutDetails().then((function(t){return e.checkoutDetails=t.data,e.isVoucher="voucher"===e.checkoutDetails.plan,e.SubscriptionService.getToken()})).then((function(t){var i=t.data;i?e.$timeout((function(){e.initializeDropin(i)})):e.showErrorToast()}),(function(t){t.data.errors.discountCode&&t.data.errors.discountCode.length>0?(e.SubscriptionService.clearDiscountCached(),e.ToastService.showError(t.data.errors.discountCode[0]),e.back()):e.showErrorToast()})):this.$state.go("root.centered.billingDetails")},t.prototype.teardown=function(){var e=this;this.$timeout((function(){e.dropInInstance&&e.dropInInstance.teardown((function(){e.$log.info("Braintree checkout teardown complete.")}))}))},t.prototype.initializeDropin=function(e){var t=this;this.braintreeInitStarted=!0,"voucher"!==this.checkoutDetails.plan&&braintree.dropin.create({authorization:e,container:"#dropin-container",paypal:{flow:"vault"},dataCollector:!0,threeDSecure:!0},(function(e,i){t.$timeout((function(){e?(t.ErrorService.logError(e),t.showErrorToast()):t.initializeDropinInstance(i)}))}))},t.prototype.initializeDropinInstance=function(e){var t=this;this.dropInInstance=e,this.isMethodSelected=!!this.getActivePaymentMethod(),this.dropInInstance.on("paymentMethodRequestable",(function(e){t.$timeout((function(){t.isMethodSelectable=t.isPaymentMethodSelectable(e),t.isMethodSelectable?t.isMethodSelected=!1:t.isMethodSelected=!!t.getActivePaymentMethod()}))})),this.dropInInstance.on("noPaymentMethodRequestable",(function(){t.$timeout((function(){t.isMethodSelectable=!1,t.isMethodSelected=!1}))})),this.dropInInstance.on("paymentOptionSelected",(function(){t.$timeout((function(){t.isMethodSelectable=!1,t.isMethodSelected=!1}))}))},t.prototype.isPaymentMethodSelectable=function(e){return e&&!e.paymentMethodIsSelected},t.prototype.getActivePaymentMethod=function(){if(this.dropInInstance&&this.dropInInstance._model&&this.dropInInstance._model._activePaymentMethod)return this.dropInInstance._model._activePaymentMethod},t.prototype.selectPaymentMethod=function(){var e=this;this.dropInInstance.requestPaymentMethod({threeDSecure:this.get3dSecure()},(function(t,i){e.$timeout((function(){t?(e.ErrorService.logError(t),e.showErrorToast()):(e.isMethodSelectable=!1,e.isMethodSelected=!!e.getActivePaymentMethod())}))}))},t.prototype.get3dSecure=function(){var e=this.SubscriptionService.getBillingDetails();return{collectDeviceData:!0,amount:this.checkoutDetails.amountToPay,email:this.$rootScope.currentUser.email,additionalInformation:{ipAddress:this.$rootScope.currentUser.ipAddress},billingAddress:{phoneNumber:e.phoneNumber,givenName:e.firstName,surname:e.lastName,streetAddress:e.address,postalCode:e.postCode,countryCodeAlpha2:e.countryCode}}},t.prototype.authorizePayment=function(){var e=this,t={};if(this.isVoucher)t.voucherCode=this.checkoutDetails.voucherCode;else{var i=this.getActivePaymentMethod();if(!i||!i.nonce)return void this.showErrorToast();t.nonce=i.nonce}t.discountCode=this.SubscriptionService.getCachedDiscountCodeChoice(),this.authorizationInProgress=!0,this.SubscriptionService.subscribe(t).then((function(){e.TrackingService.trackPurchase(e.checkoutDetails.amountToPay,e.checkoutDetails.planCaption.split(" ")[0]),e.SubscriptionService.clearBillingDetails(),e.MessageScreenService.showSuccess({header:"Payment successful!",message:"Thank you! You have successfuly subscribed to QuickDBD."})}),(function(){e.showErrorContactUsPage()}))},t.prototype.showErrorToast=function(){this.ToastService.showError("An error occured, please refresh and try again.")},t.prototype.showErrorContactUsPage=function(){this.MessageScreenService.showError({header:"Payment failed",message:"Sorry, something went wrong during the payment process. Please contact us at info@dovetail.ie and we'll sort it out for you."})},t.prototype.back=function(){this.$state.go("root.centered.billingDetails")},t=__decorate([e.Controller("QdbdApp.Subscription","CheckoutCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(){this.codes={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:'Cote D"Ivoire',HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KP:"North Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:'Lao People"s Democratic Republic',LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States Of",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Vietnam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"}}return t=__decorate([e.Service("QdbdApp.Subscription","CountryCodesService")],t)}();e.CountryCodesService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){this.$rootScope=e,this.$mdDialog=t,this.SubscriptionService=i,this.ToastService=n,this.model={reasonId:"price"},this.reasons={price:{id:"price",reason:"The price is too high",question:"How much would you be willing to pay for it?"},otherProduct:{id:"otherProduct",reason:"I decided to use another product",question:"Could you please share with us which one?"},other:{id:"other",reason:"Other",question:"Could you please tell us why?"},dontNeedIt:{id:"dontNeedIt",reason:"I don't need it anymore",question:"Any additional comments?"},didntWork:{id:"didntWork",reason:"The product did not work as expected",question:"Could you please provide us with some details?"},missingFeatures:{id:"missingFeatures",reason:"Some features that I need are missing",question:"Could you please tell us which ones?"}}}t.$inject=["$rootScope","$mdDialog","SubscriptionService","ToastService"],t.prototype.$onInit=function(){this.model.userId=this.userId},t.prototype.close=function(){this.$mdDialog.cancel()},t.prototype.confirm=function(){var e=this;this.model.reason=this.reasons[this.model.reasonId].reason,this.SubscriptionService.cancelSubscription(this.model).then((function(){e.$rootScope.$broadcast("subscription-cancelled"),e.ToastService.showInfo("Successfully unsubscribed"),e.close()}))},t=__decorate([e.Component("QdbdApp.Subscription","dtCancelSubscription",{bindings:{userId:"@"},templateUrl:"cache/modules/subscription/dt-cancel-subscription/dt-cancel-subscription.html",controllerAs:"DtCancelSubscriptionVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(e){e[e.WeekPass=1]="WeekPass",e[e.Monthly=2]="Monthly",e[e.Annual=3]="Annual",e[e.Voucher=4]="Voucher"}(e.SubscriptionPlan||(e.SubscriptionPlan={}))}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r){var a=this;this.$rootScope=e,this.$state=t,this.AccountService=i,this.SubscriptionService=n,this.SharingService=o,this.MessageScreenService=r,this.$state.current.url.toString().indexOf("voucher")>=0?this.parseVoucherURL():this.$state.current.url.toString().indexOf("discount")>=0?this.parseDiscountURL():this.AccountService.reAuthenticate().then((function(){a.SubscriptionService.ensureUserNotSubscribed(),!a.$rootScope.currentUser.hasIndividualProAccess&&a.SubscriptionService.hasVoucherCode()&&a.selectSubscription("voucher")}))}t.$inject=["$rootScope","$state","AccountService","SubscriptionService","SharingService","MessageScreenService"],t.prototype.parseDiscountURL=function(){var e=this;this.$state.params&&this.$state.params.discountCode&&(this.SubscriptionService.cacheDiscountCodeChoice(this.$state.params.discountCode),this.SubscriptionService.getDiscount().then((function(t){t.data<=0?(e.MessageScreenService.showError({header:"Discount code not found!",message:"Sorry, the discount code <b>"+e.SubscriptionService.getCachedDiscountCodeChoice()+"</b> was not found, please contact the system administrator"}),e.SubscriptionService.clearDiscountCached()):(e.MessageScreenService.showSuccess({header:"Discount code redeemed!",message:"Your discount code <b>"+e.$state.params.discountCode+"</b> is valid. To activate your discount code go pro now!",buttonText:"Subscribe now",redirectRoute:"root.centered.subscribe"}),e.SubscriptionService.cacheDiscountedValue(t.data.toFixed(2)))})))},t.prototype.parseVoucherURL=function(){if(this.$state.params&&this.$state.params.voucherCode){this.SubscriptionService.cacheVoucherCodeChoice(this.$state.params.voucherCode);var e="Thanks for using voucher <b>"+this.$state.params.voucherCode+"</b>. We've made a record of it. When you upgrade to Pro you will be able to redeem the voucher instead of entering payment details. For now, just carry on using QuickDBD.";this.MessageScreenService.showSuccess({header:"Voucher recorded successfully!",message:e})}},t.prototype.redirectIfNotLoggedIn=function(){this.AccountService.isUserLoggedIn()||this.$state.go("root.centered.login")},t.prototype.selectSubscription=function(e){this.SubscriptionService.cacheSubscriptionChoice(e),this.$state.go("root.centered.billingDetails")},t.prototype.tweet=function(){this.SharingService.tweet("@Quick_DBD is giving away free Pro Plans!! Awesome online tool to design databases online. I love it! TWITTER_LOVE_EMOJI ")},t=__decorate([e.Controller("QdbdApp.Subscription","SubscribeCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n,o,r){this.$rootScope=e,this.$http=t,this.localStorageService=i,this.BaseHttpService=n,this.AccountService=o,this.MessageScreenService=r,this.SUBSCRIPTION_PLAN="subscriptionPlan",this.VOUCHER_CODE="voucherCode",this.DISCOUNT_CODE="discountCode",this.DISCOUNTED_VALUE="discountedValue"}return t.$inject=["$rootScope","$http","localStorageService","BaseHttpService","AccountService","MessageScreenService"],t.prototype.ensureUserNotSubscribed=function(){this.$rootScope.currentUser&&this.$rootScope.currentUser.hasActiveIndividualSubscription&&this.MessageScreenService.showError({header:"Subscription exists",message:"You already have an active subscription."})},t.prototype.updateBillingDetails=function(e){var t=this,i=this.BaseHttpService.put("api/v1/payments/updateBillingDetails",e);return i.then((function(){t.AccountService.resolveCurrentUser()})),i},t.prototype.getToken=function(){return this.$http.get("api/v1/payments/token")},t.prototype.subscribe=function(t){var i=this,n=this.getCachedSubscriptionChoice();n=n.charAt(0).toUpperCase()+n.slice(1),t.subscriptionPlan=e.SubscriptionPlan[n];var o=this.$http.post("api/v1/payments/subscribe",t);return o.then((function(){i.AccountService.reAuthenticate(),i.cacheVoucherCodeChoice(""),i.clearDiscountCached()})),o},t.prototype.cancelSubscription=function(e){var t=this,i=this.$http.put("api/v1/payments/cancelSubscription",e);return i.then((function(){t.AccountService.reAuthenticate()})),i},t.prototype.getUserPayments=function(e){return this.$http.get("api/v1/payments/getUserPayments/"+e)},t.prototype.initializeBillingDetails=function(){return this.$rootScope.currentUser?(this.billingDetails={emailConfirmed:this.$rootScope.currentUser.emailConfirmed,firstName:this.$rootScope.currentUser.firstName,lastName:this.$rootScope.currentUser.lastName,voucherCode:this.getCachedVoucherCodeChoice(),isVoucher:"voucher"===this.getCachedSubscriptionChoice(),address:"",postCode:"",country:"",countryCode:"",phoneNumber:""},this.billingDetails):null},t.prototype.getBillingDetails=function(){return this.billingDetails},t.prototype.setBillingDetails=function(e){this.billingDetails=e},t.prototype.clearBillingDetails=function(){this.billingDetails=null},t.prototype.cacheSubscriptionChoice=function(e){this.localStorageService.set(this.SUBSCRIPTION_PLAN,e)},t.prototype.getCachedSubscriptionChoice=function(){return this.localStorageService.get(this.SUBSCRIPTION_PLAN)},t.prototype.cacheVoucherCodeChoice=function(e){this.localStorageService.set(this.VOUCHER_CODE,e)},t.prototype.cacheDiscountCodeChoice=function(e){this.localStorageService.set(this.DISCOUNT_CODE,e)},t.prototype.clearDiscountCached=function(){this.cacheDiscountCodeChoice(""),this.cacheDiscountedValue("")},t.prototype.getCachedVoucherCodeChoice=function(){return this.localStorageService.get(this.VOUCHER_CODE)},t.prototype.getCachedDiscountCodeChoice=function(){return this.localStorageService.get(this.DISCOUNT_CODE)},t.prototype.getCheckoutDetails=function(){var e=this.getCachedSubscriptionChoice(),t=this.getCachedVoucherCodeChoice(),i=this.getCachedDiscountCodeChoice();return null!=t&&""!==t||(t=e),null!=i&&""!==i||(i=e),this.$http.get("api/v1/payments/checkoutDetails/"+e+"/"+t+"/"+i)},t.prototype.grantProAccess=function(e,t){return this.$http.post("api/v1/users/grantProAccess",{userId:e,grantType:t})},t.prototype.removeSubscription=function(e){return this.$http.post("api/v1/users/removeSubscription/"+e,null)},t.prototype.hasVoucherCode=function(){return!!this.getCachedVoucherCodeChoice()},t.prototype.getDiscount=function(){return this.$http.get("api/v1/payments/getDiscountedValue/"+this.getCachedDiscountCodeChoice(),null)},t.prototype.hasDiscountId=function(){return!!this.getCachedDiscountCodeChoice()},t.prototype.getCachedDiscountedValue=function(){return this.localStorageService.get(this.DISCOUNTED_VALUE)},t.prototype.cacheDiscountedValue=function(e){this.localStorageService.set(this.DISCOUNTED_VALUE,e)},t=__decorate([e.Service("QdbdApp.Subscription","SubscriptionService")],t)}();e.SubscriptionService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i){this.$scope=e,this.SchemaService=t,this.PagingService=i,this.diagrams={}}t.$inject=["$scope","SchemaService","PagingService"],t.prototype.$onInit=function(){this.pager=this.PagingService.pagerFactory(this.filter,this.diagrams,this.getUserDiagrams.bind(this),"root.standard.user.diagrams"),this.$scope.$watch("DtUserDiagramsVM.filter",this.pager.onFilterChanged.bind(this),!0)},t.prototype.getUserDiagrams=function(){var e=this;this.SchemaService.filterUserDiagrams(this.filter).then((function(t){_.extend(e.diagrams,t.data)}))},t=__decorate([e.Component("QdbdApp.SourceEditor","dtUserDiagrams",{bindings:{filter:"="},templateUrl:"cache/modules/user/dt-user-diagrams/dt-user-diagrams.html",controllerAs:"DtUserDiagramsVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){this.$scope=e,this.UserService=t,this.ToastService=i,this.PagingService=n,this.users={}}t.$inject=["$scope","UserService","ToastService","PagingService"],t.prototype.$onInit=function(){this.pager=this.PagingService.pagerFactory(this.filter,this.users,this.loadUsers.bind(this),"root.standard.admin.userList"),this.$scope.$watch("DtUserListVM.filter",this.pager.onFilterChanged.bind(this),!0)},t.prototype.loadUsers=function(){var e=this;this.UserService.filterUsers(this.filter).then((function(t){_.extend(e.users,t.data)}))},t=__decorate([e.Component("QdbdApp.User","dtUserList",{bindings:{filter:"="},templateUrl:"cache/modules/user/dt-user-list/dt-user-list.html",controllerAs:"DtUserListVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e){this.SubscriptionService=e}t.$inject=["SubscriptionService"],t.prototype.$onInit=function(){this.getUserPayments()},t.prototype.getUserPayments=function(){var e=this;this.SubscriptionService.getUserPayments(this.userId).then((function(t){e.payments=t.data}))},t=__decorate([e.Component("QdbdApp.User","dtUserPayments",{bindings:{userId:"="},templateUrl:"cache/modules/user/dt-user-payments/dt-user-payments.html",controllerAs:"DtUserPaymentsVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r,a){this.$rootScope=e,this.$mdDialog=t,this.$state=i,this.AccountService=n,this.UserService=o,this.SubscriptionService=r,this.ToastService=a}t.$inject=["$rootScope","$mdDialog","$state","AccountService","UserService","SubscriptionService","ToastService"],t.prototype.$onInit=function(){this.initializeFilter()},t.prototype.cancelSubscription=function(){this.$mdDialog.show({template:"\n          <md-dialog aria-label='Cancel Subscription' class='modal-dialog'>\n            <dt-cancel-subscription user-id=\""+this.userProfile.userId+'"></dt-cancel-subscription>\n          </md-dialog>\n        ',parent:angular.element(document.body),clickOutsideToClose:!0})},t.prototype.confirmEmail=function(){var e=this;this.AccountService.resendConfirmationEmail(this.userProfile.userId).then((function(){e.ToastService.showInfo("Confirmation email sent")}))},t.prototype.initializeFilter=function(){this.filter={page:1,pageSize:5,sortBy:"name",userId:this.userProfile?this.userProfile.userId:null}},t.prototype.grantProAccess=function(e){var t=this,i=this.$mdDialog.confirm().title("Grant Pro Access").htmlContent("Are you sure you want to give this user pro access?").ok("Yes").cancel("No").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.SubscriptionService.grantProAccess(t.userProfile.userId,e).then((function(){t.ToastService.showInfo("Pro access granted"),t.initializeUser&&t.initializeUser(),t.AccountService.reAuthenticateIfCurrentUser(t.userProfile.userId)}))}))},t.prototype.removeSubscription=function(){var e=this,t=this.$mdDialog.confirm().title("Remove subscription").htmlContent("Are you sure you want to remove this user's subscription?").ok("Yes").cancel("No").clickOutsideToClose(!0);this.$mdDialog.show(t).then((function(){e.SubscriptionService.removeSubscription(e.userProfile.userId).then((function(){e.ToastService.showInfo("Subscription removed"),e.initializeUser&&e.initializeUser(),e.AccountService.reAuthenticateIfCurrentUser(e.userProfile.userId)}))}))},t.prototype.flipCollab=function(e){var t=this,i=this.$mdDialog.confirm().title("Collab status change").htmlContent("Are you sure you want to change the collab status for this user?").ok("Yes").cancel("No").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.UserService.flipCollab(e).then((function(){t.initializeUser(),t.ToastService.showInfo("Collab status changed")}))}))},t.prototype.deleteUser=function(e){var t=this,i=this.$mdDialog.confirm().title("WARNING - Account Deletion").htmlContent("This is a destructive action. Your account will be removed and you will no longer have access to it. <br /><br />All diagrams associated with this account will be lost. This operation is irreversible. <br /><br />Are you sure you want to proceed? ").ok("Yes, DELETE my account").cancel("Cancel").clickOutsideToClose(!0);this.$mdDialog.show(i).then((function(){t.UserService.deleteUser(e).then((function(){t.ToastService.showInfo("Account Deleted"),t.$rootScope.currentUser.userId===e?t.AccountService.logout():t.$state.go("root.standard.admin.userList")}))}))},t=__decorate([e.Component("QdbdApp.User","dtUserProfile",{bindings:{userProfile:"=",initializeUser:"&"},templateUrl:"cache/modules/user/dt-user-profile/dt-user-profile.html",controllerAs:"DtUserProfileVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){var o=this;this.$scope=e,this.$state=t,this.UserService=i,this.ProAccessGrantLogService=n,this.initializeUser(),this.$scope.$on("subscription-cancelled",(function(){o.initializeUser()}))}t.$inject=["$scope","$state","UserService","ProAccessGrantLogService"],t.prototype.initializeUser=function(){var e=this.$state.params.userId;e?this.UserService.getUserProfile(e).then(this.onProfileFetched.bind(this),this.onProfileFetchError.bind(this)):this.UserService.getCurrentUserProfile().then(this.onProfileFetched.bind(this),this.onProfileFetchError.bind(this))},t.prototype.onOrgProfileFetched=function(e){var t=this;this.userProfile=e.data||null,this.ProAccessGrantLogService.getLatestRowForUser(this.userProfile.email).then((function(e){t.latestSubscriptionLog=e.data}),(function(){t.latestSubscriptionLog=null}))},t.prototype.onProfileFetched=function(e){this.userProfile=e.data||null},t.prototype.onProfileFetchError=function(){this.userProfile=null},t=__decorate([e.Controller("QdbdApp.User","ProfileCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){this.$rootScope=e,this.$state=t,this.$timeout=i,this.TrackingService=n,this.setupRoutes(),this.handleRouting(),this.initializeFilter()}t.$inject=["$rootScope","$state","$timeout","TrackingService"],t.prototype.setupRoutes=function(){var e=this;this.userId=this.$state.params.userId,this.routes=[{caption:"Profile",name:"root.standard.user.profile"},{caption:"Diagrams",name:"root.standard.user.diagrams"},{caption:"Payments",name:"root.standard.user.payments"}],this.$timeout((function(){e.selectedTab=_.findIndex(e.routes,{name:e.$state.current.name})}))},t.prototype.handleRouting=function(){this.$state.is("root.standard.user")&&this.$state.go("root.standard.user.profile",{userId:this.$rootScope.currentUser.userId})},t.prototype.initializeFilter=function(){this.filter={page:this.$state.params.page||1,pageSize:this.$state.params.pageSize||20,userId:this.$state.params.userId||this.userId,search:this.$state.params.search,sortBy:this.$state.params.sortBy||"id",sortOrder:this.$state.params.sortOrder}},t.prototype.loadRoute=function(e){var t={userId:this.userId},i="root.standard.user.diagrams"===e?_.extend(t,this.filter):t;this.$state.go(e,i);var n="";switch(e.toLowerCase()){case"root.standard.user.diagrams":n="Diagram";break;case"root.standard.user.payments":n="Payments";break;default:n="Profile"}this.TrackingService.trackAccount(n)},t=__decorate([e.Controller("QdbdApp.User","UserCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e){this.$http=e}return t.$inject=["$http"],t.prototype.filterUsers=function(e){return this.$http.get("api/v1/users/filter",{params:e})},t.prototype.getUserProfile=function(e){return this.$http.get("api/v1/users/profile/"+e)},t.prototype.getCurrentUserProfile=function(){return this.$http.get("api/v1/users/profile")},t.prototype.flipCollab=function(e){return this.$http.put("api/v1/users/flipCollab/"+e,void 0)},t.prototype.deleteUser=function(e){return this.$http.delete("api/v1/users/"+e)},t=__decorate([e.Service("QdbdApp.User","UserService")],t)}();e.UserService=t}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n,o,r,a){this.$scope=e,this.VoucherService=t,this.$state=i,this.PagingService=n,this.ToastService=o,this.$window=r,this.$location=a,this.vouchers={}}t.$inject=["$scope","VoucherService","$state","PagingService","ToastService","$window","$location"],t.prototype.$onInit=function(){this.pager=this.PagingService.pagerFactory(this.filter,this.vouchers,this.loadVouchers.bind(this),"root.standard.admin.vouchersList"),this.$scope.$watch("DtVoucherListVM.filter",this.pager.onFilterChanged.bind(this),!0)},t.prototype.loadVouchers=function(){var e=this;this.VoucherService.filterVoucher(this.filter).then((function(t){_.extend(e.vouchers,t.data)}))},t.prototype.addNewVoucher=function(){this.$state.go("root.standard.admin.voucher")},t.prototype.editNewVoucher=function(e){this.$state.go("root.standard.admin.voucher",{voucher:e})},t.prototype.copyVoucherUrl=function(e){this.VoucherService.copyVoucherUrl(e)},t=__decorate([e.Component("QdbdApp.Voucher","dtVoucherList",{bindings:{filter:"="},templateUrl:"cache/modules/voucher/dt-voucher-list/dt-voucher-list.html",controllerAs:"DtVoucherListVM"})],t)}()}(QdbdApp||(QdbdApp={})),function(e){!function(){function t(e,t,i,n){this.$state=e,this.$scope=t,this.VoucherService=i,this.ToastService=n,this.voucher={},this.isEdit=!1;var o=this.$state.params.voucher;null===o?(this.voucher.maxRedemptions=1,this.voucher.valueInWeeks=4,this.voucher.minDate=new Date,this.voucher.validFrom=new Date,this.voucher.validFrom.setHours(0,0,0,0),this.isEdit=!1):(this.voucher=o,this.voucher.validFrom=this.voucher.validFrom?new Date(this.voucher.validFrom.toString()):this.voucher.validFrom,this.voucher.validTo=this.voucher.validTo?new Date(this.voucher.validTo.toString()):this.voucher.validTo,this.voucher.validFrom&&this.voucher.validFrom.setHours(0,0,0,0),this.voucher.validTo&&this.voucher.validTo.setHours(0,0,0,0),this.voucher.minDate=this.voucher.validFrom?_.min([this.voucher.validFrom,new Date]):new Date,this.isEdit=!0)}t.$inject=["$state","$scope","VoucherService","ToastService"],t.prototype.back=function(){this.$state.go("root.standard.admin.vouchersList")},t.prototype.save=function(){var e=this;this.VoucherService.save(this.voucher).then((function(){e.ToastService.showInfo("Voucher saved successfully."),e.back()}),(function(t){e.voucher.errors=t.data.errors,e.voucher.validationSummary=t.data.validationSummary,t.data&&t.data.error_description&&(e.voucher.errors={},e.voucher.validationSummary=[t.data.error_description])}))},t.prototype.setDefaultPeriod=function(e){switch(e){case"week":this.voucher.validFrom=new Date,this.voucher.validTo=new Date,this.voucher.validTo.setDate(this.voucher.validTo.getDate()+7);break;case"month":this.voucher.validFrom=new Date,this.voucher.validTo=new Date,this.voucher.validTo.setMonth(this.voucher.validTo.getMonth()+1);break;default:this.voucher.validFrom=new Date,this.voucher.validTo=new Date,this.voucher.validTo.setFullYear(this.voucher.validTo.getFullYear()+1)}this.voucher.validFrom.setHours(0,0,0,0),this.voucher.validTo.setHours(0,0,0,0)},t.prototype.copyVoucherUrl=function(e){this.VoucherService.copyVoucherUrl(e)},t=__decorate([e.Controller("QdbdApp.Voucher","VoucherCtrl")],t)}()}(QdbdApp||(QdbdApp={})),function(e){var t=function(){function t(e,t,i,n){this.$http=e,this.ToastService=t,this.$window=i,this.$location=n}return t.$inject=["$http","ToastService","$window","$location"],t.prototype.filterVoucher=function(e){return this.$http.get("api/v1/payments/filterVouchers",{params:e})},t.prototype.save=function(e){return this.$http.post("api/v1/payments/saveVoucher",e)},t.prototype.copyVoucherUrl=function(e){var t=angular.element(this.$window.document.body),i=angular.element("<textarea/>");try{var n=this.$location.absUrl().substr(0,this.$location.absUrl().indexOf("#")+1)+"/voucher/"+e.code;i.val(n),t.append(i),i.select(),document.execCommand("copy")&&this.ToastService.showInfo("Copied to clipboard.")}finally{i.remove()}},t=__decorate([e.Service("QdbdApp.Voucher","VoucherService")],t)}();e.VoucherService=t}(QdbdApp||(QdbdApp={})),angular.module("QdbdApp.Common").run(["$templateCache",function(e){e.put("cache/modules/admin/admin.html",'<div ng-controller="AdminCtrl as AdminVM" flex class="tabbed-layout">\n  <md-tabs class="md-primary" md-selected="AdminVM.selectedTab">\n    <md-tab ng-repeat="route in AdminVM.routes" label="{{route.caption}}" ng-click="AdminVM.loadRoute(route.name)"></md-tab>\n  </md-tabs>\n  <div layout="row">\n    <div id="admin-content" class="tabbed-content" ui-view="admin-content"></div>\n    <div flex></div>\n  </div>\n</div>'),e.put("cache/modules/collaborators/dt-collaborators.html",'<md-toolbar>\n  <div class="md-toolbar-tools">\n    <h2>Collaborators</h2>\n    <span flex></span>\n    <md-button class="md-icon-button" ng-click="DtCollaboratorsVM.closeDialog()">\n      <md-icon class="mdi mdi-close" aria-label="Close dialog"></md-icon>\n    </md-button>\n  </div>\n</md-toolbar>\n<md-dialog-content>\n  <md-content class="md-padding">\n      <div layout="row">\n        <div flex-gt-xs="90" class="left-column">\n          <dt-input-text model="DtCollaboratorsVM.model" property-name="email" label="E-mail address" input-type="email"></dt-input-text>\n        </div>\n        <div flex-gt-xs="10" class="right-column">\n          <md-button class="input-icon-button" href="" ng-click="DtCollaboratorsVM.addCollaborator($event)">\n            <md-tooltip md-direction="bottom" md-z-index="1000">Add collaborator</md-tooltip>\n            <md-icon class="mdi mdi-account-plus"></md-icon>\n          </md-button>\n        </div>\n      </div>\n      <div>\n        <div ng-if="!DtCollaboratorsVM.collaborators || DtCollaboratorsVM.collaborators.length <= 0">\n          <p>There is no collaborator to this {{DtCollaboratorsVM.collabType === "folder" ? "folder" : "diagram" }}</p>\n        </div>\n        <div class="dialog-table-wrap" ng-if="DtCollaboratorsVM.collaborators && DtCollaboratorsVM.collaborators.length > 0">\n          <table class="dialog-table collaborators">\n            <tbody>\n              <tr ng-repeat="collab in DtCollaboratorsVM.collaborators">\n                <td class="dialog-table-auto-fit-column dialog-table-icon-left-column" ng-if="!collab.isFolderPermission"><md-icon class="mdi mdi-file-outline"></md-icon></td>\n                <td class="dialog-table-auto-fit-column dialog-table-icon-left-column" ng-if="collab.isFolderPermission"><md-icon class="mdi mdi-folder-multiple"></md-icon></td>\n                <td>{{collab.email}}</td>\n                <td class="dialog-table-auto-fit-column">\n                  <span class="label-dialog" ng-class="{ accepted: collab.isAccepted }">\n                    {{collab.isAccepted ? "Accepted" : "Pending"}}\n                  </span>\n                </td>\n                <td class="dialog-table-auto-fit-column" ng-if="DtCollaboratorsVM.isOwnedByCurrentUser">\n                  <md-button class="md-collab-button" href="" ng-click="DtCollaboratorsVM.removeCollaborator($event, collab)">\n                    <md-tooltip md-direction="right" md-z-index="1000">Remove collaborator</md-tooltip>\n                    <md-icon class="mdi mdi-account-remove"></md-icon>\n                  </md-button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n  </md-content>\n</md-dialog-content>\n'),e.put("cache/modules/diagram-folder/dt-diagram-folder.html",'<div>\n  <div class="folder-tabs">\n    <md-tabs class="md-primary" md-selected="DtDiagramFolderVM.tabIndex" flex layout="column" md-stretch-tabs="always">\n      <md-tab label="My Diagrams" ng-click="DtDiagramFolderVM.getFlatTree(route.name)" flex></md-tab>\n      <md-tab label="Shared With Me" ng-click="DtDiagramFolderVM.getSharedFlatTree(route.name)" flex></md-tab>\n    </md-tabs>\n  </div>\n  <div ng-if="$root.currentUser && DtDiagramFolderVM.folderTree && !DtDiagramFolderVM.folderTreeState.showSharedDiagrams">\n    <md-button aria-label="New Folder" class="new-folder-button" ng-click="DtDiagramFolderVM.addFolder()">\n      <md-icon class="mdi mdi-folder-plus"></md-icon>\n      New Folder\n    </md-button>\n  </div>\n  <md-list ng-if="$root.currentUser" class="folder-tree-items" ng-class="{ \'shared\': DtDiagramFolderVM.folderTreeState.showSharedDiagrams }">\n    <md-list-item ng-repeat="treeItem in DtDiagramFolderVM.folderTree" ng-click="DtDiagramFolderVM.onTreeItemClick(treeItem)" ng-if="treeItem.itemType === \'folder\' || treeItem.isExpanded" ng-class="{ closed: treeItem.itemType === \'folder\' && !treeItem.isExpanded,\n                              selected: DtDiagramFolderVM.isSelected(treeItem.shortcode),\n                              folder: treeItem.itemType === \'folder\',\n                              schema: treeItem.itemType === \'diagram\',\n                              locked: DtDiagramFolderVM.isLocked(treeItem),\n                              \'non-drag\':  (treeItem.itemType === \'diagram\' && !treeItem.isOwnedByCurrentUser) || treeItem.itemType === \'empty-folder-holder\' }" class="folder-tree-item" ng-attr-is-droppable-folder="{{treeItem.itemType === \'folder\' && treeItem.id >= 0}}" ng-attr-item-id="{{treeItem.id}}" on-drag-enter="DtDiagramFolderVM.onDragEnter()" on-drag-leave="DtDiagramFolderVM.onDragLeave()" on-drop="DtDiagramFolderVM.onDrop()" html5-drop>\n      <md-icon ng-if="treeItem.itemType === \'diagram\' && treeItem.parentId !== -1 && treeItem.isOwnedByCurrentUser" class="mdi mdi-drag-vertical tree-icon file-icon" aria-label="Reorder" drag-data="treeItem" on-drop="DtDiagramFolderVM.onDrop()" ng-click="$event.stopPropagation()" html5-drag></md-icon>\n      <md-icon ng-if="treeItem.itemType === \'folder\'" class="folder-action mdi folder-icon" ng-class="DtDiagramFolderVM.getFolderIconClass(treeItem)" aria-label="Folder Actions" on-drop="DtDiagramFolderVM.onDrop()" ng-click="DtDiagramFolderVM.onTreeItemClick(treeItem); $event.stopPropagation()"></md-icon>\n      <md-icon ng-if="treeItem.itemType === \'new-diagram-holder\'" class="mdi mdi-plus new-tree-file-icon" aria-label="New File" on-drop="DtDiagramFolderVM.onDrop()"></md-icon>\n      <p class="tree-item-name" ng-class="{ \'diagram-folder-item\': treeItem.itemType !== \'diagram\', \'no-icon\': treeItem.parentId === -1 }">\n        {{treeItem.name || \'NAME NOT SET\'}}\n      </p>\n      <md-icon class="mdi mdi-lock-outline tree-info-icon" ui-sref="{{ treeItem.isOwnedByCurrentUser ? \'root.centered.subscribe\' : null }}" ng-if="DtDiagramFolderVM.isLocked(treeItem)">\n        <md-tooltip md-direction="bottom" ng-if="treeItem.isOwnedByCurrentUser">Subscribe to edit this diagram</md-tooltip>\n        <md-tooltip md-direction="bottom" ng-if="!treeItem.isOwnedByCurrentUser && !treeItem.isOrganizationOwned">Diagram owner does not have an active subscription</md-tooltip>\n        <md-tooltip md-direction="bottom" ng-if="treeItem.isOrganizationOwned">You don\'t have Organization Pro access</md-tooltip>\n      </md-icon>\n      <md-icon class="mdi mdi-new-box tree-info-icon" ng-if="treeItem.isPending">\n        <md-tooltip md-direction="bottom">Newly shared with you</md-tooltip>\n      </md-icon>\n      <md-menu class="md-secondary" ng-if="treeItem.itemType !== \'new-diagram-holder\'" ng-hide="DtDiagramFolderVM.shouldHideItemMenu(treeItem)">\n        <md-icon class="mdi mdi-dots-vertical tree-icon" ng-click="$mdMenu.open($event)"></md-icon>\n        <md-menu-content width="3">\n          <md-menu-item ng-if="treeItem.itemType === \'folder\' && (treeItem.isOwnedByCurrentUser || treeItem.isOrganizationOwned)">\n            <md-button aria-label="Add File" ng-click="DtDiagramFolderVM.addDiagram(treeItem)">\n              Add File\n            </md-button>\n          </md-menu-item>\n          <md-menu-item ng-if="(treeItem.itemType === \'folder\' && !treeItem.isDefaultFolder && (treeItem.isOwnedByCurrentUser || $root.currentUser.isOrganizationAdmin)) || treeItem.itemType === \'diagram\'">\n            <md-button aria-label="Rename" ng-click="DtDiagramFolderVM.renameItem(treeItem)">\n              Rename\n            </md-button>\n          </md-menu-item>\n          <md-menu-item ng-if="treeItem.id && !treeItem.isOrganizationOwned">\n            <md-button aria-label="Collaborate" ng-click="DtDiagramFolderVM.collaborate(treeItem)">\n              Collaborate\n            </md-button>\n          </md-menu-item>\n          <md-menu-item ng-if="treeItem.id && treeItem.isOrganizationOwned && $root.currentUser.isOrganizationAdmin">\n            <md-button aria-label="Collaborate" ng-click="DtDiagramFolderVM.manageAccess(treeItem)">\n              Manage Access\n            </md-button>\n          </md-menu-item>\n          <md-menu-item ng-if="treeItem.isOwnedByCurrentUser && (treeItem.itemType === \'diagram\' || !treeItem.isDefaultFolder) || ($root.currentUser.isOrganizationAdmin && treeItem.isOrganizationOwned)">\n            <md-button aria-label="Delete" ng-click="DtDiagramFolderVM.deleteItem(treeItem)">\n              Delete\n            </md-button>\n          </md-menu-item>\n          <md-menu-item ng-if="!treeItem.isOwnedByCurrentUser && !treeItem.isOrganizationOwned && treeItem.collabPermissionId">\n            <md-button aria-label="Leave" ng-click="DtDiagramFolderVM.leaveCollab(treeItem)">\n              Leave\n            </md-button>\n          </md-menu-item>\n        </md-menu-content>\n      </md-menu>\n    </md-list-item>\n  </md-list>\n  <div class="long-required" ng-if="!$root.currentUser">\n    <a ui-sref="root.centered.login">Login</a> or <a ui-sref="root.centered.register">register</a> to access your files.\n  </div>\n</div>'),e.put("cache/modules/diagram-renderer/dt-diagram-renderer.html",'<div id="renderer-container" flex class="tour-overlay-container">\n  <div id="dragger" layout="column">\n    \x3c!-- This is the dragger for resizing the editor on the left side --\x3e\n    <div class="dragger-top" flex></div>\n    <div class="dragger-handle first">\n      <div class="dragger-handle second">\n        <div class="dragger-handle third"></div>\n      </div>\n    </div>\n    <div flex></div>\n  </div>\n\n  <div class="tour-overlay renderer-overlay"></div>\n  <div class="canvas" ng-if="!DtDiagramRendererVM.isUnsupportedBrowser"></div>\n  <div class="unsupported" ng-if="DtDiagramRendererVM.isUnsupportedBrowser">\n    <span>\n      Sorry - you are using an unsupported browser and we cannot draw your diagram. We suggest using Chrome, Brave, Opera or Firefox.<br><br>\n      If this is a major problem for you, please <a href="https://twitter.com/quick_dbd">contact us</a>. Thanks.\n    </span>\n  </div>\n\n\n  <div ng-if="DtDiagramRendererVM.diagram.viewport.zoom && !DtDiagramRendererVM.isUnsupportedBrowser">\n    <md-button aria-label="Center" class="md-mini md-icon-button zoom canvas-center" ng-click="DtDiagramRendererVM.centerDiagram()">\n      <md-tooltip md-direction="below">Center</md-tooltip>\n      <md-icon class="mdi mdi-crosshairs-gps"></md-icon>\n    </md-button>\n\n\n    <md-button aria-label="Zoom In" class="md-mini md-icon-button zoom zoom-in" ng-click="DtDiagramRendererVM.zoomIn()" ng-disabled="DtDiagramRendererVM.diagram.viewport.zoom == 200">\n      <md-tooltip md-direction="below">Zoom In</md-tooltip>\n      <md-icon class="mdi mdi-plus"></md-icon>\n    </md-button>\n\n\n    <md-menu md-position-mode="target-right bottom">\n      <a>\n        <md-button aria-label="{{DtDiagramRendererVM.diagram.viewport.zoom}}% Zoom" class="md-mini md-icon-button zoom zoom-default" ng-click="$mdMenu.open($event)">\n          <md-tooltip md-direction="below">Set Zoom Level</md-tooltip>\n          <span>{{DtDiagramRendererVM.diagram.viewport.zoom}}%</span>\n        </md-button>\n      </a>\n      <md-menu-content width="2">\n        <md-menu-item ng-repeat="zoomLevel in [10, 50, 100, 150, 200]">\n          <md-button ng-click="DtDiagramRendererVM.setZoom(zoomLevel)">\n            <div layout="row" flex>\n              <p class="zoom-level" flex>{{zoomLevel}}%</p>\n            </div>\n          </md-button>\n        </md-menu-item>\n      </md-menu-content>\n    </md-menu>\n\n\n    <md-button aria-label="Zoom Out" class="md-mini md-icon-button zoom zoom-out" ng-click="DtDiagramRendererVM.zoomOut()" ng-disabled="DtDiagramRendererVM.diagram.viewport.zoom == 10">\n      <md-tooltip md-direction="below">Zoom Out</md-tooltip>\n      <md-icon class="mdi mdi-minus"></md-icon>\n    </md-button>\n  </div>\n</div>'),e.put("cache/modules/home/home.html",'<div layout="row" flex ng-controller="HomeCtrl as HomeVM">\n  <dt-source-editor ng-show="!HomeVM.folderTreeState.isOpen" ng-style="{ width: HomeVM.editorSize.x + \'%\' }" layout="column" hide-xs></dt-source-editor>\n  <dt-diagram-folder ng-if="HomeVM.folderTreeState.isOpen" ng-style="{ width: HomeVM.editorSize.x + \'%\' }" class="folder-tree-container" layout="column" hide-xs></dt-diagram-folder>\n  <dt-diagram-renderer layout="column" flex></dt-diagram-renderer>\n\n  <md-sidenav flex="18" class="md-sidenav-right" md-is-locked-open="true" ng-if="HomeVM.rightSidenav.isOpen">\n    <dt-docs></dt-docs>\n  </md-sidenav>\n</div>'),e.put("cache/modules/login/login.html",'<div ng-controller="LoginCtrl as LoginVM" layout="column" flex>\n  <md-card class="md-card-box centered-card-box login-box" layout="column" flex="none" layout-gt-sm="row">\n    <div class="regular-login" flex-gt-sm="50">\n      <md-card-title class="card-box-title">\n        <md-card-title-text>\n          <span class="md-headline">Sign In</span>\n        </md-card-title-text>\n      </md-card-title>\n\n      <md-card-content>\n        <dt-validation-summary model="LoginVM.credentials"></dt-validation-summary>\n\n        <form class="md-card-form" novalidate>\n          <div class="auth-row first-row">\n            <dt-input-text model="LoginVM.credentials" property-name="email" label="E-mail address" input-type="email"></dt-input-text>\n          </div>\n          <div class="auth-row second-row">\n            <dt-input-password model="LoginVM.credentials" property-name="password" label="Password" class="auth-row"></dt-input-password>\n          </div>\n          <div class="auth-row third-row" layout="row" layout-align="end start">\n            <a ui-sref="root.centered.forgotPassword" class="auth-href">Forgot password?</a>\n          </div>\n          <div class="auth-row fourth-row" layout="row">\n            <md-button type="submit" class="md-raised md-primary" flex ng-click="LoginVM.login()">Sign In</md-button>\n          </div>\n        </form>\n      </md-card-content>\n\n      <md-card-actions class="md-card-action" layout="row">\n        Don\'t have an account? &nbsp;&nbsp;<a ui-sref="root.centered.register" class="auth-href">Sign Up</a>\n      </md-card-actions>\n    </div>\n\n    <div flex-gt-sm="50">\n      <md-card-title class="card-box-title">\n        <md-card-title-text>\n          <span class="md-headline">Social Sign In</span>\n        </md-card-title-text>\n      </md-card-title>\n\n      <md-card-content>\n        <div class="auth-row" layout="row">\n          <md-button class="md-raised google-button" flex ng-click="LoginVM.authenticate(\'google\')">\n            <span class="social-button-wrapper" layout="row">\n              <img src="/images/google-logo.png">\n              <span flex layout="row" layout-align="start center">Sign in with Google</span>\n            </span>\n          </md-button>\n        </div>\n\n        <div class="auth-row" layout="row">\n          <md-button class="md-raised github-button" flex ng-click="LoginVM.authenticate(\'github\')">\n            <span class="social-button-wrapper" layout="row">\n              <md-icon class="mdi mdi-github-circle"></md-icon>\n              <span flex layout="row" layout-align="start center">Sign in with GitHub</span>\n            </span>\n          </md-button>\n        </div>\n      </md-card-content>\n    </div>\n  </md-card>\n  <div flex></div>\n</div>\n'),e.put("cache/modules/message-screen/message-screen.html",'<div layout="column" ng-controller="MessageScreenCtrl as MessageScreenVM">\n  <div flex="5"></div>\n  <md-card class="md-card-box-message">\n    <md-card-title class="card-box-title">\n      <md-card-title-text>\n        <span class="md-headline">{{MessageScreenVM.message.header}}</span>\n        <span class="md-subhead" ng-bind-html="MessageScreenVM.message.message"></span>\n      </md-card-title-text>\n    </md-card-title>\n    <md-card-content>\n      <form class="md-card-form">\n        <div layout="row">\n          <md-button type="submit" class="md-raised no-left-margin" ui-sref="{{MessageScreenVM.message.redirectRoute}}">{{MessageScreenVM.message.buttonText}}</md-button>\n        </div>\n      </form>\n    </md-card-content>\n  </md-card>\n  <div flex></div>\n</div>'),e.put("cache/modules/organization/accept-organization-invite.html",'<div ng-controller="AcceptOrganizationInviteCtrl as AcceptOrganizationInviteVM" flex>\n    <div class="single-page-main-content">\n        We\'re updating your account, please wait...\n    </div>\n</div>'),e.put("cache/modules/organization/organization-admin.html",'<div ng-controller="OrgAdminCtrl as AdminVM" flex class="tabbed-layout">\n    <md-tabs class="md-primary" md-selected="AdminVM.selectedTab">\n        <md-tab ng-repeat="route in AdminVM.routes" label="{{route.caption}}" ng-click="AdminVM.loadRoute(route.name)"></md-tab>\n    </md-tabs>\n    <div layout="row">\n        <div id="admin-content" class="tabbed-content" ui-view="admin-content"></div>\n        <div flex></div>\n    </div>\n</div>'),e.put("cache/modules/register/change-email.html",'<div ng-controller="ChangeEmailCtrl as ChangeEmailVM">\n  <md-card class="md-card-box centered-card-box">\n    <md-card-title class="card-box-title">\n      <md-card-title-text>\n        <span class="md-headline">Change E-mail</span>\n      </md-card-title-text>\n    </md-card-title>\n\n    <md-card-content>\n      <dt-validation-summary model="ChangeEmailVM.changeEmailModel"></dt-validation-summary>\n\n      <form class="md-card-form" novalidate>\n        <div class="auth-row second-row">\n          <dt-input-text model="ChangeEmailVM.changeEmailModel" property-name="newEmail" label="New e-mail address" input-type="email"></dt-input-text>\n        </div>\n\n        <div layout="row">\n          <md-button type="submit" class="md-raised md-primary" ng-click="ChangeEmailVM.changeEmail()" flex>Change E-mail</md-button>\n        </div>\n      </form>\n    </md-card-content>\n\n    <md-card-actions class="md-card-action" layout="row" layout-align="center center">\n      <a ui-sref="root.standard.user.profile({ userId: $root.currentUser.userId })" class="auth-href">Back</a>\n    </md-card-actions>\n  </md-card>\n  <div flex></div>\n</div>'),e.put("cache/modules/register/change-password.html",'<div ng-controller="ChangePasswordCtrl as ChangePasswordVM">\n  <md-card class="md-card-box centered-card-box">\n    <md-card-title class="card-box-title">\n      <md-card-title-text>\n        <span class="md-headline">Change Password</span>\n      </md-card-title-text>\n    </md-card-title>\n\n    <md-card-content>\n      <dt-validation-summary model="ChangePasswordVM.changePasswordModel"></dt-validation-summary>\n\n      <form class="md-card-form" novalidate>\n        <div class="auth-row second-row">\n          <dt-input-password model="ChangePasswordVM.changePasswordModel" property-name="oldPassword" label="Current Password" class="auth-row"></dt-input-password>\n        </div>\n\n        <div class="auth-row second-row sign-up-password-row">\n          <dt-input-password model="ChangePasswordVM.changePasswordModel" property-name="newPassword" label="New Password" show-extra-validation="true"></dt-input-password>\n        </div>\n\n        <div layout="row">\n          <md-button type="submit" class="md-raised md-primary" ng-click="ChangePasswordVM.changePassword()" flex>Change Password</md-button>\n        </div>\n      </form>\n    </md-card-content>\n\n    <md-card-actions class="md-card-action" layout="row" layout-align="center center">\n      <a ui-sref="root.standard.user.profile({ userId: $root.currentUser.userId })" class="auth-href">Back</a>\n    </md-card-actions>\n  </md-card>\n  <div flex></div>\n</div>'),e.put("cache/modules/register/confirm-change-email.html",'<div layout="column" ng-controller="ConfirmChangeEmailCtrl as ConfirmChangeEmailVM">\n  <md-card class="md-card-box centered-card-box">\n    <md-card-title class="no-content card-box-title">\n      <md-card-title-text>\n        <span class="md-headline">Email Confirmation</span>\n        <span class="md-subhead">Confirming your email, please wait...</span>\n      </md-card-title-text>\n    </md-card-title>\n  </md-card>\n</div>'),e.put("cache/modules/register/confirm-email.html",'<div layout="column" ng-controller="ConfirmEmailCtrl as ConfirmEmailVM">\n  <md-card class="md-card-box centered-card-box">\n    <md-card-title class="no-content card-box-title">\n      <md-card-title-text>\n        <span class="md-headline">Email Confirmation</span>\n        <span class="md-subhead">Confirming your email, please wait...</span>\n      </md-card-title-text>\n    </md-card-title>\n  </md-card>\n</div>'),e.put("cache/modules/register/forgot-password.html",'<div ng-controller="ForgotPasswordCtrl as ForgotPasswordVM">\n  <md-card class="md-card-box centered-card-box">\n    <md-card-title class="card-box-title">\n      <md-card-title-text>\n        <span class="md-headline">Forgot Password?</span>\n      </md-card-title-text>\n    </md-card-title>\n\n    <md-card-content>\n      <dt-validation-summary model="ForgotPasswordVM.forgotPasswordModel"></dt-validation-summary>\n\n      <form class="md-card-form" novalidate>\n        <dt-input-text model="ForgotPasswordVM.forgotPasswordModel" property-name="email" label="Email" input-type="email"></dt-input-text>\n        <div layout="row">\n          <md-button type="submit" class="md-raised md-primary" ng-click="ForgotPasswordVM.forgotPassword()" flex>Send email</md-button>\n        </div>\n      </form>\n    </md-card-content>\n\n    <md-card-actions class="md-card-action" layout="row" layout-align="center center">\n      <a ui-sref="root.centered.login" class="auth-href">Back</a>\n    </md-card-actions>\n  </md-card>\n  <div flex></div>\n</div>'),e.put("cache/modules/register/register.html",'<div ng-controller="RegisterCtrl as RegisterVM" layout="column" flex>\n  <md-card class="md-card-box centered-card-box register-box" layout="column" flex="none" layout-gt-sm="row">\n    <div class="regular-login" flex-gt-sm="50">\n      <md-card-title class="card-box-title">\n        <md-card-title-text>\n          <span class="md-headline">Create an account</span>\n        </md-card-title-text>\n      </md-card-title>\n\n      <md-card-content>\n        <dt-validation-summary model="RegisterVM.credentials"></dt-validation-summary>\n\n        <form class="md-card-form" novalidate>\n          <div class="auth-row first-row">\n            <dt-input-text model="RegisterVM.credentials" property-name="email" label="E-mail address" input-type="email"></dt-input-text>\n          </div>\n          <div class="auth-row second-row sign-up-password-row">\n            <dt-input-password model="RegisterVM.credentials" property-name="password" label="Password" show-extra-validation="true"></dt-input-password>\n          </div>\n          <div class="auth-row fourth-row" layout="row">\n            <md-button type="submit" class="md-raised md-primary" ng-click="RegisterVM.register()" flex>Sign Up</md-button>\n          </div>\n        </form>\n      </md-card-content>\n\n      <md-card-actions class="md-card-action" layout="row">\n        Already have an account? &nbsp;&nbsp;<a ui-sref="root.centered.login" class="auth-href">Sign In</a>\n      </md-card-actions>\n    </div>\n\n    <div flex-gt-sm="50">\n      <md-card-title class="card-box-title">\n        <md-card-title-text>\n          <span class="md-headline">Social Sign Up</span>\n        </md-card-title-text>\n      </md-card-title>\n\n      <md-card-content>\n        <div class="auth-row" layout="row">\n          <md-button class="md-raised google-button" flex ng-click="RegisterVM.authenticate(\'google\')">\n            <span class="social-button-wrapper" layout="row">\n              <img src="/images/google-logo.png">\n              <span flex layout="row" layout-align="start center">Sign in with Google</span>\n            </span>\n          </md-button>\n        </div>\n\n        <div class="auth-row" layout="row">\n          <md-button class="md-raised github-button" flex ng-click="RegisterVM.authenticate(\'github\')">\n            <span class="social-button-wrapper" layout="row">\n              <md-icon class="mdi mdi-github-circle"></md-icon>\n              <span flex layout="row" layout-align="start center">Sign in with GitHub</span>\n            </span>\n          </md-button>\n        </div>\n      </md-card-content>\n    </div>\n  </md-card>\n  <div flex></div>\n</div>\n'),e.put("cache/modules/register/reset-password.html",'<div ng-controller="ResetPasswordCtrl as ResetPasswordVM">\n  <md-card class="md-card-box centered-card-box">\n    <md-card-title class="card-box-title">\n      <md-card-title-text>\n        <span class="md-headline">Reset password</span>\n      </md-card-title-text>\n    </md-card-title>\n\n    <md-card-content class="no-actions">\n      <dt-validation-summary model="ResetPasswordVM.resetPasswordModel"></dt-validation-summary>\n\n      <form class="md-card-form" novalidate>\n        <dt-input-password model="ResetPasswordVM.resetPasswordModel" property-name="password" label="Password" show-extra-validation="true"></dt-input-password>\n        <div layout="row">\n          <md-button type="submit" class="md-raised md-primary" ng-click="ResetPasswordVM.resetPassword()" flex>Reset password</md-button>\n        </div>\n      </form>\n    </md-card-content>\n  </md-card>\n</div>'),e.put("cache/modules/source-editor/dt-source-editor-menu.html",'<md-menu-bar>\n  <md-menu>\n    <md-button aria-label="File" ng-click="$mdMenu.open()">\n      File\n    </md-button>\n    <md-menu-content>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-plus-box"></md-icon>\n        <md-menu>\n          <md-button ng-click="$mdMenu.open()">New</md-button>\n          <md-menu-content width="3">\n            <md-menu-item class="md-indent">\n              <md-icon class="mdi mdi-folder"></md-icon>\n              <md-button ng-click="DtSourceEditorMenuVM.newFolder()">\n                Folder\n              </md-button>\n            </md-menu-item>\n            <md-menu-item class="md-indent">\n              <md-icon class="mdi mdi-file"></md-icon>\n              <md-button ng-click="DtSourceEditorMenuVM.newDiagram()">\n                File\n              </md-button>\n            </md-menu-item>\n          </md-menu-content>\n        </md-menu>\n      </md-menu-item>\n      <md-menu-item class="md-indent" ng-if="$root.currentUser">\n        <md-icon class="mdi mdi-pencil"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'rename\')">\n          Rename\n        </md-button>\n      </md-menu-item>\n      <md-menu-divider></md-menu-divider>\n      <md-menu-item class="md-indent" ng-if="$root.currentUser && !DtSourceEditorMenuVM.diagramSecurity.organizationOwnerId">\n        <md-icon class="mdi mdi-account-group"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'collaborate\')">\n          Collaborate\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-check" ng-if="DtSourceEditorMenuVM.diagramSecurity.isPrivate"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'flipPrivate\')">\n          Private\n        </md-button>\n      </md-menu-item>\n      <md-menu-divider></md-menu-divider>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-palette"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.flipIsBasicPaletteActive()">\n          {{DtSourceEditorMenuVM.isBasicPaletteActive ? "Use Default color palette" : "Use Basic color palette"}}\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-eraser-variant"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'clear\')">\n          Clear\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'demo\')">\n          Load Sample Diagram\n        </md-button>\n      </md-menu-item>\n    </md-menu-content>\n  </md-menu>\n  <md-menu>\n    <md-button aria-label="Edit" ng-click="$mdMenu.open()">\n      Edit\n    </md-button>\n    <md-menu-content>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-undo"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'undo\')">\n          Undo\n          <span class="md-alt-text">{{ \'M-Z\' | keyboardShortcut }}</span>\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-redo"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'redo\')">\n          Redo\n          <span class="md-alt-text">{{ \'M-Y\' | keyboardShortcut }}</span>\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-keyboard-tab"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'untabify\')">\n          Untabify\n        </md-button>\n      </md-menu-item>\n      <md-menu-divider></md-menu-divider>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-content-cut"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'cut\')">\n          Cut\n          <span class="md-alt-text">{{ \'M-X\' | keyboardShortcut }}</span>\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-content-copy"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'copy\')">\n          Copy\n          <span class="md-alt-text">{{ \'M-C\' | keyboardShortcut }}</span>\n        </md-button>\n      </md-menu-item>\n      <md-menu-divider></md-menu-divider>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-check" ng-if="DtSourceEditorMenuVM.isCanvasMouseZoomEnabled"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.flipIsCanvasMouseZoomEnabled()">\n          Mouse Zoom Enabled\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-check" ng-if="DtSourceEditorMenuVM.schema.sharedMetadata.isCaseSensitive"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'flipCasing\')">\n          Case Sensitive\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'setFieldType\')">\n          <span>Default Field Type</span>\n          <span ng-if="DtSourceEditorMenuVM.schema.sharedMetadata.defaultType">&nbsp;({{DtSourceEditorMenuVM.schema.sharedMetadata.defaultType}})</span>\n        </md-button>\n      </md-menu-item>\n    </md-menu-content>\n  </md-menu>\n  <md-menu>\n    <md-button aria-label="Export" ng-click="$mdMenu.open()">\n      Export\n    </md-button>\n    <md-menu-content>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-database"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'exportToSQL\', \'ansiSql\')">\n          ANSI SQL\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-database"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'exportToSQL\', \'mySql\')">\n          MySQL/MariaDB\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-database"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'exportToSQL\', \'oracle\')">\n          Oracle (12c+)\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-database"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'exportToSQL\', \'postgresql\')">\n          PostgreSQL\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-database"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'exportToSQL\', \'tSql\')">\n          SQL Server\n        </md-button>\n      </md-menu-item>\n      <md-menu-divider></md-menu-divider>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-file-pdf"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'exportToDoc\', \'pdf\')">\n          PDF Documentation\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-file-document"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'exportToDoc\', \'rtf\')">\n          RTF (Word) Documentation\n        </md-button>\n      </md-menu-item>\n      <md-menu-divider></md-menu-divider>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-file-image"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'exportToPNG\')">\n          PNG Image\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-file-image"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'exportToSVG\')">\n          SVG File\n        </md-button>\n      </md-menu-item>\n    </md-menu-content>\n  </md-menu>\n  <md-menu>\n    <md-button aria-label="Import" ng-click="$mdMenu.open()">\n      Import\n    </md-button>\n    <md-menu-content>\n      <input id="import-file-input" type="file" style="display:none" accept=".sql,.ddl">\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-database"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'importFromSQL\', \'mySql\')">\n          MySQL/MariaDB\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-database"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'importFromSQL\', \'oracle\')">\n          Oracle\n        </md-button>\n      </md-menu-item>\n      <md-menu-item class="md-indent">\n        <md-icon class="mdi mdi-database"></md-icon>\n        <md-button ng-click="DtSourceEditorMenuVM.menuAction(\'importFromSQL\', \'tSql\')">\n          SQL Server\n        </md-button>\n      </md-menu-item>\n    </md-menu-content>\n  </md-menu>\n  <a>\n    <md-button class="menu-button docs-button" aria-label="Docs" ng-click="DtSourceEditorMenuVM.showDocs()">\n      Docs\n    </md-button>\n  </a>\n  <a ng-if="!$root.currentUser">\n    <md-button class="toolbar-button extra-button" ng-click="DtSourceEditorMenuVM.save()" aria-label="Save">\n      <md-tooltip md-direction="bottom">Save</md-tooltip>\n      <md-icon class="mdi mdi-content-save"></md-icon>\n      <span class="menu-button extra-caption">\n        SAVE\n      </span>\n    </md-button>\n  </a>\n</md-menu-bar>\n'),e.put("cache/modules/source-editor/dt-source-editor.html",'<div ng-controller="DtSourceEditorCtrl as DtSourceEditorVM" layout="column" flex="100" class="editor-container">\n  <div class="ace-source-container tour-overlay-container" ng-click="DtSourceEditorVM.focusEditor()" flex>\n    <div class="tour-overlay editor-overlay"></div>\n    <div ng-if="DtSourceEditorVM.diagram.shortcode">\n      <h4 class="padded" ng-if="DtSourceEditorVM.diagram.sharedMetadata.parentName">\n        {{DtSourceEditorVM.diagram.sharedMetadata.parentName}}\n      </h4>\n      <h3 layout="row">\n        <span class="schema-title" ng-click="DtSourceEditorVM.rename()" flex>\n          <span ng-if="!DtSourceEditorVM.diagram.sharedMetadata">LOADING...</span>\n          <span ng-if="DtSourceEditorVM.diagram.sharedMetadata">{{DtSourceEditorVM.diagram.sharedMetadata.name || "NAME NOT SET"}}</span>\n        </span>\n        <md-button class="md-icon-button md-mini" ng-click="DtSourceEditorVM.onLockButtonClick()" ng-if="DtSourceEditorVM.diagramSecurity.isLockedForEditing" aria-label="Diagram Locked">\n          <md-tooltip md-direction="bottom">{{DtSourceEditorVM.getDiagramLockedReason()}}</md-tooltip>\n          <md-icon class="mdi mdi-lock-outline" aria-label="Diagram Locked"></md-icon>\n        </md-button>\n        <md-menu class="last-icon" ng-if="$root.currentUser && DtSourceEditorVM.diagram.sharedMetadata">\n          <md-button class="md-icon-button md-mini" aria-label="Options" ng-click="$mdMenu.open()">\n            <md-tooltip md-direction="bottom">Options</md-tooltip>\n            <md-icon class="mdi mdi-dots-vertical" aria-label="Options"></md-icon>\n          </md-button>\n          <md-menu-content>\n            <md-menu-item>\n              <md-button aria-label="Rename" ng-click="DtSourceEditorVM.rename()">\n                Rename\n              </md-button>\n            </md-menu-item>\n            <md-menu-item ng-if="DtSourceEditorVM.diagramSecurity.isOwnedByCurrentUser">\n              <md-button aria-label="Rename" ng-click="DtSourceEditorVM.flipPrivate()">\n                {{DtSourceEditorVM.diagramSecurity.isPrivate ? "Make Public" : "Make Private"}}\n              </md-button>\n            </md-menu-item>\n            <md-menu-item ng-if="!DtSourceEditorVM.diagramSecurity.organizationOwnerId">\n              <md-button aria-label="Collaborate" ng-click="DtSourceEditorVM.collaborate()">\n                Collaborate\n              </md-button>\n            </md-menu-item>\n            <md-menu-item ng-if="$root.currentUser.isOrganizationAdmin && DtSourceEditorVM.diagramSecurity.organizationOwnerId">\n              <md-button aria-label="Collaborate" ng-click="DtSourceEditorVM.manageAccess()">\n                Manage Access\n              </md-button>\n            </md-menu-item>\n            <md-menu-item ng-if="$root.currentUser.isOrganizationAdmin && DtSourceEditorVM.diagramSecurity.organizationOwnerId">\n              <md-button aria-label="Collaborate" ng-click="DtSourceEditorVM.delete()">\n                Delete\n              </md-button>\n            </md-menu-item>\n          </md-menu-content>\n        </md-menu>\n      </h3>\n    </div>\n    <div ui-ace="{\n         showPrintMargin: false,\n         onLoad: aceLoaded,\n         onChange: aceChanged,\n         mode: \'qdbdrules\',\n         advanced: {\n           enableBasicAutocompletion: true,\n           enableLiveAutocompletion: false\n         }}" ng-class="{ \'locked-for-editing\': DtSourceEditorVM.isDiagramLocked() }">\n    </div>\n  </div>\n\n  <div class="tour-overlay-container">\n    <div class="tour-overlay"></div>\n    <md-progress-linear md-mode="query" ng-disabled="DtSourceEditorVM.parsingStatus !== \'loading\'" ng-class="DtSourceEditorVM.getParsingStatus()"></md-progress-linear>\n  </div>\n\n  <div class="compiler-errors tour-overlay-container" flex="10">\n    <div class="tour-overlay"></div>\n    <ul>\n      <li class="editor-notification" ng-if="DtSourceEditorVM.diagramSecurity.isTableLimitReached">\n        <pre><span class="go-pro-notification">Only the first 10 tables are shown on the free plan.</span>\n        <span ng-if="!DtSourceEditorVM.diagramSecurity.organizationOwnerId">\n          Please <a href="javascript:void(0)" ng-click="DtSourceEditorVM.goPro()" class="notification-action">GO PRO</a> from $7 for more.</span></pre>\n        \n      </li>\n      <li class="editor-notification" ng-if="DtSourceEditorVM.showReadOnlyMessage()">\n        <pre>You are viewing this diagram in read-only mode. <span ng-if="!DtSourceEditorVM.diagramSecurity.organizationOwnerId">\n        <a href="javascript:void(0)" ng-click="DtSourceEditorVM.copyCurrentDiagram()" class="notification-action">COPY</a>\n        it to enable editing.</span></pre>\n      </li>\n      <li ng-if="DtSourceEditorVM.parsingStatus === \'loading\'"><pre>Parsing...</pre></li>\n      <li ng-if="DtSourceEditorVM.parsingStatus === \'success\'"><pre>No errors found. Good job!</pre></li>\n      <li ng-repeat="(line, errors) in DtSourceEditorVM.qdbdSchema.errors" ng-if="DtSourceEditorVM.parsingStatus === \'error\'">\n        <ul>\n          <li ng-repeat="error in errors track by $index" ng-click="DtSourceEditorVM.goToLine(line)" class="compiler-error">\n            <pre><span class="compiler-error-line">Line {{line}}:</span> {{error}}</pre>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </div>\n</div>\n'),e.put("cache/modules/subscription/billing-details.html",'<div class="billing-details-card" ng-controller="BillingDetailsCtrl as BillingDetailsVM">\n  <md-card class="md-card-box centered-card-box">\n    <md-card-title class="billing-details-title-container card-box-title">\n      <md-card-title-text>\n        <span class="md-headline">Billing Details</span>\n      </md-card-title-text>\n    </md-card-title>\n\n    <md-card-content ng-if="!BillingDetailsVM.billingDetails.emailConfirmed">\n      <p class="card-content-description">Your email address hasn\'t been confirmed yet. Please confirm your email before proceeding with the checkout and when done please refresh the page.</p>\n      <div layout="row">\n        <md-button class="md-raised md-primary card-action-button" ng-click="BillingDetailsVM.confirmEmail()" flex>Confirm</md-button>\n      </div>\n    </md-card-content>\n\n    <md-card-content ng-if="BillingDetailsVM.billingDetails.emailConfirmed">\n      <p class="card-content-description">Please ensure your personal details are correct.</p>\n\n      <form class="md-card-form" novalidate>\n        <div>\n          <dt-input-text model="BillingDetailsVM.billingDetails" property-name="firstName" label="First Name"></dt-input-text>\n        </div>\n        <div>\n          <dt-input-text model="BillingDetailsVM.billingDetails" property-name="lastName" label="Last Name"></dt-input-text>\n        </div>\n        <div>\n          <dt-input-text model="BillingDetailsVM.billingDetails" property-name="phoneNumber" label="Phone Number"></dt-input-text>\n        </div>\n\n        <p class="card-content-description">Billing Address</p>\n        <div>\n          <dt-input-text model="BillingDetailsVM.billingDetails" property-name="address" label="Address"></dt-input-text>\n        </div>\n        <div>\n          <dt-input-text model="BillingDetailsVM.billingDetails" property-name="postCode" label="Post Code"></dt-input-text>\n        </div>\n        <md-select ng-model="BillingDetailsVM.billingDetails.countryCode" placeholder="Country">\n          <md-option ng-value="code" ng-repeat="(code, name) in BillingDetailsVM.countryCodes">{{ name }}</md-option>\n        </md-select>\n\n        <div ng-if="BillingDetailsVM.billingDetails.isVoucher">\n          <dt-input-text model="BillingDetailsVM.billingDetails" property-name="voucherCode" label="Voucher Code"></dt-input-text>\n        </div>\n        <div layout="row">\n          <md-button class="md-raised md-primary card-action-button" type="submit" ng-click="BillingDetailsVM.confirmBillingDetails()" flex>Confirm</md-button>\n        </div>\n        <div layout="row">\n          <md-button class="md-raised card-action-button back-button" ng-click="BillingDetailsVM.back()" flex>\n            Back\n          </md-button>\n        </div>\n      </form>\n    </md-card-content>\n  </md-card>\n  <div flex></div>\n</div>'),e.put("cache/modules/subscription/checkout.html",'<div class="checkout-card" ng-controller="CheckoutCtrl as CheckoutVM">\n  <md-card class="md-card-box centered-card-box">\n    <md-card-title class="checkout-title-container card-box-title">\n      <md-card-title-text>\n        <span class="md-headline">Checkout</span>\n      </md-card-title-text>\n    </md-card-title>\n\n    <md-card-content class="checkout-content-container">\n      <div class="checkout-details">\n        <div>Plan: <span>{{CheckoutVM.checkoutDetails.planCaption}}</span></div>\n        <div>Payment: <span>{{CheckoutVM.checkoutDetails.amountToPay | currency : CheckoutVM.checkoutDetails.currencySymbol}}</span></div>\n        <div ng-if="CheckoutVM.checkoutDetails.nextBillingDate">\n          Next billing date: <span>{{CheckoutVM.checkoutDetails.nextBillingDate | date : "d MMM yyyy"}}</span>\n        </div>\n        <div>Subscription expiry date: <span>{{CheckoutVM.checkoutDetails.subscriptionExpiresOn | date : "d MMM yyyy"}}</span></div>\n      </div>\n\n      <div ng-if="!CheckoutVM.braintreeInitStarted" layout="row" layout-sm="column" layout-align="space-around" class="progress-container">\n        <md-progress-circular md-diameter="96"></md-progress-circular>\n      </div>\n\n      <div ng-if="CheckoutVM.isVoucher && CheckoutVM.braintreeInitStarted">\n        Voucher Code: <span><b>{{CheckoutVM.checkoutDetails.voucherCode}}</b></span>\n      </div>\n\n      <div id="dropin-container"></div>\n\n      <div ng-if="(!CheckoutVM.isMethodSelectable && CheckoutVM.isMethodSelected) || CheckoutVM.isVoucher" class="accept-tos">\n        <md-checkbox ng-model="CheckoutVM.acceptedTerms" aria-label="Accept terms & conditions">\n          I accept terms & conditions\n        </md-checkbox>\n      </div>\n\n      <div layout="row" ng-if="CheckoutVM.dropInInstance || CheckoutVM.isVoucher">\n        <md-button class="md-raised md-primary card-action-button" ng-if="CheckoutVM.isMethodSelectable && !CheckoutVM.isMethodSelected" ng-click="CheckoutVM.selectPaymentMethod()" flex>\n          Select payment method\n        </md-button>\n        <md-button class="md-raised card-action-button authorize-button" ng-class="{ \'md-primary\': CheckoutVM.acceptedTerms && !CheckoutVM.authorizationInProgress }" ng-disabled="!CheckoutVM.acceptedTerms || CheckoutVM.authorizationInProgress" ng-if="(!CheckoutVM.isMethodSelectable && CheckoutVM.isMethodSelected) || CheckoutVM.isVoucher" ng-click="CheckoutVM.authorizePayment()" flex>\n          {{CheckoutVM.checkoutDetails.plan === "voucher" ? \'Confirm\' : CheckoutVM.checkoutDetails.nextBillingDate ? \'Authorize Payment\' : \'Pay\'}}\n        </md-button>\n      </div>\n      <div layout="row">\n        <md-button class="md-raised card-action-button back-button" ng-click="CheckoutVM.back()" flex>\n          Back\n        </md-button>\n      </div>\n    </md-card-content>\n  </md-card>\n\n  <div flex></div>\n</div>'),e.put("cache/modules/subscription/subscribe.html",'<div layout="column" flex ng-controller="SubscribeCtrl as SubscribeVM" class="subscription-plans">\n  <md-card class="limited-offer">\n    <md-card-title>\n      <md-card-title-text>\n        <span class="md-headline">Limited time offer - get Pro for FREE!</span>\n        <span class="md-subhead">We are currently offering <strong>free</strong> plans in exchange for <strong>publicity</strong>.</span>\n      </md-card-title-text>\n    </md-card-title>\n\n    <md-card-content layout="row">\n      <div class="left" flex>\n        <div layout="row">\n          <div class="left offer-icon-container">\n            <md-icon class="mdi mdi-twitter offer-icon"></md-icon>\n          </div>\n          <div class="right offer-message">\n            <strong>Tweet</strong> about <a href="https://twitter.com/quick_dbd">@Quick_DBD</a> and get <strong>two months</strong> for FREE. You can retweet a user\'s tweet or write your own.\n          </div>\n        </div>\n\n        <div class="center-content">\n          <md-button class="md-raised md-primary offer-button write-own-tweet" ng-click="SubscribeVM.tweet()" flex>I\'ll write my own tweet</md-button>\n        </div>\n        <div class="center-content write-my-tweet-text">\n          (This will open a pre-populated editor.)\n        </div>\n\n        <div class="twitter-embed">\n          <blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr"><a href="https://t.co/6YVmL6GWL2">https://t.co/6YVmL6GWL2</a> is currently giving away free Pro Plans!! Awesome tool to quickly design databases online. I love it!  <a href="https://twitter.com/quick_dbd?ref_src=twsrc%5Etfw">@quick_dbd</a></p>&mdash; Trevor Jobling (@TrevorJobling) <a href="https://twitter.com/TrevorJobling/status/1052145360179789824?ref_src=twsrc%5Etfw">October 16, 2018</a></blockquote>\n          <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>\n        </div>\n\n        <div class="center-content">\n          <md-button class="md-raised md-primary offer-button retweet" href="https://twitter.com/intent/retweet?tweet_id=1052145360179789824">Retweet this</md-button>\n        </div>\n      </div>\n\n      <div class="right" flex>\n        <div layout="row">\n          <div class="left offer-icon-container">\n            <md-icon class="mdi mdi-lead-pencil offer-icon"></md-icon>\n          </div>\n          <div class="right offer-message">\n            <strong>Write a review</strong> on your blog or other website and get <strong>1 year</strong> for FREE.<br><br>\n            You don\'t have to <em>promote</em> QuickDBD. Just be honest and write something of reasonable length (minimum 500 words). Email <a href="mailto:promo@quickdbd.com">promo@quickdbd.com</a> to claim your free Pro Plan when it\'s published.\n          </div>\n        </div>\n      </div>\n    </md-card-content>\n\n    <md-card-content class="center-content instructions">\n      <div>\n        To claim your free Pro Plan, email <a href="mailto:promo@quickdbd.com">promo@quickdbd.com</a> with a link to your Twitter profile (it must be public) and to your QuickDBD <a ui-sref="root.standard.user.profile({ userId: $root.currentUser.userId })">profile</a>.\n      </div>\n      <div>\n        Send it from the email account associated with your QuickDBD account.\n      </div>\n      <div class="reserved-rights">\n        We reserve the right to withold free Plans for unsuitable content.\n      </div>\n    </md-card-content>\n  </md-card>\n\n  <md-card class="choose-plan">\n    <md-card-title>\n      <md-card-title-text>\n        <span class="md-headline">Choose a Pro Plan</span>\n      </md-card-title-text>\n    </md-card-title>\n\n    <md-card-content class="plans-container">\n      <div layout="row">\n        <div class="subscription-plan" flex="33">\n          <div class="plan-name">One Week Pass</div>\n          <div class="plan-price">\n            &#36;7.00 ONE-OFF PAYMENT <br>\n            <div class="highlighted-label"><b>&nbsp;</b></div>\n          </div>\n          <div layout="row">\n            <md-button class="md-raised md-primary card-action-button alt" ng-click="SubscribeVM.selectSubscription(\'weekPass\')" flex>Get Week Pass</md-button>\n          </div>\n        </div>\n\n        <div class="subscription-plan" flex="33">\n          <div class="plan-name">Monthly</div>\n          <div class="plan-price">\n            &#36;14.00 / MONTH\n            <br>\n            <div class="highlighted-label"><b>&nbsp;</b></div>\n          </div>\n          <div layout="row">\n            <md-button class="md-raised md-primary card-action-button alt" ng-click="SubscribeVM.selectSubscription(\'monthly\')" flex>Get Monthly</md-button>\n          </div>\n        </div>\n\n        <div class="subscription-plan" flex="33">\n          <div class="plan-name annually">Annual</div>\n          <div class="plan-price annually" ng-if="!SubscribeVM.SubscriptionService.hasDiscountId()">\n            &#36;95.00 / YEAR <span class="yearly-per-month">(&#36;7.92 / MONTH)</span><br>\n            <div class="highlighted-label"><b>&nbsp;</b></div>\n          </div>\n          <div class="plan-price annually" ng-if="SubscribeVM.SubscriptionService.hasDiscountId()">\n            Normally &#36;95.00 / YEAR <br>\n            <div class="highlighted-label">\n              <b>\n                Discounted to &#36;{{ SubscribeVM.SubscriptionService.getCachedDiscountedValue() }} for you!\n              </b>\n            </div>\n          </div>\n          <div layout="row">\n            <md-button class="md-raised md-primary card-action-button" ng-click="SubscribeVM.selectSubscription(\'annual\')" flex>Get Annual</md-button>\n          </div>\n        </div>\n      </div>\n    </md-card-content>\n  </md-card>\n\n  <md-card class="voucher-box" ng-if="!SubscribeVM.$rootScope.currentUser.hasIndividualProAccess && SubscribeVM.SubscriptionService.hasVoucherCode()">\n    <div layout="row">\n      <div class="voucher-box-button"></div>\n      <md-button class="md-raised md-primary card-action-button alt voucher-box-button" ng-click="SubscribeVM.selectSubscription(\'voucher\')" flex>Use your voucher code here</md-button>\n      <div class="voucher-box-button"></div>\n    </div>\n  </md-card>\n\n  <md-card class="feature-comparison">\n    <md-card-title>\n      <md-card-title-text>\n        <span class="md-headline">Compare Features</span>\n      </md-card-title-text>\n    </md-card-title>\n\n    <md-card-content layout="row">\n      <div class="plan-features left" flex>\n        <h4>Free</h4>\n        <div>\n          Max diagrams <span class="feature-value">1</span>\n        </div>\n        <div>\n          Max tables per diagram <span class="feature-value">10</span>\n        </div>\n        <div>\n          Private diagrams <span class="feature-value">No</span>\n        </div>\n        <div>\n          Real-time collaboration <span class="feature-value">Yes</span>\n        </div>\n        <div>\n          Export images <span class="feature-value">Yes</span>\n        </div>\n        <div>\n          Export SQL <span class="feature-value">Yes</span>\n        </div>\n        <div>\n          Export PDF/RTF <span class="feature-value">Yes</span>\n        </div>\n      </div>\n      <div class="plan-features right" flex>\n        <h4>Pro</h4>\n        <div>\n          Max diagrams <span class="feature-value">30</span>\n        </div>\n        <div>\n          Max tables per diagram <span class="feature-value">Unlimited</span>\n        </div>\n        <div>\n          Private diagrams <span class="feature-value">Yes</span>\n        </div>\n        <div>\n          Real-time collaboration <span class="feature-value">Yes</span>\n        </div>\n        <div>\n          Export images <span class="feature-value">Yes</span>\n        </div>\n        <div>\n          Export SQL <span class="feature-value">Yes</span>\n        </div>\n        <div>\n          Export PDF/RTF <span class="feature-value">Yes</span>\n        </div>\n      </div>\n    </md-card-content>\n  </md-card>\n\n  <div flex></div>\n</div>\n'),e.put("cache/modules/user/profile.html",'<div layout="row" flex ng-controller="ProfileCtrl as ProfileVM">\n    <dt-user-profile user-profile="ProfileVM.userProfile" ng-if="ProfileVM.userProfile" initialize-user="ProfileVM.initializeUser()">\n    </dt-user-profile>\n    <h2 ng-if="ProfileVM.userProfile === undefined">Loading profile, please wait...</h2>\n    <h2 ng-if="ProfileVM.userProfile === null">Profile does not exist</h2>\n</div>'),e.put("cache/modules/user/user.html",'<div ng-controller="UserCtrl as UserVM" flex class="tabbed-layout">\n  <md-tabs class="md-primary" md-selected="UserVM.selectedTab">\n    <md-tab ng-repeat="route in UserVM.routes" label="{{route.caption}}" ng-click="UserVM.loadRoute(route.name)"></md-tab>\n  </md-tabs>\n  <div layout="row">\n    <div id="user-content" class="tabbed-content" ui-view="user-content"></div>\n    <div flex></div>\n  </div>\n</div>'),e.put("cache/modules/voucher/voucher.html",'<div ng-controller="VoucherCtrl as VoucherVM" layout="column" flex>\n  <md-card class="md-card-box centered-card-box voucher-box" flex="none" layout-gt-sm="row">\n    <div class="left-side-voucher">\n      <md-card-title class="card-box-title" ng-if="!VoucherVM.isEdit">\n        <md-card-title-text>\n          <span class="md-headline">Add new voucher</span>\n        </md-card-title-text>\n      </md-card-title>\n\n      <md-card-title class="card-box-title" ng-if="VoucherVM.isEdit">\n        <md-card-title-text>\n          <table>\n            <tr>\n              <td>\n                <span class="md-headline">Edit voucher</span>\n              </td>\n              <td align="right">\n                <md-button class="md-icon-button grid-md-button" href="javascript:void(0)" ng-click="VoucherVM.copyVoucherUrl(VoucherVM.voucher)">\n                  <md-tooltip md-direction="right">Copy voucher URL to clipboard</md-tooltip>\n                  <md-icon class="mdi copy-icon-button"></md-icon>\n                </md-button>\n              </td>\n            </tr>\n          </table>\n        </md-card-title-text>\n      </md-card-title>\n\n      <md-card-content>\n        <dt-validation-summary model="VoucherVM.voucher"></dt-validation-summary>\n\n        <form class="md-card-form" validate>\n          <div class="auth-row first-row">\n            <dt-input-text model="VoucherVM.voucher" property-name="code" label="Code" max-length="50"></dt-input-text>\n          </div>\n\n          <div class="auth-row first-row">\n            <dt-input-text model="VoucherVM.voucher" property-name="description" label="Description"></dt-input-text>\n          </div>\n          <div class="auth-row first-row">\n            <dt-input-text model="VoucherVM.voucher" property-name="validFrom" label="Valid From" input-type="date" class="ng-isolate-scope" min-date="VoucherVM.voucher.minDate"></dt-input-text>\n          </div>\n\n          <div class="auth-row first-row">\n            <dt-input-text model="VoucherVM.voucher" property-name="validTo" label="Valid To" input-type="date" class="ng-isolate-scope" min-date="VoucherVM.voucher.minDate">></dt-input-text>\n          </div>\n\n          <div class="auth-row remembering-message">\n            * A voucher must have a start and a end date to be valid.\n          </div>\n\n          <div class="auth-row first-row">\n            <dt-input-text model="VoucherVM.voucher" property-name="maxRedemptions" label="Max Redemptions" input-type="number" no-float></dt-input-text>\n          </div>\n\n          <div class="auth-row first-row">\n            <dt-input-text model="VoucherVM.voucher" property-name="valueInWeeks" label="Weeks" input-type="number" no-float></dt-input-text>\n          </div>\n\n          <div class="button-section" layout="row" flex="none" layout-gt-sm="row">\n            <div class="auth-row fourth-row double-button" layout="column">\n              <md-button type="submit" class="md-raised" flex ng-click="VoucherVM.back()">Back</md-button>\n            </div>\n            <div class="auth-row fourth-row double-button" layout="column">\n              <md-button type="submit" class="md-raised md-primary" flex ng-click="VoucherVM.save()">Save</md-button>\n            </div>\n          </div>\n        </form>\n      </md-card-content>\n    </div>\n\n    <div class="right-side-voucher" flex-gt-xs="50">\n      <md-card-title class="card-box-title">\n        <md-card-title-text>\n          <span class="md-headline">&nbsp;</span>\n        </md-card-title-text>\n      </md-card-title>\n\n      <md-card-content>\n        <div class="auth-row first-row">\n        </div>\n\n        <div class="auth-row first-row">\n        </div>\n\n        <div class="auth-row fourth-row double-button" layout="column">\n          <md-button type="submit" class="md-primary md-raised" flex ng-click="VoucherVM.setDefaultPeriod(\'week\')">One Week</md-button>\n        </div>\n\n        <div class="auth-row fourth-row double-button" layout="column">\n          <md-button type="submit" class="md-primary md-raised" flex ng-click="VoucherVM.setDefaultPeriod(\'month\')">One Month</md-button>\n        </div>\n\n        <div class="auth-row fourth-row double-button" layout="column">\n          <md-button type="submit" class="md-primary md-raised" flex ng-click="VoucherVM.setDefaultPeriod(\'year\')">One Year</md-button>\n        </div>\n\n        <div class="auth-row remembering-message">\n        </div>\n\n        <div class="auth-row first-row">\n        </div>\n\n        <div class="auth-row first-row">\n        </div>\n      </md-card-content>\n    </div>\n  </md-card>\n  <div flex></div>\n</div>\n\n'),e.put("cache/common/layouts/centered.html",'<main layout="row" flex="noshrink">\n  <dt-side-toolbar layout="column"></dt-side-toolbar>\n  <div id="main-content" ui-view="main-content" layout="column" layout-align="start center" flex></div>\n</main>\n\n\n'),e.put("cache/common/layouts/standard-padded.html",'<main layout="row" flex="noshrink">\n  <dt-side-toolbar layout="column"></dt-side-toolbar>\n  <div id="main-content" class="padded-content" ui-view="main-content" layout="row" flex></div>\n</main>'),e.put("cache/common/layouts/standard-shrinkable.html",'<main layout="row" flex>\n  <dt-side-toolbar layout="column"></dt-side-toolbar>\n  <div id="main-content" ui-view="main-content" layout="row" flex></div>\n</main>\n'),e.put("cache/common/layouts/standard.html",'<main layout="row" flex="noshrink">\n  <dt-side-toolbar layout="column"></dt-side-toolbar>\n  <div id="main-content" ui-view="main-content" layout="row" flex></div>\n</main>\n'),e.put("cache/modules/organization/dt-organization-diagram-access/dt-organization-diagram-access.html",'<div class="dt-paged-content">\n  <h3 ng-if="DtOrganizationDiagramAccessVM.diagramName" class="">\n    <a ui-sref="root.standardShrinkable.diagram({ shortcode: DtOrganizationDiagramAccessVM.shortcode })" class="link" target="_blank">\n      {{DtOrganizationDiagramAccessVM.diagramName}}\n      <md-icon class="mdi mdi-open-in-new header-link-icon"></md-icon></a>\n    &nbsp; &mdash; &nbsp; Manage Diagram Access\n  </h3>\n\n  <div class="search-filter">\n    <dt-input-text model="DtOrganizationDiagramAccessVM.filter" property-name="search" label="Search"></dt-input-text>\n  </div>\n\n  <div ng-if="DtOrganizationDiagramAccessVM.users.items && DtOrganizationDiagramAccessVM.users.items.length > 0">\n    <table>\n      <tr>\n        <th>\n          <dt-sortable-heading name="First Name" sort-by="firstName" filter="DtOrganizationDiagramAccessVM.filter" pager="DtOrganizationDiagramAccessVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Last Name" sort-by="lastName" filter="DtOrganizationDiagramAccessVM.filter" pager="DtOrganizationDiagramAccessVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Email" sort-by="email" filter="DtOrganizationDiagramAccessVM.filter" pager="DtOrganizationDiagramAccessVM.pager"></dt-sortable-heading>\n        </th><th>\n          Is Collaborator?\n        </th>\n      </tr>\n      <tr ng-repeat="user in DtOrganizationDiagramAccessVM.users.items">\n        <td>{{user.firstName || "NOT SET"}}</td>\n        <td>{{user.lastName || "NOT SET"}}</td>\n        <td>{{user.email}}</td>\n        <td>\n          {{user.isCollaborator || user.isParentCollaborator ? "Yes" : "No"}}\n          <a ui-sref="root.standard.organization.foldersAccess({ folderId: user.parentFolderId })" class="grid-action-button" ng-if="user.isParentCollaborator">\n            (On Parent Folder)\n          <a href="javascript:void(0)" class="grid-action-button" ng-click="DtOrganizationDiagramAccessVM.changeCollaboratorStatus(user)" ng-if="!user.isParentCollaborator">\n            (Change)\n          </a>\n        </a></td>\n      </tr>\n    </table>\n    <dt-pager filter="DtOrganizationDiagramAccessVM.filter" collection="DtOrganizationDiagramAccessVM.users" pager="DtOrganizationDiagramAccessVM.pager"></dt-pager>\n  </div>\n  <dt-no-items collection="DtOrganizationDiagramAccessVM.users"></dt-no-items>\n</div>'),e.put("cache/modules/organization/dt-organization-diagrams/dt-organization-diagrams.html",'<div class="dt-paged-content">\n  <div class="grid-action-buttom-wrapper">\n    <md-button class="md-raised md-primary" ng-click="DtOrganizationDiagramsVM.addFolder()">Add Folder</md-button>\n  </div>\n\n  <div>\n    <div ng-if="DtOrganizationDiagramsVM.folderItems && DtOrganizationDiagramsVM.folderItems.length > 0">\n      <table>\n        <tr>\n          <th></th>\n          <th>Name</th>\n          <th class="no-right-padding">Actions</th>\n          <th></th>\n          <th></th>\n          <th></th>\n        </tr>\n        <tr ng-repeat="folderItem in DtOrganizationDiagramsVM.folderItems">\n          <td>\n            <md-icon ng-if="folderItem.itemType === \'folder\'" class="mdi mdi-folder-open" ng-attr-is-droppable-folder="{{folderItem.itemType === \'folder\'}}" ng-attr-item-id="{{folderItem.folderId}}" on-drag-enter="DtOrganizationDiagramsVM.onDragEnter()" on-drop="DtOrganizationDiagramsVM.onDrop()" html5-drop>\n            </md-icon>\n            <md-icon ng-if="folderItem.itemType === \'diagram\'" class="mdi mdi-file-outline hand-on-hover" drag-data="folderItem" html5-drag>\n            </md-icon>\n          </td>\n          <td>\n            <span ng-if="folderItem.itemType === \'folder\'" class="grid-folder-name">\n              {{folderItem.name || "NOT SET"}}\n            </span>\n            <span ng-if="folderItem.itemType === \'diagram\'">\n              <a class="grid-folder-diagram-link" ui-sref="root.standardShrinkable.diagram({ shortcode: folderItem.shortcode })" target="_blank">\n                 {{folderItem.name || "NOT SET"}}\n                 <md-icon class="mdi mdi-open-in-new"></md-icon>\n              </a>\n            </span>\n          </td>\n          <td class="center-aligned-content no-right-padding">\n            <a href="javascript:void(0)" class="grid-action-button padded-right" ng-click="DtOrganizationDiagramsVM.renameItem(folderItem)">\n              Rename\n            </a>\n          </td>\n          <td class="center-aligned-content no-right-padding">\n            <a href="javascript:void(0)" class="grid-action-button padded-right" ng-click="DtOrganizationDiagramsVM.addDiagram(folderItem)" ng-if="folderItem.itemType === \'folder\'">\n              Add Diagram\n            </a>\n            <span ng-if="folderItem.itemType === \'diagram\'">-</span>\n          </td>\n          <td class="center-aligned-content no-right-padding">\n            <a href="javascript:void(0)" class="grid-action-button padded-right" ui-sref="root.standard.organization.diagramsAccess({ diagramId: folderItem.diagramId })" ng-if="folderItem.itemType === \'diagram\'">\n              Manage Access\n            </a>\n            <a href="javascript:void(0)" class="grid-action-button padded-right" ui-sref="root.standard.organization.foldersAccess({ folderId: folderItem.folderId })" ng-if="folderItem.itemType === \'folder\'">\n              Manage Access\n            </a>\n          </td>\n          <td class="center-aligned-content no-right-padding">\n            <a href="javascript:void(0)" class="grid-action-button" ng-click="DtOrganizationDiagramsVM.deleteItem(folderItem)">\n              Delete\n            </a>\n          </td>\n        </tr>\n      </table>\n    </div>\n    <dt-no-items collection="DtOrganizationDiagramsVM.folderItems"></dt-no-items>\n  </div>\n</div>'),e.put("cache/modules/organization/dt-organization-folder-access/dt-organization-folder-access.html",'<div class="dt-paged-content">\n  <h3 ng-if="DtOrganizationFolderAccessVM.folderName">\n    {{DtOrganizationFolderAccessVM.folderName}} &nbsp; &mdash; &nbsp; Manage Folder Access\n  </h3>\n\n  <div class="search-filter">\n    <dt-input-text model="DtOrganizationFolderAccessVM.filter" property-name="search" label="Search"></dt-input-text>\n  </div>\n\n  <div ng-if="DtOrganizationFolderAccessVM.users.items && DtOrganizationFolderAccessVM.users.items.length > 0">\n    <table>\n      <tr>\n        <th>\n          <dt-sortable-heading name="First Name" sort-by="firstName" filter="DtOrganizationFolderAccessVM.filter" pager="DtOrganizationFolderAccessVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Last Name" sort-by="lastName" filter="DtOrganizationFolderAccessVM.filter" pager="DtOrganizationFolderAccessVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Email" sort-by="email" filter="DtOrganizationFolderAccessVM.filter" pager="DtOrganizationFolderAccessVM.pager"></dt-sortable-heading>\n        </th><th>\n          Is Collaborator?\n        </th>\n      </tr>\n      <tr ng-repeat="user in DtOrganizationFolderAccessVM.users.items">\n        <td>{{user.firstName || "NOT SET"}}</td>\n        <td>{{user.lastName || "NOT SET"}}</td>\n        <td>{{user.email}}</td>\n        <td>\n          {{user.isCollaborator ? "Yes" : "No"}}\n          <a href="javascript:void(0)" class="grid-action-button" ng-click="DtOrganizationFolderAccessVM.changeCollaboratorStatus(user)">\n            (Change)\n          </a>\n        </td>\n      </tr>\n    </table>\n    <dt-pager filter="DtOrganizationFolderAccessVM.filter" collection="DtOrganizationFolderAccessVM.users" pager="DtOrganizationFolderAccessVM.pager"></dt-pager>\n  </div>\n  <dt-no-items collection="DtOrganizationFolderAccessVM.users"></dt-no-items>\n</div>'),e.put("cache/modules/organization/dt-organization-list/dt-organization-list.html",'<div class="dt-paged-content">\n  <div class="search-filter">\n    <dt-input-text model="DtOrganizationListVM.filter" property-name="search" label="Search"></dt-input-text>\n  </div>\n\n  <div ng-if="DtOrganizationListVM.organizations.items && DtOrganizationListVM.organizations.items.length > 0">\n    <table>\n      <tr>\n        <th>\n          <dt-sortable-heading name="Name" sort-by="name" filter="DtOrganizationListVM.filter" pager="DtOrganizationListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          Country\n        </th>\n        <th>\n          Created At\n        </th>\n        <th>\n          Users\n        </th>\n        <th>\n          Pro Users\n        </th>\n        <th>\n          Admins\n        </th>\n        <th></th>\n      </tr>\n      <tr ng-repeat="organization in DtOrganizationListVM.organizations.items">\n        <td>{{organization.name || "NOT SET"}}</td>\n        <td>{{organization.country || "NOT SET"}}</td>\n        <td>{{organization.createdAt | date: "dd/MM/yyyy HH:mm"}}</td>\n        <td>{{organization.userCount}}</td>\n        <td>{{organization.proUserCount}}</td>\n        <td>{{organization.adminUserCount}}</td>\n        <td>\n          <a class="grid-action-button" ui-sref="root.standard.admin.organizationProGrantLogs({ organizationId: organization.id })">\n            Pro Grant Logs\n          </a>\n        </td>\n      </tr>\n    </table>\n    <dt-pager filter="DtOrganizationListVM.filter" collection="DtOrganizationListVM.organizations" pager="DtOrganizationListVM.pager"></dt-pager>\n  </div>\n  <dt-no-items collection="DtOrganizationListVM.organizations"></dt-no-items>\n</div>'),e.put("cache/modules/organization/dt-organization-pro-grant-log-list/dt-organization-pro-grant-log-list.html",'<div class="dt-paged-content no-search">\n  <div ng-if="DtOrganizationProGrantLogListVM.logs.items && DtOrganizationProGrantLogListVM.logs.items.length > 0">\n    <table>\n      <tr>\n        <th>\n          Name\n        </th>\n        <th>\n          Email\n        </th>\n        <th>\n          Granted At\n        </th>\n        <th>\n          Pro Access From\n        </th>\n        <th>\n          Pro Access To\n        </th>\n        <th>\n          Grant Type\n        </th>\n      </tr>\n      <tr ng-repeat="log in DtOrganizationProGrantLogListVM.logs.items">\n        <td>{{log.fullName || "NOT SET"}}</td>\n        <td>{{log.email || "NOT SET"}}</td>\n        <td>{{log.createdAt | date: "dd/MM/yyyy HH:mm" || "NOT SET"}}</td>\n        <td>{{log.proAccessFrom | date: "dd/MM/yyyy" || "NOT SET"}}</td>\n        <td>{{log.proAccessTo | date: "dd/MM/yyyy" || "NOT SET"}}</td>\n        <td>{{log.grantType || "-"}}</td>\n      </tr>\n    </table>\n    <dt-pager filter="DtOrganizationProGrantLogListVM.filter" collection="DtOrganizationProGrantLogListVM.logs" pager="DtOrganizationProGrantLogListVM.pager"></dt-pager>\n  </div>\n  <dt-no-items collection="DtOrganizationProGrantLogListVM.logs"></dt-no-items>\n</div>'),e.put("cache/modules/organization/dt-organization-user-list/dt-organization-user-list.html",'<div class="dt-paged-content">\n  <div class="search-filter">\n    <dt-input-text model="DtOrganizationUserListVM.filter" property-name="search" label="Search"></dt-input-text>\n    <md-button class="md-raised md-primary right-align-button" ng-click="DtOrganizationUserListVM.inviteUser()">Invite User</md-button>\n  </div>\n\n  <div ng-if="DtOrganizationUserListVM.users.items && DtOrganizationUserListVM.users.items.length > 0">\n    <table>\n      <tr>\n        <th>\n          <dt-sortable-heading name="First Name" sort-by="firstName" filter="DtOrganizationUserListVM.filter" pager="DtOrganizationUserListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Last Name" sort-by="lastName" filter="DtOrganizationUserListVM.filter" pager="DtOrganizationUserListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Email" sort-by="email" filter="DtOrganizationUserListVM.filter" pager="DtOrganizationUserListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          Registered On\n        </th>\n        <th>\n          Org. Member Since\n        </th>\n        <th>\n          Org. Pro Access Until\n        </th>\n        <th>\n          Accepted?\n        </th>\n        <th>\n          Is Admin?\n        </th>\n        <th class="no-right-padding">\n          Remove?\n        </th>\n      </tr>\n      <tr ng-repeat="user in DtOrganizationUserListVM.users.items">\n        <td>{{user.firstName || "NOT SET"}}</td>\n        <td>{{user.lastName || "NOT SET"}}</td>\n        <td>{{user.email}}</td>\n        <td>{{user.registeredAt | date: "dd/MM/yyyy"}}</td>\n        <td>{{user.orgMemberSince | date: "dd/MM/yyyy HH:mm"}}</td>\n        <td>\n          {{user.subscriptionExpiresOn | date: "dd/MM/yyyy"}}\n          <span ng-if="user.showAddYearButton">\n            (<a href="javascript:void(0)" class="grid-action-button" ng-click="DtOrganizationUserListVM.grantProAccess(user.id)">Add 1 Year</a>)\n          </span>\n        </td>\n        <td>{{user.hasAccepted ? "Yes" : "No"}}</td>\n        <td>\n          {{user.isAdmin ? "Yes" : "No"}}\n          <a href="javascript:void(0)" class="grid-action-button" ng-click="DtOrganizationUserListVM.changeAdminStatus(user)" ng-if="user.id !== $root.currentUser.userId">\n            (Change)\n          </a>\n        </td>\n        <td class="center-aligned-content no-right-padding">\n          <a href="javascript:void(0)" class="grid-action-button" ng-click="DtOrganizationUserListVM.removeUser(user.id)" ng-if="user.id !== $root.currentUser.userId">\n            Remove\n          </a>\n          <span ng-if="user.id === $root.currentUser.userId">-</span>\n        </td>\n      </tr>\n    </table>\n    <dt-pager filter="DtOrganizationUserListVM.filter" collection="DtOrganizationUserListVM.users" pager="DtOrganizationUserListVM.pager"></dt-pager>\n  </div>\n  <dt-no-items collection="DtOrganizationUserListVM.users"></dt-no-items>\n</div>'),e.put("cache/modules/schema/dt-schema-list/dt-schema-list.html",'<div class="dt-paged-content">\n  <div class="search-filter">\n    <dt-input-text model="DtSchemaListVM.filter" property-name="search" label="Search"></dt-input-text>\n  </div>\n  <div ng-if="DtSchemaListVM.diagrams.items && DtSchemaListVM.diagrams.items.length > 0">\n    <table>\n      <tr>\n        <th>\n          <dt-sortable-heading name="Name" sort-by="name" filter="DtSchemaListVM.filter" pager="DtSchemaListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          Folder\n        </th>\n        <th>\n          Created By\n        </th>\n        <th>\n          Created At\n        </th>\n        <th>\n          Updated At\n        </th>\n        <th class="no-right-padding">\n          Tables\n        </th>\n      </tr>\n      <tr ng-repeat="diagram in DtSchemaListVM.diagrams.items">\n        <td><a ui-sref="root.standardShrinkable.diagram({ shortcode: diagram.shortcode })">{{diagram.name || "NAME NOT SET"}}</a></td>\n        <td>{{diagram.parentFolderName || \'DEFAULT FOLDER\'}}</td>\n        <td ng-if="diagram.userName">\n          <a ui-sref="root.standard.user.profile({ userId: diagram.userId })">{{diagram.userName}}</a>\n        </td>\n        <td ng-if="!diagram.userName">\n          ANONYMOUS\n        </td>\n        <td>{{diagram.dateCreated | date: "dd/MM/yy hh:mm a"}}</td>\n        <td>{{diagram.dateUpdated | date: "dd/MM/yy hh:mm a"}}</td>\n        <td class="center-aligned-content no-right-padding">{{diagram.tableCount}}</td>\n      </tr>\n    </table>\n    <dt-pager filter="DtSchemaListVM.filter" collection="DtSchemaListVM.diagrams" pager="DtSchemaListVM.pager"></dt-pager>\n  </div>\n  <dt-no-items collection="DtSchemaListVM.diagrams"></dt-no-items>\n</div>'),e.put("cache/modules/subscription/dt-cancel-subscription/dt-cancel-subscription.html",'<md-toolbar>\n  <div class="md-toolbar-tools">\n    <h2>Cancel Subscription</h2>\n    <span flex></span>\n    <md-button class="md-icon-button" ng-click="DtCancelSubscriptionVM.close()">\n      <md-icon class="mdi mdi-close" aria-label="Close dialog"></md-icon>\n    </md-button>\n  </div>\n</md-toolbar>\n\n<md-dialog-content>\n  <md-content class="md-padding">\n    <p>Please tell us more about your subscription cancellation</p>\n    <p>{{DtCancelSubscriptionVM.userProfile}}</p>\n\n    <div class="cancellation-reasons">\n      <md-radio-group ng-model="DtCancelSubscriptionVM.model.reasonId">\n        <md-radio-button ng-repeat="reason in DtCancelSubscriptionVM.reasons" ng-value="reason.id" class="md-primary md-hue-1">\n          {{reason.reason}}\n        </md-radio-button>\n      </md-radio-group>\n    </div>\n\n    <dt-input-textarea model="DtCancelSubscriptionVM.model" property-name="comment" label="{{DtCancelSubscriptionVM.reasons[DtCancelSubscriptionVM.model.reasonId].question}}">\n    </dt-input-textarea>\n    \n    <span layout-align="end center" layout="row">\n      <md-button class="md-primary md-raised no-right-margin" ng-click="DtCancelSubscriptionVM.confirm()">CONFIRM</md-button>\n    </span>\n  </md-content>\n</md-dialog-content>'),e.put("cache/modules/user/dt-user-diagrams/dt-user-diagrams.html",'<div class="dt-paged-content">\n  <div class="search-filter">\n    <dt-input-text model="DtUserDiagramsVM.filter" property-name="search" label="Search"></dt-input-text>\n  </div>\n  <div ng-if="DtUserDiagramsVM.diagrams.items && DtUserDiagramsVM.diagrams.items.length > 0">\n    <table>\n      <tr>\n        <th>\n          <dt-sortable-heading name="Name" sort-by="name" filter="DtUserDiagramsVM.filter" pager="DtUserDiagramsVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          Folder\n        </th>\n        <th>\n          <dt-sortable-heading name="Created At" sort-by="createdAt" filter="DtUserDiagramsVM.filter" pager="DtUserDiagramsVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Updated At" sort-by="updatedAt" filter="DtUserDiagramsVM.filter" pager="DtUserDiagramsVM.pager"></dt-sortable-heading>\n        </th>\n        <th class="no-right-padding">\n          <dt-sortable-heading name="Tables" sort-by="tableCount" filter="DtUserDiagramsVM.filter" pager="DtUserDiagramsVM.pager"></dt-sortable-heading>\n        </th>\n      </tr>\n      <tr ng-repeat="diagram in DtUserDiagramsVM.diagrams.items">\n        <td><a ui-sref="root.standardShrinkable.diagram({ shortcode: diagram.shortcode })">{{diagram.name || "NAME NOT SET"}}</a></td>\n        <td>{{diagram.parentFolderName || \'DEFAULT FOLDER\'}}</td>\n        <td>{{diagram.dateCreated | date: "dd/MM/yy hh:mm a"}}</td>\n        <td>{{diagram.dateUpdated | date: "dd/MM/yy hh:mm a"}}</td>\n        <td class="center-aligned-content no-right-padding">{{diagram.tableCount}}</td>\n      </tr>\n    </table>\n    <dt-pager filter="DtUserDiagramsVM.filter" collection="DtUserDiagramsVM.diagrams" pager="DtUserDiagramsVM.pager"></dt-pager>\n  </div>\n  <dt-no-items collection="DtUserDiagramsVM.diagrams"></dt-no-items>\n</div>'),e.put("cache/modules/user/dt-user-list/dt-user-list.html",'<div class="dt-paged-content">\n  <div class="search-filter">\n    <dt-input-text model="DtUserListVM.filter" property-name="search" label="Search"></dt-input-text>\n  </div>\n  <div ng-if="DtUserListVM.users.items && DtUserListVM.users.items.length > 0">\n    <table>\n      <tr>\n        <th>\n          <dt-sortable-heading name="Id" sort-by="id" filter="DtUserListVM.filter" pager="DtUserListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="First Name" sort-by="firstName" filter="DtUserListVM.filter" pager="DtUserListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Last Name" sort-by="lastName" filter="DtUserListVM.filter" pager="DtUserListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Email" sort-by="email" filter="DtUserListVM.filter" pager="DtUserListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Last Active" sort-by="userDetail.lastActive" filter="DtUserListVM.filter" pager="DtUserListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Registered On" sort-by="userDetail.createdAt" filter="DtUserListVM.filter" pager="DtUserListVM.pager"></dt-sortable-heading>\n        </th>\n        <th class="no-right-padding">\n          Subscription Until\n        </th>\n      </tr>\n      <tr ng-repeat="user in DtUserListVM.users.items">\n        <td>{{user.userId}}</td>\n        <td>{{user.firstName || "NOT SET"}}</td>\n        <td>{{user.lastName || "NOT SET"}}</td>\n        <td><a ui-sref="root.standard.user.profile({ userId: user.userId })">{{user.email}}</a></td>\n        <td>{{user.lastActive | date: "dd/MM/yyyy HH:mm"}}</td>\n        <td class="center-aligned-content">{{user.dateCreated | date: "dd/MM/yyyy"}}</td>\n        <td class="center-aligned-content no-right-padding">{{user.individualSubscriptionExpiresOn | date: "dd/MM/yyyy"}}</td>\n      </tr>\n    </table>\n    <dt-pager filter="DtUserListVM.filter" collection="DtUserListVM.users" pager="DtUserListVM.pager"></dt-pager>\n  </div>\n  <dt-no-items collection="DtUserListVM.users"></dt-no-items>\n</div>'),e.put("cache/modules/user/dt-user-payments/dt-user-payments.html",'<div class="dt-paged-content user-payments">\n  <table ng-if="DtUserPaymentsVM.payments && DtUserPaymentsVM.payments.length > 0">\n    <tr>\n      <th>Transaction</th>\n      <th>Status</th>\n      <th>Amount</th>\n      <th>Created At</th>\n    </tr>\n    <tr ng-repeat="payment in DtUserPaymentsVM.payments">\n      <td>{{"#" + payment.transactionId}}</td>\n      <td>{{payment.status || \'-\'}}</td>\n      <td>{{payment.amount | currency:"\\u0024"}}</td>\n      <td>{{payment.dateCreated | date: "dd/MM/yy hh:mm a"}}</td>\n    </tr>\n  </table>\n  <div>\n    <span ng-if="!DtUserPaymentsVM.payments">Loading, please wait...</span>\n    <span ng-if="DtUserPaymentsVM.payments.length === 0">No items to display.</span>\n  </div>\n</div>'),e.put("cache/modules/user/dt-user-profile/dt-user-profile.html",'<div class="user-profile">\n  <h2 ng-if="DtUserProfileVM.userProfile.firstName || DtUserProfileVM.userProfile.lastName">\n    {{DtUserProfileVM.userProfile.firstName + " " + DtUserProfileVM.userProfile.lastName}}\n  </h2>\n\n  <h3>\n    {{DtUserProfileVM.userProfile.userName}}\n    \x3c!-- WHY: We\'re checking for the existence here so users who got free Pro access from us could still go and pre-approve a subscription with a card or paypal --\x3e\n    <span class="call-to-action" ng-if="!DtUserProfileVM.userProfile.hasActiveIndividualSubscription">\n      (<a ui-sref="root.centered.subscribe">subscribe</a>)\n    </span>\n  </h3>\n\n  <h5>Joined</h5>\n  <div class="profile-detail">{{DtUserProfileVM.userProfile.dateCreated | date: "d MMM yyyy h:mm a"}}</div>\n\n  <h5 ng-if="$root.currentUser.isAdmin">Last Active</h5>\n  <div class="profile-detail" ng-if="$root.currentUser.isAdmin">{{DtUserProfileVM.userProfile.lastActive | date: "d MMM yyyy h:mm a"}}</div>\n\n  \x3c!-- Don\'t have a valid subscription now, and never paid for it before --\x3e\n  <div ng-if="!DtUserProfileVM.userProfile.hasIndividualProAccess && !DtUserProfileVM.userProfile.hadIndividualSubscription">\n    <h5>\n      Pro Plan\n    </h5>\n    <div class="profile-detail">\n      No\n    </div>\n  </div>\n\n  \x3c!-- Have valid subscription now or paid for it before --\x3e\n  <div ng-if="DtUserProfileVM.userProfile.hasIndividualProAccess || DtUserProfileVM.userProfile.hadIndividualSubscription">\n    <h5>\n      Personal Pro Plan {{DtUserProfileVM.userProfile.hasIndividualProAccess ? \'Expires\' : \'Expired\' }} on\n    </h5>\n    <div class="profile-detail">\n      {{DtUserProfileVM.userProfile.individualSubscriptionExpiresOn | date: "d MMM yyyy h:mm a"}}\n    </div>\n  </div>\n\n  <h5 ng-if="DtUserProfileVM.userProfile.hasActiveIndividualSubscription">\n    Next Billing of Personal Subscription on\n  </h5>\n  <div class="profile-detail" ng-if="DtUserProfileVM.userProfile.hasActiveIndividualSubscription">\n    {{DtUserProfileVM.userProfile.nextBillingDate | date: "d MMM yyyy"}}\n    (<a href="javascript:void(0)" ng-click="DtUserProfileVM.cancelSubscription()">cancel subscription</a>)\n  </div>\n\n  <div ng-if="DtUserProfileVM.userProfile.organizationId">\n    <h5>\n      Organization ({{DtUserProfileVM.userProfile.organizationName}})\n      Pro Plan {{DtUserProfileVM.userProfile.hasOrganizationProAccess ? \'Expires\' : \'Expired\' }} on\n    </h5>\n    <div class="profile-detail">\n      {{DtUserProfileVM.userProfile.organizationSubscriptionExpiresOn | date: "d MMM yyyy h:mm a"}}\n    </div>\n  </div>\n\n  <h5>Email Confirmed</h5>\n  <div class="profile-detail">\n    {{DtUserProfileVM.userProfile.emailConfirmed ? \'Yes\' : \'No\'}}\n    <span ng-if="!DtUserProfileVM.userProfile.emailConfirmed">\n      (<a href="javascript:void(0)" ng-click="DtUserProfileVM.confirmEmail()">confirm</a>)\n    </span>\n    <span class="call-to-action">\n      (<a ui-sref="root.centered.changeEmail">change</a>)\n    </span>\n  </div>\n\n  <div class="profile-detail" ng-if="!$root.currentUser.isSocialSignIn">\n    <h3>\n      <span class="call-to-action">\n        <a ui-sref="root.centered.changePassword">Change password</a>\n      </span>\n    </h3>\n  </div>\n\n  <div class="profile-detail">\n    <h3>\n      <span class="call-to-action">\n        <a href="javascript:void(0)" ng-click="DtUserProfileVM.deleteUser(DtUserProfileVM.userProfile.userId)">Delete Account</a>\n      </span>\n    </h3>\n  </div>\n\n\n  <h5 ng-if="$root.currentUser.isAdmin">Administration</h5>\n  <div class="profile-detail" ng-if="$root.currentUser.isAdmin && !DtUserProfileVM.userProfile.hasIndividualProAccess">\n    Grant:\n    <a href="javascript:void(0)" ng-click="DtUserProfileVM.grantProAccess(\'week\')">Week</a> /\n    <a href="javascript:void(0)" ng-click="DtUserProfileVM.grantProAccess(\'month\')">Month</a> /\n    <a href="javascript:void(0)" ng-click="DtUserProfileVM.grantProAccess(\'2months\')">2 Months</a> /\n    <a href="javascript:void(0)" ng-click="DtUserProfileVM.grantProAccess(\'3months\')">3 Months</a> /\n    <a href="javascript:void(0)" ng-click="DtUserProfileVM.grantProAccess(\'6months\')">6 Months</a> /\n    <a href="javascript:void(0)" ng-click="DtUserProfileVM.grantProAccess(\'year\')">Year</a> /\n    <a href="javascript:void(0)" ng-click="DtUserProfileVM.grantProAccess(\'lifetime\')">Lifetime</a> of Pro access\n  </div>\n  <div class="profile-detail" ng-if="$root.currentUser.isAdmin && DtUserProfileVM.userProfile.hasIndividualProAccess">\n    <a href="javascript:void(0)" ng-click="DtUserProfileVM.removeSubscription()">Remove Pro access</a>\n  </div>\n</div>\n'),e.put("cache/modules/voucher/dt-voucher-list/dt-voucher-list.html",'<div class="dt-paged-content">\n  <div class="search-filter">\n    <dt-input-text model="DtVoucherListVM.filter" property-name="search" label="Search"></dt-input-text>\n  </div>\n\n  <div class="right-aligned-content centered-card-box grid-md-button">\n    <md-button type="submit" class="md-primary md-raised" flex ng-click="DtVoucherListVM.addNewVoucher()">Add new voucher</md-button>\n    <br>\n    <br>\n  </div>\n\n  <div ng-if="DtVoucherListVM.vouchers.items && DtVoucherListVM.vouchers.items.length > 0">\n    <table>\n      <tr>\n        <th>\n          <dt-sortable-heading name="Id" sort-by="voucherId" filter="DtVoucherListVM.filter" pager="DtVoucherListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Code" sort-by="code" filter="DtVoucherListVM.filter" pager="DtVoucherListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Description" sort-by="description" filter="DtVoucherListVM.filter" pager="DtVoucherListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Date Created" sort-by="createdAt" filter="DtVoucherListVM.filter" pager="DtVoucherListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Created By" sort-by="createdByUserId" filter="DtVoucherListVM.filter" pager="DtVoucherListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Valid From" sort-by="validFrom" filter="DtVoucherListVM.filter" pager="DtVoucherListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Valid To" sort-by="validTo" filter="DtVoucherListVM.filter" pager="DtVoucherListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Max Redemptions" sort-by="maxRedemptions" filter="DtVoucherListVM.filter" pager="DtVoucherListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <dt-sortable-heading name="Value In Weeks" sort-by="valueInWeeks" filter="DtVoucherListVM.filter" pager="DtVoucherListVM.pager"></dt-sortable-heading>\n        </th>\n        <th>\n          <span class="sortable-heading">Current Redemptions</span>\n        </th>\n        <th>\n          <span class="sortable-heading">Edit</span>\n        </th>\n        <th>\n          <span class="sortable-heading">Copy</span>\n        </th>\n      </tr>\n      <tr ng-repeat="voucher in DtVoucherListVM.vouchers.items">\n        <td>{{voucher.voucherID}}</td>\n        <td>{{voucher.code}}</td>\n        <td>{{voucher.description}}</td>\n        <td class="center-aligned-content">{{voucher.dateCreated | date: "dd/MM/yyyy"}}</td>\n        <td>{{voucher.userName}}</td>\n        <td class="center-aligned-content">{{voucher.validFrom | date: "dd/MM/yyyy"}}</td>\n        <td class="center-aligned-content">{{voucher.validTo | date: "dd/MM/yyyy"}}</td>\n        <td class="center-aligned-content">{{voucher.maxRedemptions}}</td>\n        <td class="center-aligned-content">{{voucher.valueInWeeks}}</td>\n        <td class="center-aligned-content">{{voucher.redemptionCount}}</td>\n        <td class="center-aligned-content grid-md-button">\n          <md-button class="md-icon-button grid-md-button" href="javascript:void(0)" ng-click="DtVoucherListVM.editNewVoucher(voucher)">\n            <md-tooltip md-direction="right">Edit voucher</md-tooltip>\n            <md-icon class="mdi edit-icon-button"></md-icon>\n          </md-button>\n        </td>\n        <td class="center-aligned-content grid-md-button">\n          <md-button class="md-icon-button grid-md-button" href="javascript:void(0)" ng-click="DtVoucherListVM.copyVoucherUrl(voucher)">\n            <md-tooltip md-direction="right">Copy voucher URL to clipboard</md-tooltip>\n            <md-icon class="mdi copy-icon-button"></md-icon>\n          </md-button>\n        </td>\n      </tr>\n    </table>\n    <dt-pager filter="DtVoucherListVM.filter" collection="DtVoucherListVM.vouchers" pager="DtVoucherListVM.pager"></dt-pager>\n  </div>\n  <dt-no-items collection="DtVoucherListVM.vouchers"></dt-no-items>\n\n</div>\n'),e.put("cache/common/components/dt-docs/dt-docs.html",'<div class="sidenav-container" layout="column" flex>\n  <div class="md-toolbar-tools" ng-if="!DtDocsVM.docsSection" ng-click="DtDocsVM.closeSidebar()">\n    <div flex>\n      <h3 class="side-header">\n        Docs\n      </h3>\n      <span class="side-subheader">Support</span>\n    </div>\n    <md-button class="md-icon-button close-sidebar">\n      <md-icon class="mdi mdi-close" aria-label="Close"></md-icon>\n    </md-button>\n  </div>\n\n  <md-content flex ng-if="!DtDocsVM.docsSection">\n    <md-list flex>\n      <md-list-item ng-click="DtDocsVM.loadDocsSection(\'Basics\')">\n        <div flex>\n          <h4>Basics</h4>\n        </div>\n        <md-button class="md-icon-button">\n          <md-icon class="mdi mdi-chevron-right" aria-label="Basics"></md-icon>\n        </md-button>\n      </md-list-item>\n      <md-list-item ng-click="DtDocsVM.loadDocsSection(\'Tables\')">\n        <div flex>\n          <h4>Tables</h4>\n        </div>\n        <md-button class="md-icon-button">\n          <md-icon class="mdi mdi-chevron-right" aria-label="Tables"></md-icon>\n        </md-button>\n      </md-list-item>\n      <md-list-item ng-click="DtDocsVM.loadDocsSection(\'Relationships\')">\n        <div flex>\n          <h4>Relationships</h4>\n        </div>\n        <md-button class="md-icon-button">\n          <md-icon class="mdi mdi-chevron-right" aria-label="Relationships"></md-icon>\n        </md-button>\n      </md-list-item>\n\n      <md-list-item ng-click="DtDocsVM.loadDocsSection(\'Collaboration\')">\n        <div flex>\n          <h4>NEW! Collaboration</h4>\n        </div>\n        <md-button class="md-icon-button">\n          <md-icon class="mdi mdi-chevron-right" aria-label="Collaboration"></md-icon>\n        </md-button>\n      </md-list-item>\n\n      <md-list-item ng-click="DtDocsVM.loadDocsSection(\'Importing\')">\n        <div flex>\n          <h4>Importing</h4>\n        </div>\n        <md-button class="md-icon-button">\n          <md-icon class="mdi mdi-chevron-right" aria-label="Importing"></md-icon>\n        </md-button>\n      </md-list-item>\n\n      <md-list-item ng-click="DtDocsVM.loadDocsSection(\'Invoicing\')">\n        <div flex>\n          <h4>Invoicing</h4>\n        </div>\n        <md-button class="md-icon-button">\n          <md-icon class="mdi mdi-chevron-right" aria-label="Invoicing"></md-icon>\n        </md-button>\n      </md-list-item>\n\n      <md-list-item href="https://www.youtube.com/watch?v=dR5lPbGLY84" target="_blank" ng-click="DtDocsVM.trackDocumentation(\'Video\')">\n        <div flex>\n          <h4>Video Tutorial</h4>\n        </div>\n        <md-button class="md-icon-button">\n          <md-icon class="mdi mdi-chevron-right" aria-label="Video Tutorial"></md-icon>\n        </md-button>\n      </md-list-item>\n\n      <md-list-item href="https://www.quickdatabasediagrams.com/faq/" target="_blank" ng-click="DtDocsVM.trackDocumentation(\'FAQ\')">\n        <div flex>\n          <h4>FAQ</h4>\n        </div>\n        <md-button class="md-icon-button">\n          <md-icon class="mdi mdi-chevron-right" aria-label="FAQ"></md-icon>\n        </md-button>\n      </md-list-item>\n\n      \x3c!-- NOTE: Intercom is no longer free, so we\'re disabling it. Keeping this\n      for reference of where to potentially plug in a substitute service. --\x3e\n      \x3c!-- <md-list-item ng-click="DtDocsVM.flipSupportChat()">\n        <div flex>\n          <h4>Support Chat</h4>\n        </div>\n        <md-button class="md-icon-button">\n          <md-icon class="mdi mdi-chevron-right" aria-label="Support Chat"></md-icon>\n        </md-button>\n      </md-list-item> --\x3e\n    </md-list>\n  </md-content>\n\n  <div class="md-toolbar-tools" ng-if="DtDocsVM.docsSection" ng-click="DtDocsVM.closeDocsSection()">\n    <md-button class="md-icon-button sidebar-back">\n      <md-icon class="mdi mdi-chevron-left" aria-label="Back"></md-icon>\n    </md-button>\n    <div flex>\n      <h3 class="side-header">\n        Docs / {{DtDocsVM.docsSection}}\n      </h3>\n      <span class="side-subheader">Support</span>\n    </div>\n  </div>\n\n  <md-content class="md-padding docs-content" flex ng-if="DtDocsVM.docsSection === \'Basics\'">\n    <p><strong>Comments</strong> are defined by a leading hashtag and may stand on their own, separate line or may follow any code inline.</p>\n    <p>\n    <pre># This is a comment</pre>\n    </p>\n    <p>For a <strong>sample schema</strong> remove all text from the editor and simply type in two dots ".." (without the quotation marks).</p>\n    <p><strong>Autocomplete</strong> can be used by pressing <strong>CTRL + SPACE</strong>.</p>\n    <p>The app used to work with <strong>sections</strong> such as "settings" and "layout", but a decision was made to move these to the background and now they\'re a part of diagram metadata.</p>\n    <p>We ensured backwards compatibility by automatic conversion to the new format. All you need to do is to save the diagram to persist it in the cloud.</p>\n  </md-content>\n\n  <md-content class="md-padding docs-content" flex ng-if="DtDocsVM.docsSection === \'Collaboration\'">\n    <p>\n      QuickDBD now supports real-time collaboration!\n    </p>\n    <p>\n      If you would like to work on the same diagram with someone else, simply go to your folders, click on the three dots next to a folder or file name and select the Collaborate option. Enter the email address of your collaborator and he/she will then be able to collaborate with you.\n    </p>\n  </md-content>\n\n  <md-content class="md-padding docs-content" flex ng-if="DtDocsVM.docsSection === \'Importing\'">\n    <p>\n      You can import any <strong>.sql</strong> or <strong>.ddl</strong> files, but if you intend to import your database schema to make some changes and export it again\n      <strong>Note that you might lose information, since QuickDBD does not cover all databases features.</strong>\n    </p>\n    <p>\n      Some features not covered by QuickDBD will be added as a comment\n    </p>\n    <p>\n      If your database schema has table or field names using <strong>reserved words</strong> you must make sure that these names are between the database delimiter like the examples below:\n    </p>\n    <p>\n      SQL Server: <pre>[Order]</pre>\n      Oracle: <pre>"Order"</pre>\n      MySQL/MariaDB: <pre>`Order`</pre>\n    </p>\n  </md-content>\n\n  <md-content class="md-padding docs-content" flex ng-if="DtDocsVM.docsSection === \'Invoicing\'">\n    <p>\n      If you need an <strong>invoice</strong> you can request it by sending an email to\n      <a class="doc-link" href="mailto:accounts@quickdbd.com?subject=Invoicing">\n        accounts@quickdbd.com\n      </a>\n    </p>\n  </md-content>\n\n  <md-content class="md-padding docs-content" flex ng-if="DtDocsVM.docsSection === \'Tables\'">\n    <p><strong>Tables</strong> are defined inside the <em>tables</em> section.</p>\n    <p><strong>Table names</strong> are defined by a newline followed by a string.</p>\n    <p>\n<pre>\n# The begining of the script\nCustomer\nOrder</pre>\n    </p>\n    <p><strong>Table name aliases</strong> are defined with the <em>as</em> keyword. Multiple comma-delimited aliases are allowed. Aliases can be used instead of full table names in relationship definitions.</p>\n    <p>\n<pre>\n# The begining of the script\nCustomer as c\nOrder as o, or</pre>\n    </p>\n    <p><strong>Table fields</strong> are defined after the table name followed by an arbitrary amount of hyphens. Each table field must be defined on a separate line in the following format: <em>"FieldName FieldType"</em> or <em>"FieldName, FieldType"</em>. Field name needs to go first and any additional params (such as data type, PK, FK, UNIQUE, INDEX, IDENTITY or AUTOINCREMENT, DEFAULT, NULL or NULLABLE) may follow in any order.</p>\n    <p>\n<pre>\nOrder\n-----\nOrderID PK int IDENTITY\nOrderDate dateTime default=GETUTCDATE()\nSignedByID int FK\nAddress3 string NULL</pre>\n    </p>\n    <p>All table fields are defined as <strong>NOT NULL</strong> by default. Explicitly defining it as such will at the moment result in a parser error. For better clarity, we intend to add support for defining explicit non-nullable fields in the future.</p>\n    <p><strong>UNIQUE constraints</strong> can be defined by setting the UNIQUE keyword on the field which has to be an unique constraint.</p>\n    <p><strong>INDEX constraints</strong> can be defined by setting the INDEX keyword on the field which has to be an index constraint.</p>\n    <p>A field can\'t be a PK and an unique or an index, since a PK is already an unique and an index, and also an unique constraint can\'t be an index, since the unique constraint is already an index.</p>\n    <p><strong>Composite PKs</strong> can be defined by setting the PK keyword on all the fields which are a part of the composite key.</p>\n    <p><strong>Non-standard table and field names</strong> can be defined using double quotes:</p>\n    <p>\n<pre>\n"Non-Standard #1"\n--\n"Non-Standard #2"\nOtherTable\n--\nOtherField FK -&lt; "Non-Standard #1"."Non-Standard #2"</pre>\n    </p>\n    <p><strong>Default values</strong> are defined with the default keyword or as a part of type definition.</p>\n    <p>\n<pre>\nDateCreated dateTime default=GETUTCDATE()\nTemperature int=27\nAddress string="Some default address"</pre>\n    </p>\n    <p><strong>Documentation comments</strong> can be added before or in-line with table or field definitions. These comments will appear in PDF/RTF exports.</p>\n    <p>\n<pre>\n# Table documentation comment 1 (try the PDF/RTF export)\nProduct# Table documentation comment 2\n------------\nProductID PK int\n# Field documentation comment 1\n# Field documentation comment 2\nName varchar(200) # Field documentation comment 3</pre>\n    </p>\n  </md-content>\n\n  <md-content class="md-padding docs-content" flex ng-if="DtDocsVM.docsSection === \'Relationships\'">\n    <p>Table <strong>relationships</strong> can be defined either as a part of table metadata or inline as a part of a table field definition.</p>\n    <p>Relationships as a part of <strong>table metadata definition</strong> can be defined between the table name definition and the table fields separator ("------") using the <em>rel</em> keyword followed by relationship type and the related table. If the relationship type is omitted <em>one-to-one</em> relationship type will be used by default. Relationship table fields may or may not be specified.</p>\n    <p>\n<pre>\n# Relation type and field\n# not specified\nOrder\nrel Customer\n---\nOrderID\nCustomerID\n# Relation type and field\n# specified\nOrder\nrel &gt;- Customer.CustomerID\n------\nOrderID\nCustomerID</pre>\n    </p>\n    <p>Relationships as a part of <strong>table field definition</strong> (inline) can be defined at any position after the field name has been defined. In this case relationship type is mandatory, but the connection relation field name is still optional.</p>\n    <p>\n<pre>\nOrder\n-\nOrderID PK int\nCustomerID int FK >- cst.CustomerID</pre>\n    </p>\n    <p><strong>Allowed relationship types</strong> are:</p>\n    <p>\n      <pre>\n-     - one TO one\n-&lt;    - one TO many\n&gt;-    - many TO one\n&gt;-&lt;   - many TO many\n-0    - one TO zero or one\n0-    - zero or one TO one\n0-0   - zero or one TO zero or one\n-0&lt;   - one TO zero or many\n&gt;0-   - zero or many TO one</pre>\n    </p>\n\n    <p><strong>Frequently asked for examples</strong>:</p>\n    <p>\n      </p><div><a href="https://app.quickdatabasediagrams.com/#/d/xPGxIW" target="_blank" class="doc-link">Multi-FK-to-PK</a></div>\n      <div><a href="https://app.quickdatabasediagrams.com/#/d/vMC8i4" target="_blank" class="doc-link">FK-as-multi-PK</a></div>\n      <div><a href="https://app.quickdatabasediagrams.com/#/d/uEXQCU" target="_blank" class="doc-link">Polymorphic Rels</a></div>\n    <p></p>\n  </md-content>\n</div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n'),e.put("cache/common/components/dt-login-required/dt-login-required.html",'<md-toolbar>\n  <div class="md-toolbar-tools">\n    <h2>Login Required</h2>\n    <span flex></span>\n    <md-button class="md-icon-button" ng-click="DtLoginRequiredVM.closeDialog()">\n      <md-icon class="mdi mdi-close" aria-label="Close dialog"></md-icon>\n    </md-button>\n  </div>\n</md-toolbar>\n\n<md-dialog-content>\n  <md-content class="md-padding">\n    <p>\n      <a ui-sref="root.centered.login" class="call-to-action" ng-click="DtLoginRequiredVM.closeDialog()">Login</a> or\n      <a ui-sref="root.centered.register" class="call-to-action" ng-click="DtLoginRequiredVM.closeDialog()">register</a> to access this feature.\n    </p>\n  </md-content>\n</md-dialog-content>'),e.put("cache/common/components/dt-header/dt-header.html",'<md-toolbar layout="row" class="tour-overlay-container">\n  <div class="tour-overlay header-overlay"></div>\n\n  <div class="qdbd-home">\n    <md-button ng-href="/" class="md-icon-button" aria-label="QuickDBD"></md-button>\n  </div>\n  <div class="md-toolbar-tools header-toolbar-tools" flex hide-xs>\n    <div ui-view="context-menu"></div>\n\n    <span flex></span>\n    <md-button class="toolbar-button" aria-label="Sign In" ui-sref="root.centered.login" ng-if="!$root.currentUser && !$root.stateIncludes(\'root.centered.login\')">\n      Sign In\n    </md-button>\n    <md-menu md-position-mode="target-right bottom" ng-if="$root.currentUser">\n      <md-button class="toolbar-button" aria-label="User Menu" ng-click="$mdMenu.open($event)">\n        {{$root.currentUser.userName || $root.currentUser.email}}\n      </md-button>\n      <md-menu-content width="3">\n        <md-menu-item>\n          <md-button ui-sref="root.standard.user.profile({ userId: $root.currentUser.userId })" ng-click="DtHeaderVM.trackAccount()">\n            <div layout="row" flex>\n              <p flex>Account</p>\n              <md-icon class="mdi mdi-account dropdown-item"></md-icon>\n            </div>\n          </md-button>\n        </md-menu-item>\n        <md-menu-item ng-if="!$root.currentUser.nextBillingDate">\n          <md-button ui-sref="root.centered.subscribe">\n            <div layout="row" flex>\n              <p flex>Subscribe</p>\n              <md-icon class="mdi mdi-account-star dropdown-item"></md-icon>\n            </div>\n          </md-button>\n        </md-menu-item>\n        <md-menu-item>\n          <md-button ng-click="DtHeaderVM.logout()">\n            <div layout="row" flex>\n              <p flex>Logout</p>\n              <md-icon class="mdi mdi-logout-variant dropdown-item"></md-icon>\n            </div>\n          </md-button>\n        </md-menu-item>\n      </md-menu-content>\n    </md-menu>\n\n    \x3c!-- If any buttons need to be added here at the end, look through github history\n    when sharing buttons were removed to get for classes that can be used --\x3e\n  </div>\n</md-toolbar>'),e.put("cache/common/components/dt-side-toolbar/dt-side-toolbar.html",'<div class="side-toolbar tour-overlay-container" layout="column" flex hide-xs>\n  <div class="tour-overlay"></div>\n  <div ng-if="!DtSideToolbarVM.toolbarVisibility.isDiagramRoute">\n    <md-button class="md-icon-button" aria-label="Home" ng-href="/">\n      <md-tooltip md-direction="right">Home</md-tooltip>\n      <md-icon class="mdi mdi-home"></md-icon>\n    </md-button>\n  </div>\n  <div class="side-button" ng-class="{ active: !DtSideToolbarVM.folderTreeState.isOpen }" ng-if="DtSideToolbarVM.toolbarVisibility.isDiagramRoute">\n    <md-button class="md-icon-button" aria-label="Files" ng-click="DtSideToolbarVM.showFile()">\n      <md-tooltip md-direction="right">Current File</md-tooltip>\n      <md-icon class="mdi mdi-file-outline"></md-icon>\n    </md-button>\n  </div>\n  <div class="side-button" ng-class="{ active: DtSideToolbarVM.folderTreeState.isOpen }" ng-if="DtSideToolbarVM.toolbarVisibility.isDiagramRoute">\n    <md-button class="md-icon-button" aria-label="Files" ng-click="DtSideToolbarVM.openFolderTree()">\n      <md-tooltip md-direction="right">Files</md-tooltip>\n      <md-icon class="mdi mdi-folder-multiple"></md-icon>\n    </md-button>\n  </div>\n  <div class="side-button" ng-class="{ active: $root.stateIncludes(\'root.standard.user\') }" ng-if="$root.currentUser">\n    <md-button class="md-icon-button" aria-label="Profile" ui-sref="root.standard.user.profile({ userId: $root.currentUser.userId })">\n      <md-tooltip md-direction="right">Profile</md-tooltip>\n      <md-icon class="mdi mdi-account-circle"></md-icon>\n    </md-button>\n  </div>\n  <div class="side-button" ng-class="{ active: $root.stateIncludes(\'root.standard.admin\') }" ng-if="$root.currentUser.isAdmin">\n    <md-button class="md-icon-button" aria-label="Admin" ui-sref="root.standard.admin">\n      <md-tooltip md-direction="right">Admin</md-tooltip>\n      <md-icon class="mdi mdi-settings"></md-icon>\n    </md-button>\n  </div>\n\n  <div class="side-button" ng-class="{ active: $root.stateIncludes(\'root.standard.organization\') }" ng-if="$root.currentUser.isOrganizationAdmin">\n    <md-button class="md-icon-button" aria-label="OrgAdmin" ui-sref="root.standard.organization.userList({ organizationId: $root.currentUser.organizationId })">\n      <md-tooltip md-direction="right">Organization Administration</md-tooltip>\n      <md-icon class="mdi mdi-account-supervisor"></md-icon>\n    </md-button>\n  </div>\n\n  <div flex></div>\n\n  \x3c!-- If any buttons need to be added here, look through github history\n   when sharing buttons were removed to get for classes that can be used --\x3e\n</div>'),e.put("cache/common/components/dt-pager/dt-pager.html",'<div class="paging" layout="row" ng-if="DtPagerVM.collection.items.length > 0">\n  <md-icon class="mdi mdi-chevron-double-left" ng-click="DtPagerVM.pager.first()" ng-class="{ disabled: DtPagerVM.pager.isFirstPage() }">\n    <md-tooltip md-direction="below">Beginning</md-tooltip>\n  </md-icon>\n  <md-icon class="mdi mdi-chevron-left" ng-click="DtPagerVM.pager.prev()" ng-class="{ disabled: DtPagerVM.pager.isFirstPage() }">\n    <md-tooltip md-direction="below">Prev</md-tooltip>\n  </md-icon>\n\n  <span flex></span>\n  <div class="page-number">\n    <span>{{DtPagerVM.filter.page}}</span>\n    <span ng-if="DtPagerVM.collection.pageCount">/ {{DtPagerVM.collection.pageCount}}</span>\n  </div>\n  <span flex></span>\n\n  <md-icon class="mdi mdi-chevron-right" ng-click="DtPagerVM.pager.next()" ng-class="{ disabled: DtPagerVM.pager.isLastPage() }">\n    <md-tooltip md-direction="below">Next</md-tooltip>\n  </md-icon>\n  <md-icon class="mdi mdi-chevron-double-right" ng-click="DtPagerVM.pager.last()" ng-class="{ disabled: DtPagerVM.pager.isLastPage() }">\n    <md-tooltip md-direction="below">Last</md-tooltip>\n  </md-icon>\n</div>'),e.put("cache/common/components/dt-sortable-heading/dt-sortable-heading.html","<span class=\"sortable-heading\" ng-click=\"DtSortableHeadingVM.pager.sort(DtSortableHeadingVM.sortBy)\">\n  {{DtSortableHeadingVM.name}}\n  <span ng-if=\"DtSortableHeadingVM.filter.sortBy === DtSortableHeadingVM.sortBy\">\n    {{DtSortableHeadingVM.filter.sortOrder === 'descending' ? '&#9660;' : '&#9650;'}}\n  </span>\n</span>"),e.put("cache/common/components/dt-subscription-required/dt-subscription-required.html",'<md-toolbar>\n  <div class="md-toolbar-tools">\n    <h2>Pro Access Required</h2>\n    <span flex></span>\n    <md-button class="md-icon-button" ng-click="DtSubscriptionRequiredVM.closeDialog()">\n      <md-icon class="mdi mdi-close" aria-label="Close dialog"></md-icon>\n    </md-button>\n  </div>\n</md-toolbar>\n\n<md-dialog-content>\n  <md-content class="md-padding">\n    <p ng-if="DtSubscriptionRequiredVM.customMessage">\n      {{DtSubscriptionRequiredVM.customMessage}}\n    </p>\n    <span layout-align="end center" layout="row" ng-if="DtSubscriptionRequiredVM.customMessage">\n      <md-button class="call-to-action no-right-margin no-bottom-margin" ng-click="DtSubscriptionRequiredVM.subscribe()">Subscribe</md-button>\n    </span>\n\n    <p ng-if="!DtSubscriptionRequiredVM.customMessage">\n      <a href="javascript:void(0)" class="call-to-action" ng-click="DtSubscriptionRequiredVM.subscribe()">Subscribe</a> to access this Pro feature.\n    </p>\n  </md-content>\n</md-dialog-content>'),e.put("cache/common/components/dt-validation-summary/dt-validation-summary.html",'<md-list class="md-dense validation-summary" flex ng-if="DtValidationSummaryVM.summaryMessages.length > 0">\n  <md-subheader class="md-no-sticky">Please ensure all the fields are filled-in correctly</md-subheader>\n  <md-list-item class="md-1-line md-long-text summary-list-item" ng-repeat="message in DtValidationSummaryVM.summaryMessages">\n    <div class="md-list-item-text" layout="column">\n      <span class="summary-message">{{message}}</span>\n    </div>\n  </md-list-item>\n</md-list>'),e.put("cache/common/directives/dt-form-elements/dt-input-password.html",'<md-input-container class="md-block" ng-class="{ \'invalid-input\': !!validationMessage }">\n  <input ng-model="model[propertyName]" type="password" ng-click="onFieldClicked()" data-placeholder="{{label}}" aria-label="{{label}}" dt-focus-on="{{focusOn}}" ng-required="!!validationMessage" ng-disabled="model.isEditingDisabled || disable">\n  <div ng-messages="required" class="input-error-message">\n    {{validationMessage}}\n  </div>\n  <div ng-show="showExtraValidation && passwordValidation && !passwordValidation.isValid" class="password-validation">\n    <span ng-class="{ valid: passwordValidation.isValid }"><md-icon class="mdi mdi-lock"></md-icon>Your password needs to:</span>\n    <ul>\n      <li ng-class="{ valid: passwordValidation.lowercase }">\n        <md-icon class="mdi {{ passwordValidation.lowercase ? \'mdi-checkbox-marked-circle-outline\' : \'mdi-close-circle-outline\' }}"></md-icon>\n        include at least one lower case character.\n      </li>\n      <li ng-class="{ valid: passwordValidation.uppercase }">\n        <md-icon class="mdi {{ passwordValidation.uppercase ? \'mdi-checkbox-marked-circle-outline\' : \'mdi-close-circle-outline \'}}"></md-icon>\n        include at least one UPPER case character.\n      </li>\n      <li ng-class="{ valid: passwordValidation.digits }">\n        <md-icon class="mdi {{ passwordValidation.digits ? \'mdi-checkbox-marked-circle-outline\' : \'mdi-close-circle-outline\' }}"></md-icon>\n        include at least one digit.\n      </li>\n      <li ng-class="{ valid: passwordValidation.minCharacters }">\n        <md-icon class="mdi {{ passwordValidation.minCharacters ? \'mdi-checkbox-marked-circle-outline\' : \'mdi-close-circle-outline\' }}"></md-icon>\n        be at least 8 characters long.\n      </li>\n      <li ng-class="{ valid: passwordValidation.specials }">\n        <md-icon class="mdi {{ passwordValidation.specials ? \'mdi-checkbox-marked-circle-outline\' : \'mdi-close-circle-outline\' }}"></md-icon>\n        include at least one special ($@$!%*?&) character.\n    </li></ul>\n  </div>\n</md-input-container>'),e.put("cache/common/directives/dt-form-elements/dt-input-text-i.html",'<md-input-container class="md-block" ng-class="{ \'invalid-input\': !!validationMessage }">\n  <md-icon class="mdi input-icon" ng-class="icon"></md-icon>\n  <input ng-model="model[propertyName]" type="{{ inputType || \'text\'}}" data-placeholder="{{label}}" aria-label="{{label}}" dt-focus-on="{{focusOn}}" ng-required="!!validationMessage" ng-disabled="model.isEditingDisabled || disable">\n  <div ng-messages="required" class="input-error-message">\n    {{validationMessage}}\n  </div>\n</md-input-container>'),e.put("cache/common/directives/dt-form-elements/dt-input-text.html",'<md-input-container class="md-block" ng-class="{ \'invalid-input\': !!validationMessage }">\n  <input ng-model="model[propertyName]" type="{{inputType || \'text\'}}" data-placeholder="{{label}}" aria-label="{{label}}" dt-focus-on="{{focusOn}}" ng-required="!!validationMessage" ng-disabled="model.isEditingDisabled || disable" ng-maxlength="maxLength" min="{{minDate | date:\'yyyy-MM-dd\'}}">\n  <div ng-messages="required" class="input-error-message" ng-bind-html="validationMessage">\n    {{model[propertyName].$valid}}\n  </div>\n</md-input-container>'),e.put("cache/common/directives/dt-form-elements/dt-input-textarea.html",'<md-input-container class="md-block dt-input-container" ng-class="{ \'invalid-input\': !!validationMessage }">\n  <textarea ng-model="model[propertyName]" data-placeholder="{{label}}" rows="6" aria-label="{{label}}" dt-focus-on="{{focusOn}}" ng-required="!!validationMessage" ng-disabled="model.isReadOnly || disable" ng-change="onChange()" dt-remove-ng-validation></textarea>\n  <div ng-messages="required" class="input-error-message">\n    {{model[propertyName].$valid}}\n    {{validationMessage}}\n  </div>\n</md-input-container>')}]);